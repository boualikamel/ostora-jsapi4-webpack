(function(){(this||window).webpackJsonp.registerAbsMids({"esri/arcade/arcadeAsyncRuntime":2787})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[84],{2787:function(n,o,a){(function(e){var r,t;r=[a.dj.c(n.i),o,a(1728),a(1766),a(1657),a(1675),a(1817),a(1765),a(1696),a(1640),a(1730),a(1818),a(2027),a(1819),a(1822),a(1823),a(1825),a(4),a(37),a(81),a(209),a(43),a(152),a(153),a(31)],void 0===(t=function(e,r,t,n,h,v,p,f,d,g,E,o,a,i,c,u,s,m,l,y,N,w,b,I,R){function O(e){return e instanceof Error?m.reject(e):m.reject(new Error(e))}function S(e){return m.resolve(e)}function T(e,r){for(var t=[],n=0;n<r.arguments.length;n++)t.push(F(e,r.arguments[n]));return m.all(t)}function M(n,o,a){return m.create(function(r,t){T(n,o).then(function(e){try{r(a(n,o,e))}catch(e){t(e)}},t)})}function A(n,o,a){try{return T(n,o).then(function(e){try{var r=a(n,o,e);return(t=r)&&"function"==typeof t.then?r:m.resolve(r)}catch(e){return O(e)}var t})}catch(n){return O(n)}}function F(e,r){try{switch(r.type){case"VariableDeclarator":return function(o,a){try{var e=null;return e=null===a.init?m.resolve(null):F(o,a.init),null!==o.localScope?e.then(function(n){return m.create(function(e,r){if(n===g.voidOperation&&(n=null),"Identifier"!==a.id.type)throw new Error("Can only assign a regular variable");var t=a.id.name.toLowerCase();o.localScope[t]={value:n,valueset:!0,node:a.init},e(g.voidOperation)})}):e.then(function(n){return m.create(function(e,r){if("Identifier"!==a.id.type)throw new Error("Can only assign a regular variable");var t=a.id.name.toLowerCase();n===g.voidOperation&&(n=null),o.globalScope[t]={value:n,valueset:!0,node:a.init},e(g.voidOperation)})})}catch(o){return O(o)}}(e,r);case"VariableDeclaration":return function n(o,a,i){return m.create(function(r,t){i>=a.declarations.length?r(g.voidOperation):F(o,a.declarations[i]).then(function(e){i===a.declarations.length-1?r(g.voidOperation):n(o,a,i+1).then(function(e){r(g.voidOperation)},t)},t)})}(e,r,0);case"BlockStatement":return function(e,r){try{return function n(o,a,i){try{return i>=a.body.length?m.resolve(g.voidOperation):m.create(function(r,t){F(o,a.body[i]).then(function(e){try{e instanceof g.ReturnResult||e===g.breakResult||e===g.continueResult||i===a.body.length-1?r(e):n(o,a,i+1).then(r,t)}catch(e){t(e)}},t)})}catch(o){return O(o)}}(e,r,0)}catch(e){return O(e)}}(e,r);case"FunctionDeclaration":return function(e,r){try{var t=r.id.name.toLowerCase();return e.globalScope[t]={valueset:!0,node:null,value:new p(r,e)},m.resolve(g.voidOperation)}catch(e){return O(e)}}(e,r);case"ReturnStatement":return f=e,d=r,m.create(function(r,t){null===d.argument?r(new g.ReturnResult(g.voidOperation)):F(f,d.argument).then(function(e){try{r(new g.ReturnResult(e))}catch(e){t(e)}},t)});case"IfStatement":return a=e,l=r,m.create(function(r,t){"AssignmentExpression"!==l.test.type&&"UpdateExpression"!==l.test.type?F(a,l.test).then(function(e){try{!0===e?F(a,l.consequent).then(r,t):!1===e?null!==l.alternate?F(a,l.alternate).then(r,t):r(g.voidOperation):t(new Error(E.nodeErrorMessage(l.test,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION")))}catch(e){t(e)}},t):t(new Error(E.nodeErrorMessage(l.test,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION")))});case"ExpressionStatement":return function(e,r){try{return"AssignmentExpression"===r.expression.type?F(e,r.expression):(r.expression.type,F(e,r.expression).then(function(t){return m.create(function(e,r){e(t===g.voidOperation?g.voidOperation:new g.ImplicitResult(t))})}))}catch(e){return m.reject(e)}}(e,r);case"UpdateExpression":return function(o,a){try{var t=a.argument;if("MemberExpression"!==t.type)return m.create(function(e,r){var t,n="Identifier"===a.argument.type?a.argument.name.toLowerCase():"";if(!n)throw new Error("Invalid identifier");return null!==o.localScope&&void 0!==o.localScope[n]?(t=g.toNumber(o.localScope[n].value),void e(!(o.localScope[n]={value:"++"===a.operator?t+1:t-1,valueset:!0,node:a})===a.prefix?t:"++"===a.operator?t+1:t-1)):void 0!==o.globalScope[n]?(t=g.toNumber(o.globalScope[n].value),void e(!(o.globalScope[n]={value:"++"===a.operator?t+1:t-1,valueset:!0,node:a})===a.prefix?t:"++"===a.operator?t+1:t-1)):void r(new Error("Variable not recognised"))});var i={t:null};return F(o,t.object).then(function(e){var r=null;return i.t=e,!0===t.computed?r=F(o,t.property):"Identifier"===t.property.type&&(r=m.resolve(t.property.name)),r}).then(function(o){return m.create(function(e,r){var t,n=i.t;if(g.isArray(n)){if(!g.isNumber(o))throw new Error("Invalid Parameter");if(o<0&&(o=n.length+o),o<0||o>=n.length)throw new Error("Assignment outside of array bounds");t=g.toNumber(n[o]),n[o]="++"===a.operator?t+1:t-1}else if(n instanceof h){if(!1===g.isString(o))throw new Error("Dictionary accessor must be a string");if(!0!==n.hasField(o))throw new Error("Invalid Parameter");t=g.toNumber(n.field(o)),n.setField(o,"++"===a.operator?t+1:t-1)}else{if(!(n instanceof v))throw g.isImmutableArray(n)?new Error("Array is Immutable"):new Error("Invalid Parameter");if(!1===g.isString(o))throw new Error("Feature accessor must be a string");if(!0!==n.hasField(o))throw new Error("Invalid Parameter");t=g.toNumber(n.field(o)),n.setField(o,"++"===a.operator?t+1:t-1)}e(!1===a.prefix?t:"++"===a.operator?t+1:t-1)})})}catch(o){return m.reject(o)}}(e,r);case"AssignmentExpression":return u=e,s=r,m.create(function(n,o){var a=s.left;if("MemberExpression"===a.type)F(u,s.right).then(function(t){try{F(u,a.object).then(function(r){try{var e=null;if(!0===a.computed)e=F(u,a.property);else{if("Identifier"!==a.property.type)throw new Error("Expected computed or identifier for assignemnt target");e=m.resolve(a.property.name)}e.then(function(e){try{if(g.isArray(r)){if(!g.isNumber(e))throw new Error("Invalid Parameter");if(e<0&&(e=r.length+e),e<0||e>r.length)throw new Error("Assignment outside of array bounds");if(e===r.length){if("="!==s.operator)throw new Error("Invalid Parameter");r[e]=k(t,s.operator,r[e],s)}else r[e]=k(t,s.operator,r[e],s)}else if(r instanceof h){if(!1===g.isString(e))throw new Error("Dictionary accessor must be a string");if(!0===r.hasField(e))r.setField(e,k(t,s.operator,r.field(e),s));else{if("="!==s.operator)throw new Error("Invalid Parameter");r.setField(e,k(t,s.operator,null,s))}}else{if(!(r instanceof v))throw g.isImmutableArray(r)?new Error("Array is Immutable"):new Error("Invalid Parameter");if(!1===g.isString(e))throw new Error("Feature accessor must be a string");if(!0===r.hasField(e))r.setField(e,k(t,s.operator,r.field(e),s));else{if("="!==s.operator)throw new Error("Invalid Parameter");r.setField(e,k(t,s.operator,null,s))}}n(g.voidOperation)}catch(e){o(e)}},o)}catch(e){o(e)}},o)}catch(e){o(e)}},o);else{var r=a.name.toLowerCase();null!==u.localScope&&void 0!==u.localScope[r]&&F(u,s.right).then(function(e){try{u.localScope[r]={value:k(e,s.operator,u.localScope[r].value,s),valueset:!0,node:s.right},n(g.voidOperation)}catch(e){o(e)}},o),void 0!==u.globalScope[r]?F(u,s.right).then(function(e){try{u.globalScope[r]={value:k(e,s.operator,u.globalScope[r].value,s),valueset:!0,node:s.right},n(g.voidOperation)}catch(e){o(e)}},o):o(new Error("Cannot assign undeclared variable"))}});case"ForStatement":return function(n,o){try{return null!==o.init?F(n,o.init).then(function(){return m.create(function(r,t){var e={testResult:!0,lastAction:g.voidOperation};U(n,o,e,function(e){r(e)},function(e){t(e)},0)})}):m.create(function(r,t){var e={testResult:!0,lastAction:g.voidOperation};U(n,o,e,function(e){r(e)},function(e){t(e)},0)})}catch(n){return m.reject(n)}}(e,r);case"ForInStatement":return i=e,c=r,m.create(function(o,a){F(i,c.right).then(function(n){try{("VariableDeclaration"===c.left.type?F(i,c.left):m.resolve()).then(function(){try{var e="";if("VariableDeclaration"===c.left.type){var r=c.left.declarations[0].id;"Identifier"===r.type&&(e=r.name)}else"Identifier"===c.left.type&&(e=c.left.name);if(!e)throw new Error(E.nodeErrorMessage(c,"RUNTIME","INVALIDVARIABLE"));e=e.toLowerCase();var t=null;if(null!==i.localScope&&void 0!==i.localScope[e]&&(t=i.localScope[e]),null===t&&void 0!==i.globalScope[e]&&(t=i.globalScope[e]),null===t)return void a(new Error(E.nodeErrorMessage(c,"RUNTIME","VARIABLENOTDECLARED")));g.isArray(n)||g.isString(n)?x(i,c,n,{reject:a,resolve:o},t):g.isImmutableArray(n)?function(e,r,t,n,o,a){try{if(void 0===a&&(a="i"),0===t.length)return n.resolve(g.voidOperation);!function r(t,n,o,a,i,c,u,s,l){try{if(o.length()<=i)return void u(g.voidOperation);a.value="k"===c?o.get(i):i,F(t,n.body).then(function(e){e instanceof g.ReturnResult?u(e):e===g.breakResult?u(g.voidOperation):q<++l?(l=0,setTimeout(function(){r(t,n,o,a,i+1,c,function(e){u(e)},function(e){s(e)},l)})):r(t,n,o,a,i+1,c,function(e){u(e)},function(e){s(e)},l)},function(e){s(e)})}catch(t){s(t)}}(e,r,t,o,0,a,function(e){n.resolve(e)},function(e){n.reject(e)},0)}catch(e){n.reject(e)}}(i,c,n,{reject:a,resolve:o},t):n instanceof h||n instanceof v?function(e,r,t,n,o){try{x(e,r,t.keys(),n,o,"k")}catch(e){n.reject(e)}}(i,c,n,{reject:a,resolve:o},t):g.isFeatureSet(n)?function t(n,o,a,i,c,u,s,l){try{n.next().then(function(e){try{if(null===e)u(g.voidOperation);else{var r=v.createFromGraphicLikeObject(e.geometry,e.attributes,i);r._underlyingGraphic=e,c.value=r,F(o,a.body).then(function(e){try{e===g.breakResult?u(g.voidOperation):e instanceof g.ReturnResult?u(e):q<++l?(l=0,setTimeout(function(){t(n,o,a,i,c,function(e){u(e)},function(e){s(e)},l)})):t(n,o,a,i,c,function(e){u(e)},function(e){s(e)},l)}catch(e){s(e)}},function(e){s(e)})}}catch(e){s(e)}},function(e){s(e)})}catch(n){s(n)}}(n.iterator(i.abortSignal),i,c,n,t,function(e){o(e)},function(e){a(e)},0):x(i,c,[],{reject:a,resolve:o},t)}catch(e){a(e)}},a)}catch(e){a(e)}},a)});case"BreakStatement":return m.resolve(g.breakResult);case"EmptyStatement":return m.resolve(g.voidOperation);case"ContinueStatement":return m.resolve(g.continueResult);case"Identifier":return P(e,r);case"MemberExpression":return function(o,a){try{return F(o,a.object).then(function(n){try{return null===n?m.reject(new Error(E.nodeErrorMessage(a,"RUNTIME","NOTFOUND"))):!1===a.computed?"Identifier"===a.property.type?n instanceof h||n instanceof v?m.resolve(n.field(a.property.name)):n instanceof y?m.resolve(D(n,a.property.name,o,a)):m.reject(new Error(E.nodeErrorMessage(a,"RUNTIME","INVALIDTYPE"))):m.reject(new Error(E.nodeErrorMessage(a,"RUNTIME","INVALIDTYPE"))):F(o,a.property).then(function(t){return m.create(function(e,r){if(n instanceof h||n instanceof v)g.isString(t)?e(n.field(t)):r(new Error(E.nodeErrorMessage(a,"RUNTIME","INVALIDTYPE")));else if(n instanceof y)g.isString(t)?e(D(n,t,o,a)):r(new Error(E.nodeErrorMessage(a,"RUNTIME","INVALIDTYPE")));else if(g.isArray(n))if(g.isNumber(t)&&isFinite(t)&&Math.floor(t)===t){if(t<0&&(t=n.length+t),t>=n.length||t<0)throw new Error(E.nodeErrorMessage(a,"RUNTIME","OUTOFBOUNDS"));e(n[t])}else r(new Error(E.nodeErrorMessage(a,"RUNTIME","INVALIDTYPE")));else if(g.isImmutableArray(n))if(g.isNumber(t)&&isFinite(t)&&Math.floor(t)===t){if(t<0&&(t=n.length()+t),t>=n.length()||t<0)throw new Error(E.nodeErrorMessage(a,"RUNTIME","OUTOFBOUNDS"));e(n.get(t))}else r(new Error(E.nodeErrorMessage(a,"RUNTIME","INVALIDTYPE")));else if(g.isString(n))if(g.isNumber(t)&&isFinite(t)&&Math.floor(t)===t){if(t<0&&(t=n.length+t),t>=n.length||t<0)throw new Error(E.nodeErrorMessage(a,"RUNTIME","OUTOFBOUNDS"));e(n[t])}else r(new Error(E.nodeErrorMessage(a,"RUNTIME","INVALIDTYPE")));else r(new Error(E.nodeErrorMessage(a,"RUNTIME","INVALIDTYPE")))})})}catch(e){return O(e)}})}catch(o){return O(o)}}(e,r);case"Literal":return S(r.value);case"CallExpression":return function(e,r){try{return"Identifier"!==r.callee.type?O(E.nodeErrorMessage(r,"RUNTIME","ONLYNODESSUPPORTED")):null!==e.localScope&&void 0!==e.localScope[r.callee.name.toLowerCase()]?(t=e.localScope[r.callee.name.toLowerCase()]).value instanceof g.NativeFunction?t.value.fn(e,r):t.value instanceof p?V(e,r,t.value.definition):O(E.nodeErrorMessage(r,"RUNTIME","NOTAFUNCTION")):void 0===e.globalScope[r.callee.name.toLowerCase()]?O(E.nodeErrorMessage(r,"RUNTIME","NOTFOUND")):(t=e.globalScope[r.callee.name.toLowerCase()]).value instanceof g.NativeFunction?t.value.fn(e,r):t.value instanceof p?V(e,r,t.value.definition):O(E.nodeErrorMessage(r,"RUNTIME","NOTAFUNCTION"));var t}catch(e){return O(e)}}(e,r);case"UnaryExpression":return function(e,n){try{return F(e,n.argument).then(function(t){return m.create(function(e,r){g.isBoolean(t)&&"!"===n.operator?e(!t):"-"===n.operator?e(-1*g.toNumber(t)):"+"===n.operator?e(1*g.toNumber(t)):r(new Error(E.nodeErrorMessage(n,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR")))})})}catch(e){return O(e)}}(e,r);case"BinaryExpression":return function(e,a){try{return m.all([F(e,a.left),F(e,a.right)]).then(function(o){return m.create(function(e,r){var t=o[0],n=o[1];switch(a.operator){case"==":e(g.equalityTest(t,n));break;case"!=":e(!g.equalityTest(t,n));break;case"<":case">":case"<=":case">=":e(g.greaterThanLessThan(t,n,a.operator));break;case"+":e(g.isString(t)||g.isString(n)?g.toString(t)+g.toString(n):g.toNumber(t)+g.toNumber(n));break;case"-":e(g.toNumber(t)-g.toNumber(n));break;case"*":e(g.toNumber(t)*g.toNumber(n));break;case"/":e(g.toNumber(t)/g.toNumber(n));break;case"%":e(g.toNumber(t)%g.toNumber(n));break;default:r(new Error(E.nodeErrorMessage(a,"RUNTIME","OPERATORNOTRECOGNISED")))}})})}catch(e){return O(e)}}(e,r);case"LogicalExpression":return n=e,o=r,m.create(function(r,t){return"AssignmentExpression"===o.left.type||"UpdateExpression"===o.left.type?void t(new Error(E.nodeErrorMessage(o.left,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"))):"AssignmentExpression"===o.right.type||"UpdateExpression"===o.right.type?void t(new Error(E.nodeErrorMessage(o.right,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"))):void F(n,o.left).then(function(e){try{if(!g.isBoolean(e))throw new Error(E.nodeErrorMessage(o,"RUNTIME","ONLYBOOLEAN"));switch(o.operator){case"||":!0===e?r(e):F(n,o.right).then(function(e){try{if(!g.isBoolean(e))throw new Error(E.nodeErrorMessage(o,"RUNTIME","ONLYORORAND"));r(e)}catch(e){t(e)}},t);break;case"&&":!1===e?r(e):F(n,o.right).then(function(e){try{if(!g.isBoolean(e))throw new Error(E.nodeErrorMessage(o,"RUNTIME","ONLYORORAND"));r(e)}catch(e){t(e)}},t);break;default:throw new Error(E.nodeErrorMessage(o,"RUNTIME","ONLYORORAND"))}}catch(e){t(e)}},t)});case"ConditionalExpression":return O(E.nodeErrorMessage(r,"RUNTIME","NOTSUPPORTED"));case"ArrayExpression":return function(e,o){try{for(var r=[],t=0;t<o.elements.length;t++)r.push(F(e,o.elements[t]));return m.all(r).then(function(n){return m.create(function(e,r){for(var t=0;t<n.length;t++){if(g.isFunctionParameter(n[t]))return void r(new Error(E.nodeErrorMessage(o,"RUNTIME","FUNCTIONCONTEXTILLEGAL")));n[t]===g.voidOperation&&(n[t]=null)}e(n)})})}catch(e){return O(e)}}(e,r);case"ObjectExpression":return function(e,r){try{for(var t=[],n=0;n<r.properties.length;n++)t.push(F(e,r.properties[n]));return m.all(t).then(function(i){return m.create(function(e,r){for(var t={},n=0;n<i.length;n++){var o=i[n];if(g.isFunctionParameter(o.value))throw new Error("Illegal Argument");if(!1===g.isString(o.key))throw new Error("Illegal Argument");o.value===g.voidOperation?t[o.key.toString()]=null:t[o.key.toString()]=o.value}var a=new h(t);a.immutable=!1,e(a)})})}catch(e){return O(e)}}(e,r);case"Property":return function(n,o){try{return F(n,o.value).then(function(t){return m.create(function(r,e){"Identifier"===o.key.type?r({key:o.key.name,value:t}):F(n,o.key).then(function(e){r({key:e,value:t})})})})}catch(n){return m.reject(n)}}(e,r);default:return O(E.nodeErrorMessage(r,"RUNTIME","UNREOGNISED"))}}catch(e){return O(e)}var n,o,i,c,u,s,a,l,f,d}function C(r,t,n){try{return F(r,t.body).then(function(e){try{return n.lastAction=e,n.lastAction===g.breakResult||n.lastAction instanceof g.ReturnResult?(n.testResult=!1,m.resolve(n)):null!==t.update?F(r,t.update).then(function(e){return m.resolve(n)}):m.resolve(n)}catch(e){return m.reject(e)}})}catch(r){return m.reject(r)}}function U(e,r,t,n,o,a){try{(function(r,t,n){try{return null!==t.test?F(r,t.test).then(function(e){try{return!0===r.abortSignal.aborted?m.reject(new Error("Cancelled")):(n.testResult=e,!1===n.testResult?m.resolve(n):!0!==n.testResult?m.reject(new Error(E.nodeErrorMessage(t,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"))):C(r,t,n))}catch(e){return m.reject(e)}}):C(r,t,n)}catch(r){return m.reject(r)}})(e,r,t).then(function(){try{!0===t.testResult?q<++a?(a=0,setTimeout(function(){U(e,r,t,function(e){n(e)},function(e){o(e)},a)})):U(e,r,t,function(e){n(e)},function(e){o(e)},a):n(t.lastAction instanceof g.ReturnResult?t.lastAction:g.voidOperation)}catch(e){o(e)}},function(e){o(e)})}catch(e){o(e)}}function x(e,r,t,n,o,a){try{if(void 0===a&&(a="i"),0===t.length)return void n.resolve(g.voidOperation);!function r(t,n,o,a,i,c,u,s,l,f){try{if(a<=c)return void s(g.voidOperation);i.value="k"===u?o[c]:c,F(t,n.body).then(function(e){try{e instanceof g.ReturnResult?s(e):e===g.breakResult?s(g.voidOperation):q<++f?(f=0,setTimeout(function(){r(t,n,o,a,i,c+1,u,function(e){s(e)},function(e){l(e)},f)})):r(t,n,o,a,i,c+1,u,function(e){s(e)},function(e){l(e)},f)}catch(e){l(e)}},function(e){l(e)})}catch(t){l(t)}}(e,r,t,t.length,o,0,a,function(e){n.resolve(e)},function(e){n.reject(e)},0)}catch(e){n.reject(e)}}function k(e,r,t,n){switch(r){case"=":return e===g.voidOperation?null:e;case"/=":return g.toNumber(t)/g.toNumber(e);case"*=":return g.toNumber(t)*g.toNumber(e);case"-=":return g.toNumber(t)-g.toNumber(e);case"+=":return g.isString(t)||g.isString(e)?g.toString(t)+g.toString(e):g.toNumber(t)+g.toNumber(e);case"%=":return g.toNumber(t)%g.toNumber(e);default:throw new Error(E.nodeErrorMessage(n,"RUNTIME","OPERATORNOTRECOGNISED"))}}function D(e,r,t,n){var o;switch(r=r.toLowerCase()){case"hasz":var a=e.hasZ;return void 0!==a&&a;case"hasm":var i=e.hasM;return void 0!==i&&i;case"spatialreference":var c=e.spatialReference._arcadeCacheId;if(void 0===c){var u=!0;Object.freeze&&Object.isFrozen(e.spatialReference)&&(u=!1),u&&(z++,c=e.spatialReference._arcadeCacheId=z)}var s=new h({wkt:e.spatialReference.wkt,wkid:e.spatialReference.wkid});return void 0!==c&&(s._arcadeCacheId="SPREF"+c.toString()),s}switch(e.type){case"extent":switch(r){case"xmin":case"xmax":case"ymin":case"ymax":case"zmin":case"zmax":case"mmin":case"mmax":var l=e[r];return void 0!==l?l:null;case"type":return"Extent"}break;case"polygon":switch(r){case"rings":return void 0===(o=e.cache._arcadeCacheId)&&(o=++z,e.cache._arcadeCacheId=o),new f(e.rings,e.spatialReference,!0===e.hasZ,!0===e.hasM,o);case"type":return"Polygon"}break;case"point":switch(r){case"x":case"y":case"z":case"m":return void 0!==e[r]?e[r]:null;case"type":return"Point"}break;case"polyline":switch(r){case"paths":return void 0===(o=e.cache._arcadeCacheId)&&(o=++z,e.cache._arcadeCacheId=o),new f(e.paths,e.spatialReference,!0===e.hasZ,!0===e.hasM,o);case"type":return"Polyline"}break;case"multipoint":switch(r){case"points":return void 0===(o=e.cache._arcadeCacheId)&&(o=++z,e.cache._arcadeCacheId=o),new d(e.points,e.spatialReference,!0===e.hasZ,!0===e.hasM,o,1);case"type":return"Multipoint"}}throw new Error(E.nodeErrorMessage(n,"RUNTIME","PROPERTYNOTFOUND"))}function P(a,i){return m.create(function(r,t){var e=i.name.toLowerCase();if(null===a.localScope||void 0===a.localScope[e])if(void 0===a.globalScope[e])t(new Error(E.nodeErrorMessage(i,"RUNTIME","VARIABLENOTFOUND")));else{var n=a.globalScope[e];!0===n.valueset?r(n.value):null!==n.d?n.d.then(r,t):(n.d=F(a,n.node),n.d.then(function(e){try{n.value=e,n.valueset=!0,r(e)}catch(e){t(e)}},t))}else{var o=a.localScope[e];!0===o.valueset?r(o.value):null!==o.d?o.d.then(r,t):(o.d=F(a,o.node),o.d.then(function(e){try{o.value=e,o.valueset=!0,r(e)}catch(e){t(e)}},t))}})}function L(e){return null===e?"":g.isArray(e)||g.isImmutableArray(e)?"Array":g.isDate(e)?"Date":g.isString(e)?"String":g.isBoolean(e)?"Boolean":g.isNumber(e)?"Number":e instanceof n?"Attachment":e instanceof t?"Portal":e instanceof h?"Dictionary":e instanceof v?"Feature":e instanceof w?"Point":e instanceof b?"Polygon":e instanceof I?"Polyline":e instanceof N?"Multipoint":e instanceof l?"Extent":g.isFunctionParameter(e)?"Function":g.isFeatureSet(e)?"FeatureSet":g.isFeatureSetCollection(e)?"FeatureSetCollection":e===g.voidOperation?"":"number"==typeof e&&isNaN(e)?"Number":"Unrecognised Type"}function j(n,o){try{var a=n.length,i=Math.floor(a/2);return 0===a?m.resolve([]):1===a?m.resolve([n[0]]):m.create(function(r,t){var e=[j(n.slice(0,i),o),j(n.slice(i,a),o)];m.all(e).then(function(e){try{(function o(a,i,c,u){return m.create(function(r,t){var n=u;0<a.length||0<i.length?0<a.length&&0<i.length?c(a[0],i[0]).then(function(e){try{isNaN(e)&&(e=1),e<=0?(n.push(a[0]),a=a.slice(1)):(n.push(i[0]),i=i.slice(1)),o(a,i,c,u).then(r,t)}catch(e){t(e)}},t):0<a.length?(n.push(a[0]),a=a.slice(1),o(a,i,c,u).then(r,t)):0<i.length&&(n.push(i[0]),i=i.slice(1),o(a,i,c,u).then(r,t)):r(u)})})(e[0],e[1],o,[]).then(r,t)}catch(e){t(e)}},t)})}catch(n){return O(n)}}function _(e,r){var t=e.length,n=Math.floor(t/2);return r=r||function(e,r){return e<r?-1:e===r?0:1},0===t?[]:1===t?[e[0]]:function(e,r,t){for(var n=[];0<e.length||0<r.length;)if(0<e.length&&0<r.length){var o=t(e[0],r[0]);isNaN(o)&&(o=1),o<=0?(n.push(e[0]),e=e.slice(1)):(n.push(r[0]),r=r.slice(1))}else 0<e.length?(n.push(e[0]),e=e.slice(1)):0<r.length&&(n.push(r[0]),r=r.slice(1));return n}(_(e.slice(0,n),r),_(e.slice(n,t),r),r)}function B(e,r,t){try{var n=e.body;if(t.length!==e.params.length)return O(new Error("Invalid Parameter calls to function."));for(var o=0;o<t.length;o++){var a=e.params[o];"Identifier"===a.type&&(r.localScope[a.name.toLowerCase()]={d:null,value:t[o],valueset:!0,node:null})}return F(r,n).then(function(t){return m.create(function(e,r){return t instanceof g.ReturnResult?void e(t.value):t===g.breakResult?void r(new Error("Cannot Break from a Function")):t===g.continueResult?void r(new Error("Cannot Continue from a Function")):t instanceof g.ImplicitResult?void e(t.value):void e(t)})})}catch(e){return m.reject(e)}}function V(o,e,a){return A(o,e,function(e,r,t){var n={spatialReference:o.spatialReference,services:o.services,console:o.console,lrucache:o.lrucache,localScope:{},abortSignal:o.abortSignal,globalScope:o.globalScope,depthCounter:o.depthCounter+1};if(64<n.depthCounter)throw new Error("Exceeded maximum function depth");return B(a,n,t)})}function Y(r){return function(){var e={abortSignal:r.context.abortSignal,spatialReference:r.context.spatialReference,console:r.context.console,lrucache:r.context.lrucache,services:r.context.services,localScope:{},globalScope:r.context.globalScope,depthCounter:r.context.depthCounter+1};if(64<e.depthCounter)throw new Error("Exceeded maximum function depth");return B(r.definition,e,arguments)}}function G(e){console.log(e)}Object.defineProperty(r,"__esModule",{value:!0});var q=100,z=0,H={};o.registerFunctions(H,M),s.registerFunctions(H,M),c.registerFunctions(H,M),i.registerFunctions(H,M),u.registerFunctions(H,M),a.registerFunctions({functions:H,compiled:!1,signatures:null,failDefferred:null,evaluateIdentifier:null,arcadeCustomFunctionHandler:null,mode:"async",standardFunction:M,standardFunctionAsync:A}),H.typeof=function(e,r){return M(e,r,function(e,r,t){g.pcCheck(t,1,1);var n=L(t[0]);if("Unrecognised Type"===n)throw new Error("Unrecognised Type");return n})},H.iif=function(e,o){return m.create(function(t,n){g.pcCheck(null===o.arguments?[]:o.arguments,3,3),F(e,o.arguments[0]).then(function(r){try{if(!1===g.isBoolean(r))return void n(new Error("IF Function must have a boolean test condition"));m.all([F(e,o.arguments[1]),F(e,o.arguments[2])]).then(function(e){t(r?e[0]:e[1])},n)}catch(e){n(e)}},n)})},H.decode=function(n,o){return m.create(function(r,t){return o.arguments.length<2?void t(new Error("Missing Parameters")):2===o.arguments.length?void F(n,o.arguments[1]).then(r,t):(o.arguments.length-1)%2==0?void t(new Error("Must have a default value result.")):void F(n,o.arguments[0]).then(function(e){try{(function o(a,i,c,u){return m.create(function(t,n){F(a,i.arguments[c]).then(function(e){try{if(g.equalityTest(e,u))return void F(a,i.arguments[c+1]).then(t,n);var r=i.arguments.length-c;return 1==r?void F(a,i.arguments[c]).then(t,n):(2==r&&t(null),3==r?void F(a,i.arguments[c+2]).then(t,n):void o(a,i,c+2,u).then(t,n))}catch(e){n(e)}},n)})})(n,o,1,e).then(r,t)}catch(e){t(e)}},t)})},H.when=function(n,o){try{return o.arguments.length<3?O("Missing Parameters"):o.arguments.length%2==0?O("Must have a default value result."):F(n,o.arguments[0]).then(function(t){return m.create(function(e,r){!1!==g.isBoolean(t)?function n(o,a,i,e){return m.create(function(r,t){!0===e?F(o,a.arguments[i+1]).then(r,t):3==a.arguments.length-i?F(o,a.arguments[i+2]).then(r,t):F(o,a.arguments[i+2]).then(function(e){try{if(!1===g.isBoolean(e))return void t(new Error("WHEN needs boolean test conditions"));n(o,a,i+2,e).then(r,t)}catch(e){t(e)}})})}(n,o,0,t).then(e,r):r(new Error("WHEN needs boolean test conditions"))})})}catch(n){return O(n)}},H.sort=function(e,r){return A(e,r,function(e,r,t){g.pcCheck(t,1,2);var n,o=t[0];if(g.isImmutableArray(o)&&(o=o.toArray()),!1===g.isArray(o))return O(Error("Illegal Argument"));if(1<t.length)return!1===g.isFunctionParameter(t[1])?O(Error("Illegal Argument")):j(n=o,Y(t[1]));if(0===(n=o).length)return m.resolve([]);for(var a={},i=0;i<n.length;i++){var c=L(n[i]);""!==c&&(a[c]=!0)}if(!0===a.Array||!0===a.Dictionary||!0===a.Feature||!0===a.Point||!0===a.Polygon||!0===a.Polyline||!0===a.Multipoint||!0===a.Extent||!0===a.Function)return m.resolve(n.slice(0));var u=0,s="";for(var l in a)u++,s=l;return 1<u||"String"===s?n=_(n,function(e,r){if(null==e||e===g.voidOperation)return null==r||r===g.voidOperation?0:1;if(null==r||r===g.voidOperation)return-1;var t=g.toString(e),n=g.toString(r);return t<n?-1:t===n?0:1}):"Number"===s?n=_(n,function(e,r){return e-r}):"Boolean"===s?n=_(n,function(e,r){return e===r?0:r?-1:1}):"Date"===s&&(n=_(n,function(e,r){return r-e})),m.resolve(n)})};var Z={failDefferred:O,resolveDeffered:S,fixSpatialReference:g.fixSpatialReference,parseArguments:T,standardFunction:M,standardFunctionAsync:A,evaluateIdentifier:P,arcadeCustomFunction:Y};for(var J in H)H[J]={value:new g.NativeFunction(H[J]),valueset:!0,node:null};var W=function(){};W.prototype=H,W.prototype.infinity={value:Number.POSITIVE_INFINITY,valueset:!0,node:null},W.prototype.pi={value:Math.PI,valueset:!0,node:null},r.functionHelper=Z,r.extend=function(e){for(var r={mode:"async",compiled:!1,functions:{},signatures:[],standardFunction:M,standardFunctionAsync:A,failDefferred:O,evaluateIdentifier:P,arcadeCustomFunctionHandler:Y},t=0;t<e.length;t++)e[t].registerFunctions(r);for(var n in r.functions)H[n]={value:new g.NativeFunction(r.functions[n]),valueset:!0,node:null},W.prototype[n]=H[n];for(t=0;t<r.signatures.length;t++)E.addFunctionDeclaration(r.signatures[t],"async")},r.executeScript=function(e,r){var t=r.spatialReference;null!=t||(t=new R({wkid:102100}));var n=function(e,r){var t=new W;null!=e||(e={}),null!=r||(r={});var n=new h({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});for(var o in n.immutable=!1,t.textformatting={value:n,valueset:!0,node:null},r)t[o]={value:new g.NativeFunction(r[o]),native:!0,valueset:!0,node:null};for(var o in e)e[o]&&"esri.Graphic"===e[o].declaredClass?t[o]={value:v.createFromGraphic(e[o]),valueset:!0,node:null}:t[o]={value:e[o],valueset:!0,node:null};return t}(r.vars,r.customfunctions);return F({spatialReference:t,services:r.services,abortSignal:void 0===r.abortSignal||null===r.abortSignal?{aborted:!1}:r.abortSignal,globalScope:n,console:r.console?r.console:G,lrucache:r.lrucache,localScope:null,depthCounter:1},e.body[0].body).then(function(t){return m.create(function(e,r){return t instanceof g.ReturnResult&&(t=t.value),t instanceof g.ImplicitResult&&(t=t.value),t===g.voidOperation&&(t=null),t===g.breakResult?void r(new Error("Cannot return BREAK")):t===g.continueResult?void r(new Error("Cannot return CONTINUE")):t instanceof g.NativeFunction||t instanceof p?void r(new Error("Cannot return FUNCTION")):void e(t)})})},r.extractFieldLiterals=function(e,r){return void 0===r&&(r=!1),E.findFieldLiterals(e,r)},r.validateScript=function(e,r){return E.validateScript(e,r,"full")},r.referencesMember=function(e,r){return E.referencesMember(e,r)},r.referencesFunction=function(e,r){return E.referencesFunction(e,r)},r.findFunctionCalls=function(e){return E.findFunctionCalls(e,!1)}}.apply(null,r))||(n.exports=t)}).call(this,require("jquery"))}}]);