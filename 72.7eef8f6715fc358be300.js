(function(){(this||window).webpackJsonp.registerAbsMids({"esri/views/draw/support/drawUtils":1667,"esri/views/draw/support/GraphicMover":1746,"esri/views/draw/support/input/GraphicMoverEvents":1747,"esri/views/draw/support/Box":2761})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[72,78],{1667:function(t,e,i){var r,a;r=[i.dj.c(t.i),e,i(80),i(490),i(305)],void 0===(a=function(t,e,J,Z,K){function x(t,e,i,r){if(null==r||t.hasZ||(r=void 0),"point"===t.type)return t.x+=e,t.y+=i,t.hasZ&&null!=r&&(t.z+=r),t;if("multipoint"===t.type){for(var a=t.points,o=0;o<a.length;o++)a[o]=p(a[o],e,i,r);return t}if("extent"===t.type)return t.xmin+=e,t.xmax+=e,t.ymin+=i,t.ymax+=i,null!=r&&(t.zmin+=r,t.zmax+=r),t;for(var n=K.geometryToCoordinates(t),h="polyline"===t.type?t.paths:t.rings,s=0;s<n.length;s++){var c=n[s];for(o=0;o<c.length;o++)c[o]=p(c[o],e,i,r)}return"paths"in t?t.paths=h:t.rings=h,t}function p(t,e,i,r){return Q(t,t[0]+e,t[1]+i,null!=t[2]&&null!=r?t[2]+r:void 0)}function Q(t,e,i,r){var a=[e,i];return 2<t.length&&a.push(null!=r?r:t[2]),3<t.length&&a.push(t[3]),a}Object.defineProperty(e,"__esModule",{value:!0}),e.move=x,e.cloneMove=function(t,e,i,r,a){var o=t.clone(),n=r.resolution;if("point"===o.type){if(a)x(o,e*n,-i*n);else{var h=r.state.transform,s=r.state.inverseTransform,c=h[0]*o.x+h[2]*o.y+h[4],p=h[1]*o.x+h[3]*o.y+h[5];o.x=s[0]*(c+e)+s[2]*(p+i)+s[4],o.y=s[1]*(c+e)+s[3]*(p+i)+s[5]}return o}if("multipoint"===o.type){if(a)x(o,e*n,-i*n);else for(var l=o.points,v=(h=r.state.transform,s=r.state.inverseTransform,0);v<l.length;v++){var u=l[v],y=h[0]*u[0]+h[2]*u[1]+h[4],d=h[1]*u[0]+h[3]*u[1]+h[5];c=s[0]*(y+e)+s[2]*(d+i)+s[4],p=s[1]*(y+e)+s[3]*(d+i)+s[5];l[v]=Q(u,c,p,void 0)}return o}if("extent"===o.type){if(a)x(o,e*n,-i*n);else{h=r.state.transform,s=r.state.inverseTransform;var g=h[0]*o.xmin+h[2]*o.ymin+h[4],f=h[1]*o.xmin+h[3]*o.ymin+h[5],G=h[0]*o.xmax+h[2]*o.ymax+h[4],_=h[1]*o.xmax+h[3]*o.ymax+h[5];o.xmin=s[0]*(g+e)+s[2]*(f+i)+s[4],o.ymin=s[1]*(g+e)+s[3]*(f+i)+s[5],o.xmax=s[0]*(G+e)+s[2]*(_+i)+s[4],o.ymax=s[1]*(G+e)+s[3]*(_+i)+s[5]}return o}if(a)x(o,e*n,-i*n);else{for(var m=K.geometryToCoordinates(o),w=(l="polyline"===o.type?o.paths:o.rings,h=r.state.transform,s=r.state.inverseTransform,0);w<m.length;w++){var b=m[w];for(v=0;v<b.length;v++){u=b[v],y=h[0]*u[0]+h[2]*u[1]+h[4],d=h[1]*u[0]+h[3]*u[1]+h[5],c=s[0]*(y+e)+s[2]*(d+i)+s[4],p=s[1]*(y+e)+s[3]*(d+i)+s[5];b[v]=Q(u,c,p,void 0)}}"paths"in o?o.paths=l:o.rings=l}return o},e.scale=function(t,e,i,r){if("point"===t.type){var a=t.x,o=t.y,n=r?r[0]:a,h=r?r[1]:o,s=t.clone(),c=(a-n)*e+n,p=(o-h)*i+h;return s.x=c,s.y=p,s}if("multipoint"===t.type){for(var l=K.geometryToCoordinates(t),v=J.create(),u=Z.getRingsOrPathsBounds(v,[l]),y=u[0],d=u[1],g=u[2],f=u[3],G=r?r[0]:(y+g)/2,_=r?r[1]:(f+d)/2,m=t.clone(),w=m.points,b=0;b<w.length;b++){c=((a=(q=w[b])[0])-G)*e+G,p=((o=q[1])-_)*i+_;w[b]=Q(q,c,p,void 0)}return m}if("extent"===t.type){var x=t.xmin,S=t.xmax,k=t.ymin,E=t.ymax,M=r?r[0]:(x+S)/2,O=r?r[1]:(E+k)/2,P=t.clone();if(P.xmin=(x-M)*e+M,P.ymax=(E-O)*i+O,P.xmax=(S-M)*e+M,P.ymin=(k-O)*i+O,P.xmin>P.xmax){var R=P.xmin,C=P.xmax;P.xmin=C,P.xmax=R}if(P.ymin>P.ymax){var D=P.ymin,I=P.ymax;P.ymin=I,P.ymax=D}return P}for(var A=K.geometryToCoordinates(t),T=J.create(),H=Z.getRingsOrPathsBounds(T,A),L=H[0],B=H[1],z=H[2],Y=H[3],V=r?r[0]:(L+z)/2,N=r?r[1]:(Y+B)/2,U=t.clone(),F="polyline"===U.type?U.paths:U.rings,X=0;X<A.length;X++){var j=A[X];for(b=0;b<j.length;b++){var q;c=((a=(q=j[b])[0])-V)*e+V,p=((o=q[1])-N)*i+N;F[X][b]=Q(q,c,p,void 0)}}return"paths"in U?U.paths=F:U.rings=F,U},e.getScaleRatio=function(t,e,i,r,a,o){var n=Math.sqrt((i-t)*(i-t)+(r-e)*(r-e));return Math.sqrt((a-t)*(a-t)+(o-e)*(o-e))/n},e.getRotationAngle=function(t,e,i,r,a,o){var n=180*Math.atan2(e-r,t-i)/Math.PI;return 180*Math.atan2(e-o,t-a)/Math.PI-n}}.apply(null,r))||(t.exports=a)},1746:function(t,e,i){var r,a;r=[i.dj.c(t.i),e,i(1),i(0),i(49),i(54),i(23),i(8),i(15),i(16),i(2),i(1667),i(1747),i(156)],void 0===(a=function(t,e,i,r,s,a,o,l,v,n,h,u,y,c){return d=h.declared(a.EventedAccessor),i(p,d),p.prototype.initialize=function(){var e=this;this._handles.add([n.whenOnce(this,"view.ready",function(){e._viewHandles.add([e.view.on("immediate-click",function(t){return e._clickHandler(t)},c.ViewEventPriorities.TOOL),e.view.on("double-click",function(t){return e._doubleClickHandler(t)},c.ViewEventPriorities.TOOL),e.view.on("pointer-down",function(t){return e._pointerDownHandler(t)},c.ViewEventPriorities.TOOL),e.view.on("pointer-move",function(t){return e._pointerMoveHandler(t)},c.ViewEventPriorities.TOOL),e.view.on("pointer-up",function(t){return e._pointerUpHandler(t)},c.ViewEventPriorities.TOOL),e.view.on("drag",function(t){return e._dragHandler(t)},c.ViewEventPriorities.TOOL),e.view.on("key-down",function(t){return e._keyDownHandler(t)},c.ViewEventPriorities.TOOL)])})])},p.prototype.destroy=function(){this.reset(),this._viewHandles.removeAll(),this._handles.removeAll()},Object.defineProperty(p.prototype,"state",{get:function(){var t=!!this.get("view.ready"),e=!!this.get("graphics.length"),i=this._activeGraphic;return t&&e?i?"moving":"active":t?"ready":"disabled"},enumerable:!0,configurable:!0}),p.prototype.reset=function(){this._activeGraphic=null,this._hoverGraphic=null,this._dragEvent=null},p.prototype.updateGeometry=function(t,e){var i=this.graphics[t];i&&i.set("geometry",e)},p.prototype._clickHandler=function(a){var o=this;this.view.hitTest(v.createScreenPointFromEvent(a)).then(function(t){var e=t.results;if(e.length&&e[0].graphic){var i=e[0].graphic;if(-1<o.graphics.indexOf(i)){var r=new y.GraphicClickEvent(i,o.graphics.indexOf(i),a.x,a.y,a);o.emit("graphic-click",r),o.callbacks.onGraphicClick&&o.callbacks.onGraphicClick(r)}}})},p.prototype._doubleClickHandler=function(a){var o=this;this.view.hitTest(v.createScreenPointFromEvent(a)).then(function(t){var e=t.results;if(e.length&&e[0].graphic){var i=e[0].graphic;if(-1<o.graphics.indexOf(i)){var r=new y.GraphicDoubleClickEvent(i,o.graphics.indexOf(i),a.x,a.y,a);o.emit("graphic-double-click",r),o.callbacks.onGraphicDoubleClick&&o.callbacks.onGraphicDoubleClick(r)}}})},p.prototype._pointerDownHandler=function(n){var h=this;this._pointerDownEvent=n,this.view.hitTest(v.createScreenPointFromEvent(n)).then(function(t){var e=s.find(t.results,function(t){return-1!==h.graphics.indexOf(t.graphic)});if(e){var i=e.graphic;if(-1<h.graphics.indexOf(i)){h._activeGraphic=i;var r=n.x,a=n.y,o=new y.GraphicPointerDownEvent(i,h.graphics.indexOf(i),r,a,n);h.emit("graphic-pointer-down",o),h.callbacks.onGraphicPointerDown&&h.callbacks.onGraphicPointerDown(o)}else i!==h._activeGraphic&&(h._pointerDownEvent=null,h._activeGraphic=null)}else h._pointerDownEvent=null,h._activeGraphic=null})},p.prototype._pointerUpHandler=function(t){if(this._pointerDownEvent=null,this._activeGraphic){var e=t.x,i=t.y,r=this.graphics.indexOf(this._activeGraphic),a=new y.GraphicPointerUpEvent(this._activeGraphic,r,e,i,t);this._activeGraphic=null,this.emit("graphic-pointer-up",a),this.callbacks.onGraphicPointerUp&&this.callbacks.onGraphicPointerUp(a)}},p.prototype._pointerMoveHandler=function(c){var p=this;this._dragEvent||this.view.hitTest(v.createScreenPointFromEvent(c)).then(function(t){var e=t.results;if(e.length&&e[0].graphic){var i=e[0].graphic;if(i===p._hoverGraphic)return;if(-1<p.graphics.indexOf(i)){var r=c.x,a=c.y;if(p._hoverGraphic){var o=p.graphics.indexOf(p._hoverGraphic),n=new y.GraphicPointerOutEvent(p.graphics[o],o,r,a,c);p._hoverGraphic=null,p.emit("graphic-pointer-out",n),p.callbacks.onGraphicPointerOut&&p.callbacks.onGraphicPointerOut(n)}var h=p.graphics.indexOf(i),s=new y.GraphicPointerOverEvent(i,h,r,a,c);return p._hoverGraphic=i,p.emit("graphic-pointer-over",s),void(p.callbacks.onGraphicPointerOver&&p.callbacks.onGraphicPointerOver(s))}}p._hoverGraphic&&(r=c.x,a=c.y,o=p.graphics.indexOf(p._hoverGraphic),s=new y.GraphicPointerOutEvent(p.graphics[o],o,r,a,c),p._hoverGraphic=null,p.emit("graphic-pointer-out",s),p.callbacks.onGraphicPointerOut&&p.callbacks.onGraphicPointerOut(s))})},p.prototype._dragHandler=function(t){var e=this;if(this._pointerDownEvent){if("start"!==t.action&&!this._dragEvent||!this._activeGraphic||!this._activeGraphic.geometry)return;t.stopPropagation();var i=t.x,r=t.y,a=this.graphics.indexOf(this._activeGraphic),o=this._activeGraphic.geometry,n=this._dragEvent?i-this._dragEvent.x:0,h=this._dragEvent?r-this._dragEvent.y:0,s=i-t.origin.x,c=r-t.origin.y;if(this._activeGraphic.geometry=u.cloneMove(o,n,h,this.view),this.enableMoveAllGraphics&&this.graphics.forEach(function(t){t!==e._activeGraphic&&(t.geometry=u.cloneMove(t.geometry,n,h,e.view))}),"start"===(this._dragEvent=t).action){this._initialDragGeometry=l.clone(o);var p=new y.GraphicMoveStartEvent(this._activeGraphic,this.graphics,a,i,r,n,h,s,c,t);this.emit("graphic-move-start",p),this.callbacks.onGraphicMoveStart&&this.callbacks.onGraphicMoveStart(p),p.defaultPrevented&&this._activeGraphic.set("geometry",o)}else"update"===t.action?(p=new y.GraphicMoveEvent(this._activeGraphic,this.graphics,a,i,r,n,h,s,c,t),this.emit("graphic-move",p),this.callbacks.onGraphicMove&&this.callbacks.onGraphicMove(p),p.defaultPrevented&&this._activeGraphic.set("geometry",o)):(this._dragEvent=null,p=new y.GraphicMoveStopEvent(this._activeGraphic,this.graphics,a,i,r,n,h,s,c,t),this.emit("graphic-move-stop",p),this.callbacks.onGraphicMoveStop&&this.callbacks.onGraphicMoveStop(p),p.defaultPrevented&&this.graphics[a].set("geometry",this._initialDragGeometry),this._initialDragGeometry=null)}},p.prototype._keyDownHandler=function(t){"a"!==t.key&&"d"!==t.key&&"n"!==t.key||"moving"!==this.state||t.stopPropagation()},r([h.property()],p.prototype,"_activeGraphic",void 0),r([h.property({readOnly:!0})],p.prototype,"type",void 0),r([h.property()],p.prototype,"callbacks",void 0),r([h.property()],p.prototype,"enableMoveAllGraphics",void 0),r([h.property()],p.prototype,"graphics",void 0),r([h.property({dependsOn:["view.ready","graphics.length","_activeGraphic"],readOnly:!0})],p.prototype,"state",null),r([h.property()],p.prototype,"view",void 0),r([h.subclass("esri.views.draw.support.GraphicMover")],p);function p(t){var e=d.call(this,t)||this;return e._activeGraphic=null,e._dragEvent=null,e._handles=new o,e._hoverGraphic=null,e._initialDragGeometry=null,e._pointerDownEvent=null,e._viewHandles=new o,e.type="graphic-mover",e.callbacks={onGraphicClick:function(){},onGraphicDoubleClick:function(){},onGraphicMoveStart:function(){},onGraphicMove:function(){},onGraphicMoveStop:function(){},onGraphicPointerOver:function(){},onGraphicPointerOut:function(){},onGraphicPointerDown:function(){},onGraphicPointerUp:function(){}},e.enableMoveAllGraphics=!1,e.graphics=[],e.view=null,e}var d}.apply(null,r))||(t.exports=a)},1747:function(t,e,i){var r,a;r=[i.dj.c(t.i),e],void 0===(a=function(t,e){Object.defineProperty(e,"__esModule",{value:!0});function i(t,e,i,r,a){this.graphic=t,this.index=e,this.x=i,this.y=r,this.viewEvent=a,this.type="graphic-click"}e.GraphicClickEvent=i;function r(t,e,i,r,a){this.graphic=t,this.index=e,this.x=i,this.y=r,this.viewEvent=a,this.type="graphic-double-click"}e.GraphicDoubleClickEvent=r;var a=(o.prototype.preventDefault=function(){this.defaultPrevented=!0},o);function o(t,e,i,r,a,o,n,h,s,c){this.graphic=t,this.allGraphics=e,this.index=i,this.x=r,this.y=a,this.dx=o,this.dy=n,this.totalDx=h,this.totalDy=s,this.viewEvent=c,this.defaultPrevented=!1,this.type="graphic-move-start"}e.GraphicMoveStartEvent=a;var n=(h.prototype.preventDefault=function(){this.defaultPrevented=!0},h);function h(t,e,i,r,a,o,n,h,s,c){this.graphic=t,this.allGraphics=e,this.index=i,this.x=r,this.y=a,this.dx=o,this.dy=n,this.totalDx=h,this.totalDy=s,this.viewEvent=c,this.defaultPrevented=!1,this.type="graphic-move"}e.GraphicMoveEvent=n;var s=(c.prototype.preventDefault=function(){this.defaultPrevented=!0},c);function c(t,e,i,r,a,o,n,h,s,c){this.graphic=t,this.allGraphics=e,this.index=i,this.x=r,this.y=a,this.dx=o,this.dy=n,this.totalDx=h,this.totalDy=s,this.viewEvent=c,this.defaultPrevented=!1,this.type="graphic-move-stop"}e.GraphicMoveStopEvent=s;function p(t,e,i,r,a){this.graphic=t,this.index=e,this.x=i,this.y=r,this.viewEvent=a,this.type="graphic-pointer-over"}e.GraphicPointerOverEvent=p;function l(t,e,i,r,a){this.graphic=t,this.index=e,this.x=i,this.y=r,this.viewEvent=a,this.type="graphic-pointer-out"}e.GraphicPointerOutEvent=l;function v(t,e,i,r,a){this.graphic=t,this.index=e,this.x=i,this.y=r,this.viewEvent=a,this.type="graphic-pointer-down"}e.GraphicPointerDownEvent=v;function u(t,e,i,r,a){this.graphic=t,this.index=e,this.x=i,this.y=r,this.viewEvent=a,this.type="graphic-pointer-up"}e.GraphicPointerUpEvent=u}.apply(null,r))||(t.exports=a)},2761:function(t,e,i){var r,a;r=[i.dj.c(t.i),e,i(1),i(0),i(28),i(89),i(54),i(23),i(12),i(16),i(2),i(1571),i(80),i(490),i(305),i(132),i(77),i(167),i(1667),i(1746),i(1789)],void 0===(a=function(t,e,i,r,q,a,o,n,h,s,c,G,l,y,d,p,v,g,J,u,f){var _,m=function(t,e,i,r){this.graphics=t,this.mover=e,this.dx=i,this.dy=r,this.type="move-start"},w=function(t,e,i,r){this.graphics=t,this.mover=e,this.dx=i,this.dy=r,this.type="move"},b=function(t,e,i,r){this.graphics=t,this.mover=e,this.dx=i,this.dy=r,this.type="move-stop"},x=function(t,e,i){this.graphics=t,this.mover=e,this.angle=i,this.type="rotate-start"},S=function(t,e,i){this.graphics=t,this.mover=e,this.angle=i,this.type="rotate"},k=function(t,e,i){this.graphics=t,this.mover=e,this.angle=i,this.type="rotate-stop"},E=function(t,e,i,r){this.graphics=t,this.mover=e,this.xScale=i,this.yScale=r,this.type="scale-start"},M=function(t,e,i,r){this.graphics=t,this.mover=e,this.xScale=i,this.yScale=r,this.type="scale"},O=function(t,e,i,r){this.graphics=t,this.mover=e,this.xScale=i,this.yScale=r,this.type="scale-stop"};return _=c.declared(o.EventedAccessor),i(P,_),P.prototype.initialize=function(){var i=this;this._setup(),this._handles.add([s.whenOnce(this,"view.ready",function(){var t=i.layer,e=i.view;f.addUniqueLayer(e,t)}),s.pausable(this,"preserveAspectRatio",function(){i._activeHandleGraphic&&(i._scaleGraphic(i._activeHandleGraphic),i._updateGraphics())}),s.pausable(this,"view.scale",function(){i._updateRotateGraphic(),i._updateRotateLineGraphic()}),s.pausable(this,"graphics",function(){return i.refresh()}),s.pausable(this,"layer",function(t,e){e&&i._resetGraphics(e),i.refresh()})])},P.prototype.destroy=function(){this._reset(),this._handles&&(this._handles.removeAll(),this._handles=null)},Object.defineProperty(P.prototype,"state",{get:function(){var t=!!this.get("view.ready"),e=!(!this.get("graphics.length")||!this.get("layer"));return t&&e?"active":t?"ready":"disabled"},enumerable:!0,configurable:!0}),P.prototype.isUIGraphic=function(t){var e=[];return this.handleGraphics.length&&(e=e.concat(this.handleGraphics)),this.backgroundGraphic&&e.push(this.backgroundGraphic),this.centerGraphic&&e.push(this.centerGraphic),this.rotateGraphic&&e.push(this.rotateGraphic),this._rotateLineGraphic&&e.push(this._rotateLineGraphic),e.length&&-1<e.indexOf(t)},P.prototype.move=function(t,e){if(this._mover&&this.graphics.length){for(var i=0,r=this.graphics;i<r.length;i++){var a=r[i],o=a.geometry,n=J.cloneMove(o,t,e,this.view);a.geometry=n}this.refresh(),this._emitMoveStopEvent(t,e,null)}},P.prototype.scale=function(t,e){if(this._mover&&this.graphics.length){for(var i=0,r=this.graphics;i<r.length;i++){var a=r[i],o=a.geometry,n=J.scale(o,t,e);a.geometry=n}this.refresh(),this._emitScaleStopEvent(t,e,null)}},P.prototype.rotate=function(t,e){if(this._mover&&this.graphics.length){if(!e){var i=this.handleGraphics[1].geometry.x,r=this.handleGraphics[3].geometry.y;e=new q.Point(i,r,this.view.spatialReference)}for(var a=0,o=this.graphics;a<o.length;a++){var n=o[a],h=n.geometry,s=G.rotate(h,t,e);n.geometry=s}this.refresh(),this._emitRotateStopEvent(t,null)}},P.prototype.refresh=function(){this._reset(),this._setup()},P.prototype.reset=function(){this.graphics=[]},P.prototype._setup=function(){"active"===this.state&&(this._setupGraphics(),this._setupMover(),this._updateGraphics())},P.prototype._reset=function(){this._resetGraphicStateVars(),this._resetGraphics(),this._mover&&this._mover.destroy(),this._mover=null,this.view.cursor="default"},P.prototype._resetGraphicStateVars=function(){this._startInfo=null,this._activeHandleGraphic=null,this._totalDx=0,this._totalDy=0,this._xScale=1,this._yScale=1,this._rotationAngle=0},P.prototype._resetGraphics=function(t){var e=t||this.layer;e&&(e.removeMany(this.handleGraphics),e.remove(this.backgroundGraphic),e.remove(this.centerGraphic),e.remove(this.rotateGraphic),e.remove(this._rotateLineGraphic));for(var i=0,r=this.handleGraphics;i<r.length;i++)r[i].destroy();this._set("handleGraphics",[]),this.backgroundGraphic&&(this.backgroundGraphic.destroy(),this._set("backgroundGraphic",null)),this.centerGraphic&&(this.centerGraphic.destroy(),this._set("centerGraphic",null)),this.rotateGraphic&&(this.rotateGraphic.destroy(),this._set("rotateGraphic",null)),this._rotateLineGraphic&&(this._rotateLineGraphic.destroy(),this._rotateLineGraphic=null)},P.prototype._setupMover=function(){var e=this,t=[].concat(this.handleGraphics);this.enableMovement&&(t=t.concat(this.graphics,this.backgroundGraphic)),this.enableRotation&&t.push(this.rotateGraphic),this.showCenterGraphic&&t.push(this.centerGraphic),this._mover=new u({enableMoveAllGraphics:!1,view:this.view,graphics:t,callbacks:{onGraphicClick:function(t){return e._onGraphicClickCallback(t)},onGraphicMoveStart:function(t){return e._onGraphicMoveStartCallback(t)},onGraphicMove:function(t){return e._onGraphicMoveCallback(t)},onGraphicMoveStop:function(t){return e._onGraphicMoveStopCallback(t)},onGraphicPointerOver:function(t){return e._onGraphicPointerOverCallback(t)},onGraphicPointerOut:function(t){return e._onGraphicPointerOutCallback(t)}}})},P.prototype._getStartInfo=function(t){var e=this._getBoxBounds(l.create()),i=e[0],r=e[1],a=e[2],o=e[3],n=Math.abs(a-i),h=Math.abs(o-r),s=(a+i)/2,c=(o+r)/2,p=t.geometry;return{width:n,height:h,centerX:s,centerY:c,startX:p.x,startY:p.y,graphicInfos:this._getGraphicInfos(),box:this.backgroundGraphic.geometry,rotate:this.rotateGraphic.geometry}},P.prototype._getGraphicInfos=function(){var e=this;return this.graphics.map(function(t){return e._getGraphicInfo(t)})},P.prototype._getGraphicInfo=function(t){var e=t.geometry,i=this._getBounds(l.create(),[e]),r=i[0],a=i[1],o=i[2],n=i[3];return{width:Math.abs(o-r),height:Math.abs(n-a),centerX:(o+r)/2,centerY:(n+a)/2,geometry:e}},P.prototype._onGraphicClickCallback=function(t){var e=t.graphic;(e===this.rotateGraphic||-1<this.handleGraphics.indexOf(e))&&t.viewEvent.stopPropagation()},P.prototype._onGraphicMoveStartCallback=function(t){var e=t.graphic;this._resetGraphicStateVars(),this._hideGraphicsBeforeUpdate(),this.backgroundGraphic.symbol=this._dashedFillSymbol,this._startInfo=this._getStartInfo(e),e===this.rotateGraphic?this._emitRotateStartEvent(this._rotationAngle,e):-1<this.handleGraphics.indexOf(e)?(this._activeHandleGraphic=e,this._emitScaleStartEvent(this._xScale,this._yScale,e)):this._emitMoveStartEvent(t.dx,t.dy,e)},P.prototype._onGraphicMoveCallback=function(t){var e=t.graphic;if(this._startInfo)if(-1<this.handleGraphics.indexOf(e))this._scaleGraphic(e),this._emitScaleEvent(this._xScale,this._yScale,e);else if(e===this.rotateGraphic)this._rotateGraphic(e),this._emitRotateEvent(this._rotationAngle,e);else{var i=t.dx,r=t.dy;this._totalDx+=i,this._totalDy+=r,this._moveGraphic(e,i,r),this._emitMoveEvent(i,r,e)}},P.prototype._onGraphicMoveStopCallback=function(t){var e=t.graphic;this._startInfo?(this._updateGraphics(),this._showGraphicsAfterUpdate(),this.backgroundGraphic.symbol=this._defaultFillSymbol,e===this.rotateGraphic?this._emitRotateStopEvent(this._rotationAngle,e):-1<this.handleGraphics.indexOf(e)?this._emitScaleStopEvent(this._xScale,this._yScale,e):this._emitMoveStopEvent(this._totalDx,this._totalDy,e),this._resetGraphicStateVars()):this.refresh()},P.prototype._onGraphicPointerOverCallback=function(t){var e,i=this.view.rotation,r=t.index;switch(t.graphic===this.rotateGraphic&&(this.rotateGraphic.symbol=this._rotateGraphicHoverSymbol),r<8&&(0<=i&&i<45?r%=8:r=45<=i&&i<90?(r+1)%8:90<=i&&i<135?(r+2)%8:135<=i&&i<180?(r+3)%8:180<=i&&i<225?(r+4)%8:225<=i&&i<270?(r+5)%8:270<=i&&i<315?(r+6)%8:(r+7)%8),r){case 0:e="nwse-resize";break;case 1:e="ns-resize";break;case 2:e="nesw-resize";break;case 3:e="ew-resize";break;case 4:e="nwse-resize";break;case 5:e="ns-resize";break;case 6:e="nesw-resize";break;case 7:e="ew-resize";break;default:e="pointer"}this.view.cursor=e},P.prototype._onGraphicPointerOutCallback=function(t){t.graphic===this.rotateGraphic&&(this.rotateGraphic.symbol=this._rotateGraphicSymbol),this.view.cursor="default"},P.prototype._scaleGraphic=function(t){var e=this._startInfo,i=this.handleGraphics,r=this.preserveAspectRatio,a=this.view,o=e.centerX,n=e.centerY,h=e.startX,s=e.startY,c=a.state,p=c.resolution,l=c.transform,v=i.indexOf(t);1!==v&&5!==v||this._updateX(t,o),3!==v&&7!==v||this._updateY(t,n);var u=t.geometry,y=u.x,d=u.y,g=l[0]*y+l[2]*d+l[4],f=l[1]*y+l[3]*d+l[5],G=e.graphicInfos.map(function(t){return t.geometry});if(r){var _=l[0]*o+l[2]*n+l[4],m=l[1]*o+l[3]*n+l[5],w=l[0]*h+l[2]*s+l[4],b=l[1]*h+l[3]*s+l[5];this._xScale=this._yScale=J.getScaleRatio(_,m,w,b,g,f);for(var x=0,S=G;x<S.length;x++){var k=S[x],E=G.indexOf(k);this.graphics[E].geometry=J.scale(k,this._xScale,this._yScale,[o,n])}this._updateBackgroundGraphic()}else{var M=e.width,O=e.height,P=y-h,R=s-d;if(1===v||5===v?P=0:3!==v&&7!==v||(R=0),0===P&&0===R)return;var C=M+(o<h?P:-1*P),D=O+(s<n?R:-1*R),I=o+P/2,A=n+R/2;this._xScale=C/M||1,this._yScale=D/O||1,1===v||5===v?this._xScale=1:3!==v&&7!==v||(this._yScale=1);var T=(I-o)/p,H=(A-n)/p,L=J.scale(e.box,this._xScale,this._yScale);this.backgroundGraphic.geometry=J.cloneMove(L,T,H,a,!0);for(var B=this._getGraphicInfo(this.backgroundGraphic),z=B.centerX,Y=B.centerY,V=(z-o)/p,N=-1*(Y-n)/p,U=0,F=G;U<F.length;U++){k=F[U];var X=G.indexOf(k),j=J.scale(k,this._xScale,this._yScale,[o,n]);this.graphics[X].geometry=J.cloneMove(j,V,N,a,!0)}this.centerGraphic.geometry=new q.Point(z,Y,a.spatialReference)}},P.prototype._rotateGraphic=function(t){var e=this._startInfo,i=e.centerX,r=e.centerY,a=e.startX,o=e.startY,n=e.box,h=e.rotate,s=t.geometry,c=s.x,p=s.y,l=new q.Point(i,r,this.view.spatialReference);this._rotationAngle=J.getRotationAngle(i,r,a,o,c,p);for(var v=this._startInfo.graphicInfos.map(function(t){return t.geometry}),u=0,y=v;u<y.length;u++){var d=y[u],g=v.indexOf(d),f=G.rotate(d,this._rotationAngle,l);this.graphics[g].geometry=f}this.backgroundGraphic.geometry=G.rotate(n,this._rotationAngle,l),this.rotateGraphic.geometry=G.rotate(h,this._rotationAngle,l)},P.prototype._moveGraphic=function(t,e,i){if(-1<this.graphics.indexOf(t)){var r=this.backgroundGraphic.geometry;this.backgroundGraphic.geometry=J.cloneMove(r,e,i,this.view);for(var a=0,o=this.graphics;a<o.length;a++)(s=o[a])!==t&&(s.geometry=J.cloneMove(s.geometry,e,i,this.view))}else t===this.centerGraphic&&(r=this.backgroundGraphic.geometry,this.backgroundGraphic.geometry=J.cloneMove(r,e,i,this.view));if(t===this.backgroundGraphic||t===this.centerGraphic)for(var n=0,h=this.graphics;n<h.length;n++){var s;(s=h[n]).geometry=J.cloneMove(s.geometry,e,i,this.view)}},P.prototype._setupGraphics=function(){this._set("centerGraphic",new a(null,this._centerGraphicSymbol)),this.showCenterGraphic&&this.layer.add(this.centerGraphic),this._set("backgroundGraphic",new a(null,this._defaultFillSymbol)),this.layer.add(this.backgroundGraphic),this._rotateLineGraphic=new a(null,this._rotateLineGraphicSymbol),this._set("rotateGraphic",new a(null,this._rotateGraphicSymbol)),this.enableRotation&&!this._hasExtentGraphic()&&(this.layer.add(this._rotateLineGraphic),this.layer.add(this.rotateGraphic));for(var t=0;t<8;t++)this.handleGraphics.push(new a(null,this._defaultGraphicSymbol));this.enableScaling&&this.layer.addMany(this.handleGraphics)},P.prototype._updateGraphics=function(){this._updateBackgroundGraphic(),this._updateHandleGraphics(),this._updateCenterGraphic(),this._updateRotateGraphic(),this._updateRotateLineGraphic()},P.prototype._hideGraphicsBeforeUpdate=function(){this.centerGraphic.visible=!1,this.rotateGraphic.visible=!1,this._rotateLineGraphic.visible=!1,this.handleGraphics.forEach(function(t){return t.visible=!1})},P.prototype._showGraphicsAfterUpdate=function(){this.enableRotation&&(this._rotateLineGraphic.visible=!0,this.rotateGraphic.visible=!0),this.showCenterGraphic&&(this.centerGraphic.visible=!0),this.enableScaling&&this.handleGraphics.forEach(function(t){return t.visible=!0})},P.prototype._updateHandleGraphics=function(){var o=this,n=this._getCoordinates(!0);this.handleGraphics.forEach(function(t,e){var i=n[e],r=i[0],a=i[1];o._updateXY(t,r,a)})},P.prototype._updateBackgroundGraphic=function(){var t=this._getCoordinates();this.backgroundGraphic.geometry=new q.Polygon({rings:t,spatialReference:this.view.spatialReference})},P.prototype._updateCenterGraphic=function(){var t=this._getBoxBounds(l.create()),e=t[0],i=t[1],r=(t[2]+e)/2,a=(t[3]+i)/2;this.centerGraphic.geometry=new q.Point(r,a,this.view.spatialReference)},P.prototype._updateRotateGraphic=function(){if(this.handleGraphics.length){var t=this.handleGraphics[1].geometry,e=t.x,i=t.y+this.view.state.resolution*this._rotateGraphicOffset;this.rotateGraphic.geometry=new q.Point(e,i,this.view.spatialReference)}},P.prototype._updateRotateLineGraphic=function(){if(this.handleGraphics.length&&this.rotateGraphic&&this.rotateGraphic.geometry){var t=this.handleGraphics[1].geometry,e=this.rotateGraphic.geometry;this._rotateLineGraphic.geometry=new q.Polyline({paths:[[t.x,t.y],[e.x,e.y]],spatialReference:this.view.spatialReference})}},P.prototype._updateXY=function(t,e,i){t.geometry=new q.Point(e,i,this.view.spatialReference)},P.prototype._updateX=function(t,e){var i=t.geometry.y;t.geometry=new q.Point(e,i,this.view.spatialReference)},P.prototype._updateY=function(t,e){var i=t.geometry.x;t.geometry=new q.Point(i,e,this.view.spatialReference)},P.prototype._hasExtentGraphic=function(){return this.graphics.some(function(t){return t&&h.isSome(t.geometry)&&"extent"===t.geometry.type})},P.prototype._getBoxBounds=function(t){var e=this.graphics.map(function(t){return t.geometry});return this._getBounds(t,e)},P.prototype._getCoordinates=function(t){var e=this._getBoxBounds(l.create()),i=e[0],r=e[1],a=e[2],o=e[3];if(t){var n=(i+a)/2,h=(o+r)/2;return[[i,o],[n,o],[a,o],[a,h],[a,r],[n,r],[i,r],[i,h]]}return[[i,o],[a,o],[a,r],[i,r]]},P.prototype._emitMoveStartEvent=function(t,e,i){var r=new m(this.graphics,i,t,e);this.emit("move-start",r),this.callbacks.onMoveStart&&this.callbacks.onMoveStart(r)},P.prototype._emitMoveEvent=function(t,e,i){var r=new w(this.graphics,i,t,e);this.emit("move",r),this.callbacks.onMove&&this.callbacks.onMove(r)},P.prototype._emitMoveStopEvent=function(t,e,i){var r=new b(this.graphics,i,t,e);this.emit("move-stop",r),this.callbacks.onMoveStop&&this.callbacks.onMoveStop(r)},P.prototype._emitRotateStartEvent=function(t,e){var i=new x(this.graphics,e,t);this.emit("rotate-start",i),this.callbacks.onRotateStart&&this.callbacks.onRotateStart(i)},P.prototype._emitRotateEvent=function(t,e){var i=new S(this.graphics,e,t);this.emit("rotate",i),this.callbacks.onRotate&&this.callbacks.onRotate(i)},P.prototype._emitRotateStopEvent=function(t,e){var i=new k(this.graphics,e,t);this.emit("rotate-stop",i),this.callbacks.onRotateStop&&this.callbacks.onRotateStop(i)},P.prototype._emitScaleStartEvent=function(t,e,i){var r=new E(this.graphics,i,t,e);this.emit("scale-start",r),this.callbacks.onScaleStart&&this.callbacks.onScaleStart(r)},P.prototype._emitScaleEvent=function(t,e,i){var r=new M(this.graphics,i,t,e);this.emit("scale",r),this.callbacks.onScale&&this.callbacks.onScale(r)},P.prototype._emitScaleStopEvent=function(t,e,i){var r=new O(this.graphics,i,t,e);this.emit("scale-stop",r),this.callbacks.onScaleStop&&this.callbacks.onScaleStop(r)},r([c.property()],P.prototype,"_rotateLineGraphic",void 0),r([c.property({readOnly:!0})],P.prototype,"type",void 0),r([c.property()],P.prototype,"callbacks",void 0),r([c.property({readOnly:!0})],P.prototype,"centerGraphic",void 0),r([c.property({readOnly:!0})],P.prototype,"backgroundGraphic",void 0),r([c.property()],P.prototype,"enableMovement",void 0),r([c.property()],P.prototype,"enableRotation",void 0),r([c.property()],P.prototype,"enableScaling",void 0),r([c.property()],P.prototype,"graphics",void 0),r([c.property({readOnly:!0})],P.prototype,"handleGraphics",void 0),r([c.property()],P.prototype,"layer",void 0),r([c.property()],P.prototype,"preserveAspectRatio",void 0),r([c.property({readOnly:!0})],P.prototype,"rotateGraphic",void 0),r([c.property()],P.prototype,"showCenterGraphic",void 0),r([c.property({dependsOn:["view.ready","graphics.length","layer"],readOnly:!0})],P.prototype,"state",null),r([c.property()],P.prototype,"view",void 0),r([c.subclass("esri.views.draw.support.Box")],P);function P(t){var u,e=_.call(this,t)||this;return e._activeHandleGraphic=null,e._centerGraphicSymbol=new g({style:"circle",size:4,color:[255,255,255,1],outline:{color:[0,12,207],width:1}}),e._defaultFillSymbol=new p({color:[12,207,255,.075],outline:{join:"round",color:[0,12,207],width:2}}),e._dashedFillSymbol=new p({color:[0,0,0,0],outline:{style:"dash",color:[150,150,150,.5],width:2}}),e._defaultGraphicSymbol=new g({style:"square",size:8,color:[255,255,255,1],outline:{color:[0,12,207],width:1}}),e._handles=new n,e._mover=null,e._rotateGraphicOffset=20,e._rotateGraphicHoverSymbol=new g({style:"circle",size:10,color:[255,255,255,1],outline:{color:[0,12,207],width:1}}),e._rotateGraphicSymbol=new g({style:"circle",size:8,color:[255,255,255,1],outline:{color:[0,12,207],width:1}}),e._rotationAngle=0,e._rotateLineGraphic=null,e._rotateLineGraphicSymbol=new v({color:[0,12,207],width:2}),e._startInfo=null,e._totalDx=0,e._totalDy=0,e._xScale=1,e._yScale=1,e.type="box",e.callbacks={onMoveStart:function(t){},onMove:function(t){},onMoveStop:function(t){},onScaleStart:function(t){},onScale:function(t){},onScaleStop:function(t){},onRotateStart:function(t){},onRotate:function(t){},onRotateStop:function(t){}},e.centerGraphic=null,e.backgroundGraphic=null,e.enableMovement=!0,e.enableRotation=!0,e.enableScaling=!0,e.graphics=[],e.handleGraphics=[],e.layer=null,e.preserveAspectRatio=!1,e.rotateGraphic=null,e.showCenterGraphic=!0,e.view=null,e._getBounds=(u=l.create(),function(t,e){var i,r,a;t[0]=Number.POSITIVE_INFINITY,t[1]=Number.POSITIVE_INFINITY,t[2]=Number.NEGATIVE_INFINITY,t[3]=Number.NEGATIVE_INFINITY;for(var o=0,n=e;o<n.length;o++){var h=n[o];if(h){var s=void 0,c=void 0,p=void 0,l=void 0;if("point"===h.type)s=p=h.x,c=l=h.y;else if("multipoint"===h.type){var v=d.geometryToCoordinates(h);s=(i=y.getRingsOrPathsBounds(u,[v]))[0],c=i[1],p=i[2],l=i[3]}else l="extent"===h.type?(s=(r=[h.xmin,h.ymin,h.xmax,h.ymax])[0],c=r[1],p=r[2],r[3]):(v=d.geometryToCoordinates(h),s=(a=y.getRingsOrPathsBounds(u,v))[0],c=a[1],p=a[2],a[3]);t[0]=Math.min(s,t[0]),t[1]=Math.min(c,t[1]),t[2]=Math.max(p,t[2]),t[3]=Math.max(l,t[3])}}return t}),e}}.apply(null,r))||(t.exports=a)}}]);