(function(){(this||window).webpackJsonp.registerAbsMids({"esri/portal/support/layersCreator":555,"esri/portal/support/portalLayers":1585,"esri/layers/support/lazyLayerLoader":1671,"esri/portal/support/mapNotesUtils":1750})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[21,76],{1585:function(e,r,n){var a,t;a=[n.dj.c(e.i),r,n(5),n(29),n(18),n(6),n(4),n(1671),n(158),n(1750)],void 0===(t=function(e,r,t,n,a,i,o,c,u,l){function y(e){switch(e.type){case"Map Service":return p(e).then(function(e){return e?{className:"TileLayer"}:{className:"MapImageLayer"}});case"Feature Service":return L(e).then(function(e){if("object"!=typeof e)return{className:"GroupLayer"};var r={};return null!=e.id&&(r.layerId=e.id),{className:"FeatureLayer",properties:r}});case"Feature Collection":return(r=e).load().then(function(){return r.fetchData()}).then(function(e){if(e&&Array.isArray(e.layers)){if(l.isMapNotesLayer(e))return{className:"MapNotesLayer"};if(1===e.layers.length)return{className:"FeatureLayer"}}return{className:"GroupLayer"}});case"Scene Service":return L(c=e).then(function(e){if("object"!=typeof e)return{className:"GroupLayer"};var a={},r=void 0;if(r=null!=e.id?(a.layerId=e.id,c.url+"/layers/"+e.id):c.url,Array.isArray(c.typeKeywords)&&0<c.typeKeywords.length)for(var n={IntegratedMesh:"IntegratedMeshLayer","3DObject":"SceneLayer",Point:"SceneLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"},t=0,i=Object.keys(n);t<i.length;t++){var o=i[t];if(-1!==c.typeKeywords.indexOf(o))return{className:n[o]}}return f(r).then(function(e){var r="SceneLayer",n={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};return e&&e.layerType&&n[e.layerType]&&(r=n[e.layerType]),{className:r,properties:a}})});case"Image Service":return p(n=e).then(function(e){var r=new a(n.typeKeywords);return e?r.find(function(e){return"elevation 3d layer"===e.toLowerCase()})?{className:"ElevationLayer"}:{className:"TileLayer"}:{className:"ImageryLayer"}});case"Stream Service":return{className:"StreamLayer"};case"Vector Tile Service":return{className:"VectorTileLayer"};case"KML":return{className:"KMLLayer"};case"WMTS":return{className:"WMTSLayer"};case"WMS":return{className:"WMSLayer"};default:return o.reject(new i("portal:unknown-item-type","Unknown item type '${type}'",{type:e.type}))}var n,c,r}function s(r){return(0,c.layerLookupMap[r.className])().then(function(e){return{constructor:e,properties:r.properties}})}function p(e){return f(e.url).then(function(e){return e.tileInfo})}function L(r){return!r.url||r.url.match(/\/\d+$/)?o.resolve({}):r.load().then(function(){return r.fetchData()}).then(function(e){return e&&Array.isArray(e.layers)?1===e.layers.length&&{id:e.layers[0].id}:f(r.url).then(function(e){return e&&Array.isArray(e.layers)?1===e.layers.length&&{id:e.layers[0].id}:{}})})}function f(e){return n(e,{responseType:"json",query:{f:"json"}}).then(function(e){return e.data})}Object.defineProperty(r,"__esModule",{value:!0}),r.fromItem=function(a){return!a.portalItem||a.portalItem instanceof u||a.portalItem.constructor&&a.portalItem.constructor._meta||(a=t({},a,{portalItem:new u(a.portalItem)})),a.portalItem.load().then(y).then(s).then(function(e){var r=t({portalItem:a.portalItem},e.properties),n=e.constructor;return o.resolve(new n(r))})},r.selectLayerClassPath=y}.apply(null,a))||(e.exports=t)},1671:function(e,r,a){var n,t;n=[a.dj.c(e.i),r,a(4)],void 0===(t=function(e,r,n){Object.defineProperty(r,"__esModule",{value:!0}),r.layerLookupMap={CSVLayer:function(){return n.create(function(r){return a.e(23).then(function(){var e=[a(1578)];r.apply(null,e)}.bind(this)).catch(a.oe)})},ElevationLayer:function(){return n.create(function(r){return Promise.resolve().then(function(){var e=[a(219)];r.apply(null,e)}.bind(this)).catch(a.oe)})},FeatureLayer:function(){return n.create(function(r){return Promise.resolve().then(function(){var e=[a(154)];r.apply(null,e)}.bind(this)).catch(a.oe)})},GroupLayer:function(){return n.create(function(r){return a.e(10).then(function(){var e=[a(1573)];r.apply(null,e)}.bind(this)).catch(a.oe)})},GeoRSSLayer:function(){return n.create(function(r){return a.e(29).then(function(){var e=[a(1579)];r.apply(null,e)}.bind(this)).catch(a.oe)})},ImageryLayer:function(){return n.create(function(r){return a.e(12).then(function(){var e=[a(1574)];r.apply(null,e)}.bind(this)).catch(a.oe)})},KMLLayer:function(){return n.create(function(r){return a.e(25).then(function(){var e=[a(1581)];r.apply(null,e)}.bind(this)).catch(a.oe)})},MapImageLayer:function(){return n.create(function(r){return a.e(11).then(function(){var e=[a(1572)];r.apply(null,e)}.bind(this)).catch(a.oe)})},MapNotesLayer:function(){return n.create(function(r){return a.e(86).then(function(){var e=[a(1784)];r.apply(null,e)}.bind(this)).catch(a.oe)})},OpenStreetMapLayer:function(){return n.create(function(r){return a.e(30).then(function(){var e=[a(1582)];r.apply(null,e)}.bind(this)).catch(a.oe)})},PointCloudLayer:function(){return n.create(function(r){return a.e(14).then(function(){var e=[a(1583)];r.apply(null,e)}.bind(this)).catch(a.oe)})},SceneLayer:function(){return n.create(function(r){return a.e(19).then(function(){var e=[a(1575)];r.apply(null,e)}.bind(this)).catch(a.oe)})},BuildingSceneLayer:function(){return n.create(function(r){return a.e(16).then(function(){var e=[a(1577)];r.apply(null,e)}.bind(this)).catch(a.oe)})},IntegratedMeshLayer:function(){return n.create(function(r){return a.e(24).then(function(){var e=[a(1580)];r.apply(null,e)}.bind(this)).catch(a.oe)})},StreamLayer:function(){return n.create(function(r){return a.e(27).then(function(){var e=[a(1576)];r.apply(null,e)}.bind(this)).catch(a.oe)})},TileLayer:function(){return n.create(function(r){return Promise.resolve().then(function(){var e=[a(220)];r.apply(null,e)}.bind(this)).catch(a.oe)})},UnknownLayer:function(){return n.create(function(r){return a.e(87).then(function(){var e=[a(1785)];r.apply(null,e)}.bind(this)).catch(a.oe)})},UnsupportedLayer:function(){return n.create(function(r){return a.e(88).then(function(){var e=[a(1786)];r.apply(null,e)}.bind(this)).catch(a.oe)})},VectorTileLayer:function(){return n.create(function(r){return Promise.resolve().then(function(){var e=[a(319)];r.apply(null,e)}.bind(this)).catch(a.oe)})},WebTileLayer:function(){return n.create(function(r){return Promise.resolve().then(function(){var e=[a(311)];r.apply(null,e)}.bind(this)).catch(a.oe)})},WMSLayer:function(){return n.create(function(r){return a.e(20).then(function(){var e=[a(1584)];r.apply(null,e)}.bind(this)).catch(a.oe)})},WMTSLayer:function(){return n.create(function(r){return a.e(67).then(function(){var e=[a(1787)];r.apply(null,e)}.bind(this)).catch(a.oe)})},BingMapsLayer:function(){return n.create(function(r){return a.e(8).then(function(){var e=[a(317)];r.apply(null,e)}.bind(this)).catch(a.oe)})}}}.apply(null,n))||(e.exports=t)},1750:function(e,r,n){var a,t;a=[n.dj.c(e.i),r],void 0===(t=function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.isMapNotesLayer=function(e){var n=["TITLE","DESCRIPTION","IMAGE_URL","IMAGE_LINK_URL"],r=e.layers||e.featureCollection&&e.featureCollection.layers;if(r&&Array.isArray(r)){var a=r[0];return a.layerDefinition&&Array.isArray(a.layerDefinition.fields)&&a.layerDefinition.fields.forEach(function(e){var r=n.indexOf(e.name);-1<r&&n.splice(r,1)}),!n.length}}}.apply(null,a))||(e.exports=t)},555:function(e,r,n){var a,t;a=[n.dj.c(e.i),r,n(9),n(10),n(18),n(14),n(4),n(1671),n(158),n(1750),n(1585),n(519)],void 0===(t=function(e,r,L,u,c,n,f,s,p,d,h,i){function a(n,a,t){return u(this,void 0,void 0,function(){var r;return L(this,function(e){switch(e.label){case 0:return(r=new n).read(a,t.context),"group"===r.type&&S(a)?[4,function(i,o,c){return u(this,void 0,void 0,function(){var n,r,a,t;return L(this,function(e){switch(e.label){case 0:return[4,(0,s.layerLookupMap.FeatureLayer)()];case 1:return n=e.sent(),r=o.featureCollection,a=r.showLegend,t=r.layers.map(function(e){var r=new n;return r.read(e,c),null!=a&&r.read({showLegend:a},c),r}),i.layers.addMany(t),[2]}})})}(r,a,t.context)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[4,i.loadStyleRenderer(r,t.context)];case 3:return e.sent(),[2,r]}})})}function v(r,n){return u(this,void 0,void 0,function(){return L(this,function(e){switch(e.label){case 0:return[4,function(l,y){return u(this,void 0,void 0,function(){var r,n,a,t,i,o,c,u;return L(this,function(e){switch(e.label){case 0:return r=y.context,n=function(e){var r;switch(e.origin){case"web-scene":switch(e.layerContainerType){case"basemap":r=b;break;case"ground":r=T;break;default:r=g}break;default:switch(e.layerContainerType){case"basemap":r=w;break;default:r=A}}return r}(r),!(a=l.layerType||l.type)&&y&&y.defaultLayerType&&(a=y.defaultLayerType),t=n[a],i=t?s.layerLookupMap[t]:s.layerLookupMap.UnknownLayer,M(l)?l.itemId?[4,(o=new p({id:l.itemId,portal:r&&r.portal})).load()]:[3,3]:[3,4];case 1:return e.sent(),[4,h.selectLayerClassPath(o)];case 2:c=e.sent(),u=c.className||"UnknownLayer",i=s.layerLookupMap[u],e.label=3;case 3:return[3,5];case 4:"ArcGISFeatureLayer"===a&&(d.isMapNotesLayer(l)?i=s.layerLookupMap.MapNotesLayer:S(l)&&(i=s.layerLookupMap.GroupLayer)),e.label=5;case 5:return l.wmtsInfo&&(i=s.layerLookupMap.WMTSLayer),[2,i()]}})})}(r,n)];case 1:return[2,a(e.sent(),r,n)]}})})}function S(e){if("ArcGISFeatureLayer"!==e.layerType||M(e))return!1;var r=e.featureCollection;return!!(r&&r.layers&&1<r.layers.length)}function M(e){return"Feature Collection"===e.type}function I(t,i,o){return u(this,void 0,void 0,function(){var r,n,a;return L(this,function(e){switch(e.label){case 0:return r=new c,n=l(r,Array.isArray(i.layers)?i.layers:[],o),[4,t];case 1:return a=e.sent(),[4,n];case 2:return e.sent(),"group"===a.type?(a.layers.addMany(r),[2,a]):[2,void 0]}})})}function l(y,s,p){return u(this,void 0,void 0,function(){var r,n,a,t,i,o,c,u,l;return L(this,function(e){switch(e.label){case 0:if(!s)return[2];for(r=[],n=0,a=s;n<a.length;n++)t=a[n],i=v(t,p),"GroupLayer"===t.layerType?r.push(I(i,t,p)):r.push(i);return[4,f.eachAlways(r)];case 1:for(o=e.sent(),c=0,u=o;c<u.length;c++)l=u[c],m&&l.error?console.error(l.error.toString?l.error.toString():l.error):!l.value||p.filter&&!p.filter(l.value)||y.add(l.value);return[2]}})})}Object.defineProperty(r,"__esModule",{value:!0});var m=n("dojo-debug-messages"),g={ArcGISFeatureLayer:"FeatureLayer",ArcGISImageServiceLayer:"ImageryLayer",ArcGISMapServiceLayer:"MapImageLayer",PointCloudLayer:"PointCloudLayer",ArcGISSceneServiceLayer:"SceneLayer",IntegratedMeshLayer:"IntegratedMeshLayer",BuildingSceneLayer:"BuildingSceneLayer",ArcGISTiledElevationServiceLayer:"ElevationLayer",ArcGISTiledImageServiceLayer:"TileLayer",ArcGISTiledMapServiceLayer:"TileLayer",GroupLayer:"GroupLayer",WebTiledLayer:"WebTileLayer",CSV:"CSVLayer",VectorTileLayer:"VectorTileLayer",WMS:"WMSLayer",DefaultTileLayer:"TileLayer",KML:"KMLLayer",RasterDataLayer:"UnsupportedLayer"},T={ArcGISTiledElevationServiceLayer:"ElevationLayer",DefaultTileLayer:"ElevationLayer"},b={ArcGISTiledMapServiceLayer:"TileLayer",ArcGISTiledImageServiceLayer:"TileLayer",OpenStreetMap:"OpenStreetMapLayer",WebTiledLayer:"WebTileLayer",VectorTileLayer:"VectorTileLayer",ArcGISImageServiceLayer:"UnsupportedLayer",WMS:"UnsupportedLayer",ArcGISMapServiceLayer:"UnsupportedLayer",DefaultTileLayer:"TileLayer"},A={ArcGISFeatureLayer:"FeatureLayer",ArcGISImageServiceLayer:"ImageryLayer",ArcGISImageServiceVectorLayer:"UnsupportedLayer",ArcGISMapServiceLayer:"MapImageLayer",ArcGISStreamLayer:"StreamLayer",ArcGISTiledImageServiceLayer:"TileLayer",ArcGISTiledMapServiceLayer:"TileLayer",VectorTileLayer:"VectorTileLayer",WebTiledLayer:"WebTileLayer",CSV:"CSVLayer",GeoRSS:"GeoRSSLayer",KML:"KMLLayer",WFS:"UnsupportedLayer",WMS:"WMSLayer",BingMapsAerial:"BingMapsLayer",BingMapsRoad:"BingMapsLayer",BingMapsHybrid:"BingMapsLayer",DefaultTileLayer:"TileLayer"},w={ArcGISImageServiceLayer:"ImageryLayer",ArcGISImageServiceVectorLayer:"UnsupportedLayer",ArcGISMapServiceLayer:"MapImageLayer",ArcGISTiledImageServiceLayer:"TileLayer",ArcGISTiledMapServiceLayer:"TileLayer",OpenStreetMap:"OpenStreetMapLayer",VectorTileLayer:"VectorTileLayer",WebTiledLayer:"WebTileLayer",BingMapsAerial:"BingMapsLayer",BingMapsRoad:"BingMapsLayer",BingMapsHybrid:"BingMapsLayer",WMS:"WMSLayer",DefaultTileLayer:"TileLayer"};r.createLayer=v,r.populateOperationalLayers=function(r,n,a){return u(this,void 0,void 0,function(){return L(this,function(e){return[2,l(r,n,a)]})})}}.apply(null,a))||(e.exports=t)}}]);