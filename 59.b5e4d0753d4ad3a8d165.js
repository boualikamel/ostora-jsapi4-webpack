(function(){(this||window).webpackJsonp.registerAbsMids({"esri/views/2d/layers/features/Pipeline":1602,"esri/core/libs/quickselect/quickselect":1665,"esri/core/libs/rbush/rbush":1683,"esri/views/2d/layers/features/support/Tile":1715,"esri/views/2d/layers/features/support/TileStore":1799,"esri/views/2d/layers/features/controllers":2432,"esri/views/2d/layers/features/processors":2433})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{1602:function(t,e,i){var n,r;n=[i.dj.c(t.i),e,i(1),i(0),i(10),i(9),i(5),i(13),i(6),i(14),i(3),i(4),i(2),i(92),i(538),i(2432),i(2433),i(1799),i(495)],void 0===(r=function(t,e,i,n,l,h,r,o,s,a,u,c,d,f,p,m,v,g,x){Object.defineProperty(e,"__esModule",{value:!0});var y=u.getLogger("esri.views.2d.layers.features.Pipeline"),b=new Set;e.getInstances=function(){return b};var _,w=(_=d.declared(o),i(M,_),M.prototype.initialize=function(){var e=this;this.watch("updating",function(t){e.remoteClient.invoke("setUpdating",t)}),a("esri-performance-tests")&&!a("esri-workers")&&b.add(this)},M.prototype.destroy=function(){a("esri-performance-tests")&&!a("esri-workers")&&b.delete(this),this.controller&&this.controller.destroy(),this.processor&&this.processor.destroy()},Object.defineProperty(M.prototype,"updating",{get:function(){var t=this.controller,e=this.processor;return!t||!e||t.updating||e.updating||!1},enumerable:!0,configurable:!0}),M.prototype.startup=function(t){var i=t.service,n=t.config,r=t.tileInfo,o=t.options;return l(this,void 0,void 0,function(){var e;return h(this,function(t){return this.service=i,this.tileStore||(e=new x(f.fromJSON(r)),this.tileStore=new g.default(e)),[2,this._configure(n,o)]})})},M.prototype.update=function(t){var e=t.config,i=t.options;return l(this,void 0,void 0,function(){return h(this,function(t){switch(t.label){case 0:return this.processor&&this.controller?i.layerFilterChanged||i.invalidateFeatureData||i.invalidateMesh?[4,this.controller.update(e,i.layerFilterChanged)]:[3,2]:(y.error(new s("mapview-pipeline","Tried to update an unconfigured pipeline.")),[2]);case 1:t.sent(),t.label=2;case 2:return i.invalidateMesh?[4,this.processor.update(e)]:[3,4];case 3:t.sent(),this.controller.invalidate(),t.label=4;case 4:return[4,this.remoteClient.invoke("setUpdating",this.updating)];case 5:return t.sent(),[2]}})})},M.prototype.setViewState=function(t){var e=p.fromJSON(t);this._set("viewState",e),this.tileStore&&this.tileStore.setViewState(e),this.controller&&this.controller.setViewState(e)},M.prototype._configure=function(e,i){return l(this,void 0,void 0,function(){return h(this,function(t){switch(t.label){case 0:return[4,c.all([this._handleControllerConfig(e),this._handleProcessorConfig(e)])];case 1:return t.sent(),this.controller.processor=this.processor,this.viewState&&this.controller.setViewState(this.viewState),[4,this.update({config:e,options:i})];case 2:return t.sent(),[2]}})})},M.prototype._handleControllerConfig=function(i){return l(this,void 0,void 0,function(){var e;return h(this,function(t){switch(t.label){case 0:return[4,this._createController(this.service,i)];case 1:return[4,(e=t.sent()).startup()];case 2:return t.sent(),[2,e]}})})},M.prototype._handleProcessorConfig=function(e){return l(this,void 0,void 0,function(){return h(this,function(t){return[2,this._createProcessor(this.service,e)]})})},M.prototype._createController=function(s,a){return l(this,void 0,void 0,function(){var e,i,n,r,o;return h(this,function(t){switch(t.label){case 0:return this.controller?[2,this.controller]:[4,m.loadControllerModule(s.type)];case 1:return e=t.sent().default,n=(i=this).tileStore,r=i.remoteClient,o=new e({service:s,config:a,tileStore:n,remoteClient:r}),[2,this.controller=o]}})})},M.prototype._createProcessor=function(s,a){return l(this,void 0,void 0,function(){var e,i,n,r,o;return h(this,function(t){switch(t.label){case 0:return[4,v.loadProcessorModule(a.renderer.type)];case 1:return e=t.sent().default,n=(i=this).remoteClient,r=i.tileStore,o=new e({service:s,config:a,tileStore:r,remoteClient:n}),this.processor&&this.processor.destroy(),[2,this.processor=o]}})})},n([d.property()],M.prototype,"controller",void 0),n([d.property()],M.prototype,"processor",void 0),n([d.property({dependsOn:["controller.updating","processor.updating"]})],M.prototype,"updating",null),n([d.property()],M.prototype,"viewState",void 0),n([d.subclass("esri.views.2d.layers.features.Pipeline")],M));function M(){var t=null!==_&&_.apply(this,arguments)||this;return t.controller=null,t.processor=null,t.remoteClient=null,t.tileStore=null,t.service=null,t.viewState=null,t}e.default=w}.apply(null,n))||(t.exports=r)},1665:function(t,e,i){var n;void 0===(n=function(){"use strict";function p(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function o(t,e){return t<e?-1:e<t?1:0}return function(t,e,i,n,r){!function t(e,i,n,r,o){for(;n<r;){if(600<r-n){var s=r-n+1,a=i-n+1,l=Math.log(s),h=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*h*(s-h)/s)*(a-s/2<0?-1:1);t(e,i,Math.max(n,Math.floor(i-a*h/s+u)),Math.min(r,Math.floor(i+(s-a)*h/s+u)),o)}var c=e[i],d=n,f=r;for(p(e,n,i),0<o(e[r],c)&&p(e,n,r);d<f;){for(p(e,d,f),d++,f--;o(e[d],c)<0;)d++;for(;0<o(e[f],c);)f--}0===o(e[n],c)?p(e,n,f):p(e,++f,r),f<=i&&(n=f+1),i<=f&&(r=f-1)}}(t,e,i||0,n||t.length-1,r||o)}}.apply(null,[]))||(t.exports=n)},1683:function(t,e,i){var n,r;n=[i(1665)],void 0===(r=function(a){"use strict";function i(t,e){if(!(this instanceof i))return new i(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&("function"==typeof e?this.toBBox=e:this._initFormat(e)),this.clear()}function u(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function f(t,e){g(t,0,t.children.length,e,t)}function g(t,e,i,n,r){(r=r||m(null)).minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,s=e;s<i;s++)o=t.children[s],c(r,t.leaf?n(o):o);return r}function c(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function o(t,e){return t.minX-e.minX}function s(t,e){return t.minY-e.minY}function x(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function d(t){return t.maxX-t.minX+(t.maxY-t.minY)}function p(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function h(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function m(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(t,e,i,n,r){for(var o,s=[e,i];s.length;)(i=s.pop())-(e=s.pop())<=n||(o=e+Math.ceil((i-e)/n/2)*n,a(t,o,e,i,r),s.push(e,o,o,i))}return i.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],n=this.toBBox;if(!h(t,e))return i;for(var r,o,s,a,l=[];e;){for(r=0,o=e.children.length;r<o;r++)s=e.children[r],h(t,a=e.leaf?n(s):s)&&(e.leaf?i.push(s):p(t,a)?this._all(s,i):l.push(s));e=l.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!h(t,e))return!1;for(var n,r,o,s,a=[];e;){for(n=0,r=e.children.length;n<r;n++)if(o=e.children[n],h(t,s=e.leaf?i(o):o)){if(e.leaf||p(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=m([]),this},remove:function(t,e){if(!t)return this;for(var i,n,r,o,s=this.data,a=this.toBBox(t),l=[],h=[];s||l.length;){if(s||(s=l.pop(),n=l[l.length-1],i=h.pop(),o=!0),s.leaf&&-1!==(r=u(t,s.children,e)))return s.children.splice(r,1),l.push(s),this._condense(l),this;o||s.leaf||!p(s,a)?n?(i++,s=n.children[i],o=!1):s=null:(l.push(s),h.push(i),i=0,s=(n=s).children[0])}return this},toBBox:function(t){return t},compareMinX:o,compareMinY:s,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,n){var r,o=i-e+1,s=this._maxEntries;if(o<=s)return f(r=m(t.slice(e,i+1)),this.toBBox),r;n||(n=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,n-1))),(r=m([])).leaf=!1,r.height=n;var a,l,h,u,c=Math.ceil(o/s),d=c*Math.ceil(Math.sqrt(s));for(v(t,e,i,d,this.compareMinX),a=e;a<=i;a+=d)for(v(t,a,h=Math.min(a+d-1,i),c,this.compareMinY),l=a;l<=h;l+=c)u=Math.min(l+c-1,h),r.children.push(this._build(t,l,u,n-1));return f(r,this.toBBox),r},_chooseSubtree:function(t,e,i,n){for(var r,o,s,a,l,h,u,c;n.push(e),!e.leaf&&n.length-1!==i;){for(u=c=1/0,r=0,o=e.children.length;r<o;r++)l=x(s=e.children[r]),d=t,f=s,(h=(Math.max(f.maxX,d.maxX)-Math.min(f.minX,d.minX))*(Math.max(f.maxY,d.maxY)-Math.min(f.minY,d.minY))-l)<c?(c=h,u=l<u?l:u,a=s):h===c&&l<u&&(u=l,a=s);e=a||e.children[0]}var d,f;return e},_insert:function(t,e,i){var n=this.toBBox,r=i?t:n(t),o=[],s=this._chooseSubtree(r,this.data,e,o);for(s.children.push(t),c(s,r);0<=e&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var i=t[e],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);var o=this._chooseSplitIndex(i,r,n),s=m(i.children.splice(o,i.children.length-o));s.height=i.height,s.leaf=i.leaf,f(i,this.toBBox),f(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(i,s)},_splitRoot:function(t,e){this.data=m([t,e]),this.data.height=t.height+1,this.data.leaf=!1,f(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var n,r,o,s,a,l,h,u,c,d,f,p,m,v;for(l=h=1/0,n=e;n<=i-e;n++)r=g(t,0,n,this.toBBox),o=g(t,n,i,this.toBBox),c=r,d=o,void 0,f=Math.max(c.minX,d.minX),p=Math.max(c.minY,d.minY),m=Math.min(c.maxX,d.maxX),v=Math.min(c.maxY,d.maxY),s=Math.max(0,m-f)*Math.max(0,v-p),a=x(r)+x(o),s<l?(l=s,u=n,h=a<h?a:h):s===l&&a<h&&(h=a,u=n);return u},_chooseSplitAxis:function(t,e,i){var n=t.leaf?this.compareMinX:o,r=t.leaf?this.compareMinY:s;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,r)&&t.children.sort(n)},_allDistMargin:function(t,e,i,n){t.children.sort(n);var r,o,s=this.toBBox,a=g(t,0,e,s),l=g(t,i-e,i,s),h=d(a)+d(l);for(r=e;r<i-e;r++)o=t.children[r],c(a,t.leaf?s(o):o),h+=d(a);for(r=i-e-1;e<=r;r--)o=t.children[r],c(l,t.leaf?s(o):o),h+=d(l);return h},_adjustParentBBoxes:function(t,e,i){for(var n=i;0<=n;n--)c(e[n],t)},_condense:function(t){for(var e,i=t.length-1;0<=i;i--)0===t[i].children.length?0<i?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():f(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}},i}.apply(null,n))||(t.exports=r)},1715:function(t,e,i){var n,r;n=[i.dj.c(t.i),e,i(161),i(37),i(80),i(513),i(102)],void 0===(r=function(t,e,n,i,r,o,s){function a(t,e){var i=t.bounds,n=e.bounds;return t.key.id!==e.key.id&&t.key.world===e.key.world&&i[0]<=n[0]&&i[1]<=n[1]&&i[2]>=n[2]&&i[3]>=n[3]}Object.defineProperty(e,"__esModule",{value:!0}),e.isParentOf=a,e.isChildOf=function(t,e){return a(e,t)};var l=(Object.defineProperty(h.prototype,"id",{get:function(){return this.key.id},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"extent",{get:function(){return i.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"transform",{get:function(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}},enumerable:!0,configurable:!0}),h.prototype.clone=function(){return new h(this.tileInfoView,this.id)},h.prototype.createChildTiles=function(){for(var t=this.key.getChildKeys(),e=n.acquire(),i=0;i<t.length;i++)e[i]=new h(this.tileInfoView,t[i]);return e},h.prototype.getQuantizationParameters=function(){return o.default.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})},h);function h(t,e){this.bounds=r.create(),this.key=new s(0,0,0,0),this.objectIds=new Set,this.key.set(e);var i=t.getLODInfoAt(this.key);this.tileInfoView=t,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=i.resolution,this.scale=i.scale,this.level=i.level,this.needsClear=!0}e.Tile=l,e.default=l}.apply(null,n))||(t.exports=r)},1799:function(t,e,i){var n,r;n=[i.dj.c(t.i),e,i(11),i(0),i(54),i(14),i(1683),i(1715),i(322),i(102)],void 0===(r=function(t,e,i,n,r,o,s,m,v,a){Object.defineProperty(e,"__esModule",{value:!0});var l,g={added:[],removed:[]},x=new Set,y=new a(0,0,0,0),h=(i(u,l=r),u.prototype.destroy=function(){this._tiles.clear()},u.prototype.has=function(t){return this._tiles.has(t)},u.prototype.get=function(t){return this._tiles.get(t)},u.prototype.findByKey=function(t){return this._tiles.get(t.id)},u.prototype.intersections=function(t,e){var i="string"==typeof t?this.get(t):t;if(!i)return[];for(var n=e*i.resolution,r=i.bounds[0]-n,o=i.bounds[1]-n,s=i.bounds[2]+n,a=i.bounds[3]+n,l=[],h=0,u=this._index.search({minX:r,minY:o,maxX:s,maxY:a});h<u.length;h++){var c=u[h],d=c.bounds.slice();d[0]=Math.max(d[0],r),d[1]=Math.max(d[1],o),d[2]=Math.min(d[2],s),d[3]=Math.min(d[3],a),0<d[2]-d[0]&&0<d[3]-d[1]&&l.push({bounds:d,tile:c})}return l},u.prototype.boundsIntersections=function(t){return this._index.search({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]})},u.prototype.setViewState=function(t){var e=this.tileScheme.getTileCoverage(t,0);if(e){var i=e.spans,n=e.lodInfo,r=n.level;if(0<i.length)for(var o=0,s=i;o<s.length;o++)for(var a=s[o],l=a.row,h=a.colFrom,u=a.colTo,c=h;c<=u;c++){var d=y.set(r,l,n.normalizeCol(c),n.getWorldForColumn(c)).id;if(x.add(d),!this.has(d)){var f=new m.default(this.tileScheme,d);this._tiles.set(d,f),this._index.insert(f),this.tiles.push(f),g.added.push(f)}}for(var p=this.tiles.length-1;0<=p;p--)f=this.tiles[p],x.has(f.id)||(this._tiles.delete(f.id),this.tiles.splice(p,1),this._index.remove(f),g.removed.push(f));(g.added.length||g.removed.length)&&this.emit("update",g),v.pool.release(e),x.clear(),g.added.length=0,g.removed.length=0}},u);function u(t){var e=l.call(this)||this;return e._tiles=new Map,e._index=s(9,o("csp-restrictions")?function(t){return{minX:t.bounds[0],minY:t.bounds[1],maxX:t.bounds[2],maxY:t.bounds[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),e.tiles=[],e.tileScheme=t,e}e.default=h}.apply(null,n))||(t.exports=r)},2432:function(t,e,a){var i,n;i=[a.dj.c(t.i),e,a(5),a(9),a(10),a(6),a(4)],void 0===(n=function(t,e,i,n,r,o,s){Object.defineProperty(e,"__esModule",{value:!0}),e.loadControllerModule=function(t){switch(t){case"on-demand":return s.create(function(e){return Promise.all([a.e(0),a.e(1),a.e(4),a.e(17),a.e(65)]).then(function(){var t=[a(2768)];e.apply(null,t)}.bind(this)).catch(a.oe)});case"stream":return s.create(function(e){return Promise.all([a.e(0),a.e(1),a.e(4),a.e(17),a.e(68)]).then(function(){var t=[a(2777)];e.apply(null,t)}.bind(this)).catch(a.oe)});default:return s.reject(new o("mapview-controller:bad-type","Unable to create controller for unknown type: "+t))}}}.apply(null,i))||(t.exports=n)},2433:function(t,e,r){var i,n;i=[r.dj.c(t.i),e,r(5),r(4)],void 0===(n=function(t,e,i,n){Object.defineProperty(e,"__esModule",{value:!0}),e.loadProcessorModule=function(t){return"heatmap"===t?n.create(function(e){return r.e(77).then(function(){var t=[r(2782)];e.apply(null,t)}.bind(this)).catch(r.oe)}):n.create(function(e){return r.e(70).then(function(){var t=[r(2783)];e.apply(null,t)}.bind(this)).catch(r.oe)})}}.apply(null,i))||(t.exports=n)}}]);