(function(){(this||window).webpackJsonp.registerAbsMids({"esri/tasks/ClosestFacilityTask":1592,"esri/tasks/support/GPMessage":1672,"esri/core/queryUtils":1709,"esri/tasks/mixins/NAServiceDescription":1710,"esri/tasks/support/NAMessage":1711,"esri/tasks/support/DirectionsFeatureSet":1790,"esri/tasks/support/ClosestFacilitySolveResult":2176})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{1592:function(e,r,t){var s,i;s=[t.dj.c(e.i),r,t(5),t(1),t(0),t(29),t(4),t(1709),t(2),t(485),t(303),t(1710),t(2176)],void 0===(i=function(e,r,l,t,s,p,c,i,o,d,n,a,f){var u,y=i.createQueryParamsHelper({accumulateAttributes:{name:"accumulateAttributeNames"},attributeParameterValues:!0,directionsTimeAttribute:{name:"directionsTimeAttributeName"},impedanceAttribute:{name:"impedanceAttributeName"},facilities:!0,incidents:!0,outSpatialReference:{name:"outSR",getter:function(e){return e.outSpatialReference.wkid}},pointBarriers:{name:"barriers"},polylineBarriers:!0,polygonBarriers:!0,restrictionAttributes:{name:"restrictionAttributeNames"},returnPointBarriers:{name:"returnBarriers"},returnRoutes:{name:"returnCFRoutes"},travelMode:!0});return u=o.declared(a.NAServiceDescriptionMixin(n)),t(v,u),v.prototype.solve=function(s,i){var o=this,n=[],e=[],a={},u={};return s.incidents&&s.incidents.features&&this._collectGeometries(s.incidents.features,e,"incidents.features",a),s.facilities&&s.facilities.features&&this._collectGeometries(s.facilities.features,e,"facilities.features",a),s.pointBarriers&&s.pointBarriers.features&&this._collectGeometries(s.pointBarriers.features,e,"pointBarriers.features",a),s.polylineBarriers&&s.polylineBarriers.features&&this._collectGeometries(s.polylineBarriers.features,e,"polylineBarriers.features",a),s.polygonBarriers&&s.polygonBarriers.features&&this._collectGeometries(s.polygonBarriers.features,e,"polygonBarriers.features",a),d.normalizeCentralMeridian(e).then(function(e){for(var r in a){var t=a[r];n.push(r),u[r]=e.slice(t[0],t[1])}return o._isInputGeometryZAware(u,n)?o.getServiceDescription():c.resolve({dontCheck:!0})}).then(function(e){for(var r in("dontCheck"in e?e.dontCheck:e.hasZ)||o._dropZValuesOffInputGeometry(u,n),u)!function(t){u[t].forEach(function(e,r){s.get(t)[r].geometry=e})}(r);var t={query:l({},o.parsedUrl.query,{f:"json"},y.toQueryParams(s))};return(o.requestOptions||i)&&(t=l({},o.requestOptions,i,t)),p(o.parsedUrl.path+"/solveClosestFacility",t)}).then(function(e){return f.fromJSON(e.data)})},v.prototype._collectGeometries=function(e,r,t,s){s[t]=[r.length,r.length+e.length],e.forEach(function(e){r.push(e.geometry)})},s([o.property()],v.prototype,"url",void 0),s([o.subclass("esri.tasks.ClosestFacilityTask")],v);function v(e){var r=u.call(this,e)||this;return r.url=null,r}}.apply(null,s))||(e.exports=i)},1672:function(e,r,t){var s,i;s=[t.dj.c(e.i),r,t(1),t(0),t(17),t(7),t(2)],void 0===(i=function(e,r,t,s,i,o,n){var a,u=new i.default({esriJobMessageTypeInformative:"informative",esriJobMessageTypeProcessDefinition:"process-definition",esriJobMessageTypeProcessStart:"process-start",esriJobMessageTypeProcessStop:"process-stop",esriJobMessageTypeWarning:"warning",esriJobMessageTypeError:"error",esriJobMessageTypeEmpty:"empty",esriJobMessageTypeAbort:"abort"});return a=n.declared(o.JSONSupport),t(l,a),s([n.property({type:String,json:{write:!0}})],l.prototype,"description",void 0),s([n.property({type:String,json:{read:u.read,write:u.write}})],l.prototype,"type",void 0),s([n.subclass("esri.tasks.support.GPMessage")],l);function l(e){var r=a.call(this,e)||this;return r.description=null,r.type=null,r}}.apply(null,s))||(e.exports=i)},1709:function(e,r,t){var s,i;s=[t.dj.c(e.i),r],void 0===(i=function(e,r){Object.defineProperty(r,"__esModule",{value:!0});var t=(s.prototype.toQueryParams=function(e){var i=this;if(!e)return null;var o=e.toJSON(),n={};return Object.keys(o).forEach(function(e){var r=i._options[e];if(r){var t="boolean"!=typeof r&&r.name?r.name:e,s="boolean"!=typeof r&&r.getter?r.getter(o):o[e];null!=s&&(n[t]=function(e){if(!Array.isArray(e))return 0;var r=e[0];return"number"==typeof r||"string"==typeof r}(s)?s.join(","):"object"==typeof s?JSON.stringify(s):s)}else n[e]=o[e]},this),n},s);function s(e){void 0===e&&(e={}),this._options=e}r.createQueryParamsHelper=function(e){return new t(e)}}.apply(null,s))||(e.exports=i)},1710:function(e,r,t){var s,i;s=[t.dj.c(e.i),r,t(0),t(1),t(9),t(10),t(29),t(6),t(12),t(60),t(22),t(2),t(303)],void 0===(i=function(e,r,s,i,g,a,T,u,l,b,M,o,t){Object.defineProperty(r,"__esModule",{value:!0}),r.NAServiceDescriptionMixin=function(e){return t=o.declared(e),i(r,t),r.prototype.getServiceDescription=function(){return a(this,void 0,void 0,function(){return g(this,function(e){return this._serviceDescriptionPromise||(this._serviceDescriptionPromise=this._fetchServiceDescription()),[2,this._serviceDescriptionPromise]})})},r.prototype._fetchServiceDescription=function(){return a(this,void 0,void 0,function(){var r,t,s,i,o,n;return g(this,function(e){switch(e.label){case 0:if(!this.url||!this.parsedUrl)throw new u("network-service:missing-url","Url to Network service is missing");return r=this.url,[4,T(r,{query:{f:"json"}})];case 1:for((t=e.sent().data).supportedTravelModes||(t.supportedTravelModes=[]),s=0;s<t.supportedTravelModes.length;s++)t.supportedTravelModes[s].id||(t.supportedTravelModes[s].id=t.supportedTravelModes[s].itemId);return[4,(10.4<=t.currentVersion?function(o){return a(this,void 0,void 0,function(){var r,t,s,i;return g(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,T(o+("/"===o[o.length-1]?"":"/")+"retrieveTravelModes",{query:{f:"json"}})];case 1:return r=e.sent().data,t=r.supportedTravelModes,s=r.defaultTravelMode,[2,{supportedTravelModes:t,defaultTravelMode:s}];case 2:throw i=e.sent(),new u("network-service:retrieveTravelModes","Could not get to the NAServer's retrieveTravelModes.",{error:i});case 3:return[2]}})})}:function(h){return a(this,void 0,void 0,function(){var r,t,s,i,o,n,a,u,l,p,c,d,f,y,v,m;return g(this,function(e){switch(e.label){case 0:return[4,T(h.substring(0,h.indexOf("/rest/")+6)+"info",{query:{f:"json"}})];case 1:return(r=e.sent().data)&&r.owningSystemUrl?(h=r.owningSystemUrl,[4,T(h+("/"===h[h.length-1]?"":"/")+"sharing/rest/portals/self",{query:{f:"json"}})]):[2,{supportedTravelModes:[],defaultTravelMode:null}];case 2:return t=e.sent().data,(s=b.getDeepValue("helperServices.routingUtilities.url",t))?(i=M.urlToObject(h),o=/\/solveClosestFacility$/.test(i.path)?"Route":/\/solveClosestFacility$/.test(i.path)?"ClosestFacility":"ServiceAreas",[4,T(s+("/"===s[s.length-1]?"":"/")+"GetTravelModes/execute",{query:{f:"json",serviceName:o}})]):[2,{supportedTravelModes:[],defaultTravelMode:null}];case 3:if(n=e.sent(),a=[],u=null,n&&n.data&&n.data.results&&n.data.results.length)for(l=n.data.results,p=0,c=l;p<c.length;p++)if("supportedTravelModes"===(d=c[p]).paramName){if(d.value&&d.value.features)for(f=0,y=d.value.features;f<y.length;f++)(v=y[f].attributes)&&(m=JSON.parse(v.TravelMode),a.push(m))}else"defaultTravelMode"===d.paramName&&(u=d.value);return[2,{supportedTravelModes:a,defaultTravelMode:u}]}})})})(r)];case 2:return i=e.sent(),o=i.defaultTravelMode,n=i.supportedTravelModes,t.defaultTravelMode=o,t.supportedTravelModes=n,[2,t]}})})},r.prototype._isInputGeometryZAware=function(e,r){for(var t=0;t<r.length;t++){var s=e[r[t]];if(s&&s.length)for(var i=0,o=s;i<o.length;i++){var n=o[i];if(l.isSome(n)&&n.hasZ)return!0}}return!1},r.prototype._dropZValuesOffInputGeometry=function(e,r){for(var t=0;t<r.length;t++){var s=e[r[t]];if(s&&s.length)for(var i=0,o=s;i<o.length;i++)o[i].z=void 0}console.log("The remote Network Analysis service is powered by a network dataset which is not Z-aware.\nZ-coordinates of the input geometry are ignored.")},s([o.subclass("esri.tasks.mixins.NAServiceDescription")],r);function r(){return null!==t&&t.apply(this,arguments)||this}var t};var n,p=(n=o.declared(r.NAServiceDescriptionMixin(t)),i(c,n),s([o.subclass("esri.tasks.mixins.NAServiceDescription")],c));function c(){return null!==n&&n.apply(this,arguments)||this}r.NAServiceDescription=p}.apply(null,s))||(e.exports=i)},1711:function(e,r,t){var s,i;s=[t.dj.c(e.i),r,t(1),t(0),t(17),t(2),t(1672)],void 0===(i=function(e,r,t,s,i,o,n){var a,u=new i.default({0:"informative",1:"process-definition",2:"process-start",3:"process-stop",50:"warning",100:"error",101:"empty",200:"abort"});return a=o.declared(n),t(l,a),s([o.property({type:String,json:{read:u.read,write:u.write}})],l.prototype,"type",void 0),s([o.subclass("esri.tasks.support.NAMessage")],l);function l(e){var r=a.call(this,e)||this;return r.type=null,r}}.apply(null,s))||(e.exports=i)},1790:function(e,r,t){var s,i;s=[t(37),t(43),t(153),t(31),t(207),t(89)],void 0===(i=function(e,i,o,t,r,n){return r.createSubclass({declaredClass:"esri.tasks.support.DirectionsFeatureSet",properties:{geometryType:"polyline",extent:{type:e,json:{read:{source:"summary.envelope"}}},features:{value:null,json:{read:function(e,r){(e||[]).forEach(function(e){this._decompressFeatureGeometry(e,r.summary.envelope.spatialReference)},this);var s=t.fromJSON(r.spatialReference);return e.map(function(t){var e=n.fromJSON(t),r=t.geometry&&t.geometry.spatialReference;return e.geometry&&!r&&(e.geometry.spatialReference=s),e.strings=t.strings,e.events=(t.events||[]).map(function(e){var r=new n({geometry:new i({x:e.point.x,y:e.point.y,z:e.point.z,hasZ:void 0!==e.point.z,spatialReference:t.geometry&&t.geometry.spatialReference}),attributes:{ETA:e.ETA,arriveTimeUTC:e.arriveTimeUTC}});return r.strings=e.strings,r}),e})}}},mergedGeometry:{value:null,readOnly:!0,dependsOn:["features","extent.spatialReference"],get:function(){if(!this.features)return null;var e=this.features.map(function(e){return e.geometry}),r=this.get("extent.spatialReference");return this._mergePolylinesToSinglePath(e,r)}},routeId:null,routeName:null,strings:{value:null,readOnly:!0,dependsOn:["features"],get:function(){return this.features.map(function(e){return e.strings})}},totalDriveTime:{value:null,json:{read:{source:"summary.totalDriveTime"}}},totalLength:{value:null,json:{read:{source:"summary.totalLength"}}},totalTime:{value:null,json:{read:{source:"summary.totalTime"}}}},_decompressFeatureGeometry:function(e,r){e.geometry=this._decompressGeometry(e.compressedGeometry,r)},_decompressGeometry:function(e,r){var t,s,i,o,n,a,u,l,p=0,c=0,d=0,f=0,y=[],v=0,m=0,h=0;if(n=(n=e.match(/((\+|\-)[^\+\-\|]+|\|)/g))||[],0===parseInt(n[v],32)){v=2;var g=parseInt(n[v],32);v++,a=parseInt(n[v],32),v++,1&g&&(m=n.indexOf("|")+1,u=parseInt(n[m],32),m++),2&g&&(h=n.indexOf("|",m)+1,l=parseInt(n[h],32),h++)}else a=parseInt(n[v],32),v++;for(;v<n.length&&"|"!==n[v];){t=parseInt(n[v],32)+p,v++,p=t,s=parseInt(n[v],32)+c,v++;var T=[t/a,(c=s)/a];m&&(o=parseInt(n[m],32)+d,m++,d=o,T.push(o/u)),h&&(i=parseInt(n[h],32)+f,h++,f=i,T.push(i/l)),y.push(T)}return{paths:[y],hasZ:0<m,hasM:0<h,spatialReference:r}},_mergePolylinesToSinglePath:function(e,r){var t=[];(e||[]).forEach(function(e){e.paths.forEach(function(e){t=t.concat(e)})});var s=[],i=[0,0];return t.forEach(function(e){e[0]===i[0]&&e[1]===i[1]||(s.push(e),i=e)}),new o({paths:[s]},r)}})}.apply(null,s))||(e.exports=i)},2176:function(e,r,t){var s,i;s=[t.dj.c(e.i),r,t(1),t(0),t(28),t(89),t(7),t(12),t(2),t(520),t(31),t(1790),t(207),t(1711)],void 0===(i=function(e,r,t,s,i,o,n,a,u,l,p,c,d,f){function y(e){return d.fromJSON(e).features.map(function(e){return e.geometry})}return m=u.declared(n.JSONSupport),t(v,m),v.prototype.readFacilities=function(e){return y(e)},v.prototype.readIncidents=function(e){return y(e)},v.prototype.readPointBarriers=function(e,r){return y(r.barriers)},v.prototype.readPolylineBarriers=function(e){return y(e)},v.prototype.readPolygonBarriers=function(e){return y(e)},v.prototype.readRoutes=function(e){return(s=e).features.map(function(e){var r=p.fromJSON(s.spatialReference),t=o.fromJSON(e);return a.isSome(t.geometry)&&(t.geometry.spatialReference=r),t});var s},s([u.property({type:c})],v.prototype,"directions",void 0),s([u.property({type:[i.Point]})],v.prototype,"facilities",void 0),s([l.reader("facilities")],v.prototype,"readFacilities",null),s([u.property({type:[i.Point]})],v.prototype,"incidents",void 0),s([l.reader("incidents")],v.prototype,"readIncidents",null),s([u.property({type:[f]})],v.prototype,"messages",void 0),s([u.property({type:[i.Point]})],v.prototype,"pointBarriers",void 0),s([l.reader("pointBarriers",["barriers"])],v.prototype,"readPointBarriers",null),s([u.property({type:[i.Polyline]})],v.prototype,"polylineBarriers",void 0),s([l.reader("polylineBarriers")],v.prototype,"readPolylineBarriers",null),s([u.property({type:[i.Polygon]})],v.prototype,"polygonBarriers",void 0),s([l.reader("polygonBarriers")],v.prototype,"readPolygonBarriers",null),s([u.property({type:[o]})],v.prototype,"routes",void 0),s([l.reader("routes")],v.prototype,"readRoutes",null),s([u.subclass("esri.tasks.support.ClosestFacilitySolveResult")],v);function v(e){var r=m.call(this,e)||this;return r.directions=null,r.facilities=null,r.incidents=null,r.messages=null,r.pointBarriers=null,r.polylineBarriers=null,r.polygonBarriers=null,r.routes=null,r}var m}.apply(null,s))||(e.exports=i)}}]);