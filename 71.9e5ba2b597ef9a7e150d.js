(function(){(this||window).webpackJsonp.registerAbsMids({"esri/renderers/support/heatmapUtils":1788,"esri/views/2d/layers/features/tileRenderers/BaseTileRenderer":1870,"esri/views/2d/layers/features/tileRenderers/HeatmapTileRenderer":2800,"esri/views/2d/layers/features/tileRenderers/support/HeatmapSource":2801})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{1788:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(61),i(33)],void 0===(r=function(e,t,i,d){function s(e,t,i,n,r){for(var a=new Uint32Array(e*e),o=("buffer"in t?t:new Float64Array(t)),s=("buffer"in i?new Uint32Array(i.buffer):new Uint32Array(new Uint8Array(i).buffer)),l=s.length/(r-n),u=0;u<o.length;u++){var p=o[u],c=Math.floor((p-n)*l);a[u]=s[d.clamp(c,0,s.length-1)]}return a.buffer}function A(e){for(var t=Math.round(3*e),i=2*e*e,n=new Float64Array(2*t+1),r=0;r<=n.length;r++)n[r]=Math.exp(-Math.pow(r-t,2)/i)/Math.sqrt(2*Math.PI)*(e/2);return n}function V(t,i){return"function"==typeof t?t:t?"string"==typeof i?function(e){return-1*e[t]}:function(e){return+e[t]+i}:function(){return 1}}Object.defineProperty(t,"__esModule",{value:!0}),t.generateGradient=function(){if(!("document"in i))return function(){return null};var s=document.createElement("canvas"),l=s.getContext("2d");return s.height=512,s.width=1,function(e){l.clearRect(0,0,1,s.height);for(var t=l.createLinearGradient(0,0,0,s.height),i=0,n=e.colorStops;i<n.length;i++){var r=n[i],a=r.ratio,o=r.color;t.addColorStop(Math.max(a,.001),"rgba("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+")")}return l.fillStyle=t,l.fillRect(0,0,1,s.height),l.getImageData(0,0,1,s.height).data}}(),t.calculateHeatmapIntensityInfo=function(e,t,i,n){for(var r,a=t.blurRadius,o=t.fieldOffset,s=t.field,l=new Float64Array(i*n),u=A(a),p=Math.round(3*a),c=Number.NEGATIVE_INFINITY,d=V(s,o),f=0,h=e;f<h.length;f++)for(var y=h[f],m=y.geometry,v=y.attributes,g=m.x-p,w=m.y-p,x=Math.max(0,g),I=Math.max(0,w),b=Math.min(n,m.y+p),T=Math.min(i,m.x+p),_=+d(v),P=I;P<b;P++)for(var M=u[P-w],R=x;R<T;R++){var U=u[R-g];c<(r=l[P*i+R]+=M*U*_)&&(c=r)}return{matrix:l.buffer,max:c}},t.drawHeatmap=function(e,t,i,n,r,a){e.canvas.width=e.canvas.height=t,e.clearRect(0,0,t,t);var o=e.getImageData(0,0,t,t);i&&n&&o.data.set(new Uint8ClampedArray(s(t,i,n,r,a))),e.putImageData(o,0,0)},t.createHeatmapImageData=s,t.createKernel=A,t.createValueFunction=V}.apply(null,n))||(e.exports=r)},1870:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(1),i(0),i(206),i(2)],void 0===(r=function(e,t,i,n,r,a){Object.defineProperty(t,"__esModule",{value:!0});var o,s=(o=a.declared(r.HandleOwner),i(l,o),l.prototype.destroy=function(){this.tiles.clear(),this.layer=this.layerView=this.tileInfoView=this.tiles=null},Object.defineProperty(l.prototype,"updating",{get:function(){return this.isUpdating()},enumerable:!0,configurable:!0}),l.prototype.acquireTile=function(e){var t=this,i=this.createTile(e);return i.once("isReady",function(){return t.notifyChange("updating")}),this.tiles.set(e.id,i),i},l.prototype.lockAttributeTextureUpload=function(){},l.prototype.unlockAttributeTextureUpload=function(){},l.prototype.forceAttributeTextureUpload=function(){},l.prototype.forEachTile=function(e){this.tiles.forEach(e)},l.prototype.releaseTile=function(e){this.tiles.delete(e.key.id),this.disposeTile(e)},l.prototype.isUpdating=function(){var t=!0;return this.tiles.forEach(function(e){t=t&&e.isReady}),!t},l.prototype.setHighlight=function(){},l.prototype.invalidateLabels=function(){},l.prototype.requestUpdate=function(){this.layerView.requestUpdate()},n([a.property()],l.prototype,"layer",void 0),n([a.property()],l.prototype,"layerView",void 0),n([a.property()],l.prototype,"tileInfoView",void 0),n([a.property()],l.prototype,"updating",null),n([a.subclass("esri.views.2d.layers.features.tileRenderers.BaseTileRenderer")],l));function l(e){var t=o.call(this,e)||this;return t.tiles=new Map,t}t.default=s}.apply(null,n))||(e.exports=r)},2800:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(0),i(1),i(4),i(2),i(1788),i(515),i(1870),i(2801)],void 0===(r=function(e,t,i,n,r,a,o,s,l,u){Object.defineProperty(t,"__esModule",{value:!0});var p,c=(p=a.declared(l.default),n(d,p),d.prototype.createTile=function(e){var t=this._container.createTile(e);return this.tileInfoView.getTileCoords(t.bitmap,e),t.bitmap.resolution=this.tileInfoView.getTileResolution(e),t},d.prototype.onConfigUpdate=function(){var i=this,e=this.layer.renderer;if("heatmap"===e.type){var n=e.minPixelIntensity,r=e.maxPixelIntensity;this._intensityInfo.minPixelIntensity=n,this._intensityInfo.maxPixelIntensity=r,this._gradient=o.generateGradient(e.toJSON()),this.tiles.forEach(function(e){var t=e.bitmap.source;t&&(t.minPixelIntensity=n,t.maxPixelIntensity=r,t.gradient=i._gradient,e.bitmap.invalidateTexture())})}},d.prototype.hitTest=function(){return r.resolve([])},d.prototype.install=function(e){e.addChild(this._container)},d.prototype.uninstall=function(e){this._container.removeAllChildren(),e.removeChild(this._container)},d.prototype.disposeTile=function(e){this._container.removeChild(e),e.destroy()},d.prototype.supportsRenderer=function(e){return e&&"heatmap"===e.type},d.prototype.onTileData=function(e){var t=this.tiles.get(e.tileKey);if(t){var i=e.intensityInfo,n=this._intensityInfo,r=n.minPixelIntensity,a=n.maxPixelIntensity,o=t.bitmap.source||new u.HeatmapSource;o.intensities=i&&i.matrix||null,o.minPixelIntensity=r,o.maxPixelIntensity=a,o.gradient=this._gradient,t.bitmap.source=o,this._container.addChild(t),this.requestUpdate()}},d.prototype.onTileError=function(e){console.error(e)},i([a.subclass("esri.views.2d.layers.features.tileRenderers.HeatmapTileRenderer")],d));function d(e){var t=p.call(this,e)||this;t._intensityInfo={minPixelIntensity:0,maxPixelIntensity:0},t.featuresView={attributeView:{initialize:function(){},requestUpdate:function(){}},requestRender:function(){}};var i=e.layerView.clips;return t._container=new s.BitmapTileContainer(e.tileInfoView,e.layerView.clips),t.handles.add([i.on("change",function(){return t._container.setClips(i)})]),t}t.default=c}.apply(null,n))||(e.exports=r)},2801:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(1788)],void 0===(r=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=(r.prototype.render=function(e){i.drawHeatmap(e,512,this.intensities,this.gradient,this.minPixelIntensity,this.maxPixelIntensity)},r);function r(){this.gradient=null,this.height=512,this.width=512}t.HeatmapSource=n}.apply(null,n))||(e.exports=r)}}]);