(function(){(this||window).webpackJsonp.registerAbsMids({"esri/layers/graphics/data/utils":1674,"esri/layers/graphics/data/attributeSupport":1695,"esri/layers/graphics/centroid":1725,"esri/layers/graphics/data/spatialQuerySupport":1726,"esri/layers/graphics/data/timeSupport":1762,"esri/core/sql/WhereClauseCache":1813,"esri/layers/graphics/contains":1814,"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":1815,"esri/layers/graphics/data/FeatureFilter":2767})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{1674:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(9),r(10),r(17),r(12),r(4),r(69),r(320),r(38),r(485),r(55),r(1725),r(306),r(302),r(1649),r(1726)],void 0===(n=function(e,c,p,d,t,f,h,y,g,m,v,_,i,I,n,S,T){function o(e,t,r,i,n){void 0===i&&(i=e.hasZ),void 0===n&&(n=e.hasM);var o=e.hasZ&&i,s=e.hasM&&n;if(r){var a=I.quantizeOptimizedGeometry(R,t,e.hasZ,e.hasM,"esriGeometryPoint",r,i,n);return I.convertToPoint(a,o,s)}return I.convertToPoint(t,o,s)}function u(a,l,u){return d(this,void 0,void 0,function(){var t,r,i,n,o,s;return p(this,function(e){switch(e.label){case 0:return a?(t=a.where,a.where=t=t&&t.trim(),(!t||/^1 *= *1$/.test(t)||l&&l===t)&&(a.where=null),a.geometry?[4,function(c){return d(this,void 0,void 0,function(){var t,r,i,n,o,s,a,l,u;return p(this,function(e){switch(e.label){case 0:return t=c.geometry,r=c.distance,i=c.units,null==r?[2,h.resolve(t)]:(n=t.spatialReference,o=i&&b.fromJSON(i)||y.getUnitString(n),n&&(_.isGeographic(n)||_.isWebMercator(n))?(a=t,[3,3]):[3,1]);case 1:return[4,S.checkProjectionSupport(n,_.WGS84).then(function(){return S.project(t,_.WGS84)})];case 2:a=e.sent(),e.label=3;case 3:return s=a,[4,T.getGeodesicBufferOperator()];case 4:return l=e.sent(),[2,(u=l(s,r,o))?u.toJSON():null]}})})}(a)]:[2,a]):[2,null];case 1:return r=e.sent(),a.distance=0,a.units=null,"esriSpatialRelEnvelopeIntersects"===a.spatialRel&&(i=a.geometry.spatialReference,(r=g.getGeometryExtent(r)).spatialReference=i),a.geometry=r,[4,S.checkProjectionSupport(r.spatialReference,u)];case 2:return e.sent(),[4,v.normalizeCentralMeridian(m.fromJSON(r))];case 3:if(n=e.sent()[0],f.isNone(n))throw c.QUERY_ENGINE_EMPTY_RESULT;return o=n.toJSON(),[4,S.project(o,o.spatialReference,u)];case 4:if(!(s=e.sent()))throw c.QUERY_ENGINE_EMPTY_RESULT;return s.spatialReference=u,a.geometry=s,[2,a]}})})}Object.defineProperty(c,"__esModule",{value:!0});var b=new t.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});c.QUERY_ENGINE_EMPTY_RESULT=Object.freeze({});var w=new n.default,N=new n.default,R=new n.default,E={esriGeometryPoint:I.convertToPoint,esriGeometryPolyline:I.convertToPolyline,esriGeometryPolygon:I.convertToPolygon,esriGeometryMultipoint:I.convertToMultipoint};c.transformCentroid=o,c.getCentroid=function(e,t,r){return"esriGeometryPolygon"===e.geometryType&&t&&(t.centroid||t.geometry)?(t.centroid||(t.centroid=i.getCentroidOptimizedGeometry(new n.default,t.geometry,e.hasZ,e.hasM)),o(e,t.centroid,r)):null},c.getGeometry=function(e,t,r,i,n,o){void 0===n&&(n=e.hasZ),void 0===o&&(o=e.hasM);var s=e.hasZ&&n,a=e.hasM&&o,l=t?"coords"in t?t:t.geometry:null;if(!l)return null;if(r){var u=I.generalizeOptimizedGeometry(N,l,e.hasZ,e.hasM,e.geometryType,r,n,o);return i&&(u=I.quantizeOptimizedGeometry(R,u,s,a,e.geometryType,i)),E[e.geometryType](u,s,a)}if(i){u=I.quantizeOptimizedGeometry(R,l,e.hasZ,e.hasM,e.geometryType,i,n,o);return E[e.geometryType](u,s,a)}return I.removeZMValues(w,l,e.hasZ,e.hasM,n,o),E[e.geometryType](w,s,a)},c.normalizeQuery=function(s,a,l){return d(this,void 0,void 0,function(){var t,r,i,n,o;return p(this,function(e){if(t=s.outFields,r=s.orderByFields,i=s.groupByFieldsForStatistics,n=s.outStatistics,t)for(o=0;o<t.length;o++)t[o]=t[o].trim();if(r)for(o=0;o<r.length;o++)r[o]=r[o].trim();if(i)for(o=0;o<i.length;o++)i[o]=i[o].trim();if(n)for(o=0;o<n.length;o++)n[o].onStatisticField&&(n[o].onStatisticField=n[o].onStatisticField.trim());return s.geometry&&!s.outSR&&(s.outSR=s.geometry.spatialReference),[2,u(s,a,l)]})})},c.normalizeFilter=function(t,r,i){return d(this,void 0,void 0,function(){return p(this,function(e){return[2,u(t,r,i)]})})},c.normalizeQueryLike=u,c.cleanFromGeometryEngine=function(e){return e&&r in e?JSON.parse(JSON.stringify(e,s)):e};var r="_geVersion",s=function(e,t){return e!==r?t:void 0}}.apply(null,i))||(e.exports=n)},1695:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(5),r(6),r(63),r(1813)],void 0===(n=function(e,t,r,p,i,n){function d(e,t){return e?s.get(e,t):null}function f(e,t,r,i){void 0===i&&(i=!0);for(var n=[],o=0,s=t;o<s.length;o++){var a=s[o];if("*"!==a&&!e.has(a))if(i){var l=h(a);try{var u=d(l,e);if(!u)throw new p(y,"invalid SQL expression",{where:l});if(!u.isStandardized)throw new p(y,"expression is not standard",{clause:u});f(e,u.fieldNames,"expression contains missing fields")}catch(e){var c=e&&e.details;if(c&&(c.clause||c.where))throw e;c&&c.missingFields?n.push.apply(n,c.missingFields):n.push(a)}}else n.push(a)}if(n.length)throw new p(y,r,{missingFields:n})}function h(e){return e.split(o)[0]}Object.defineProperty(t,"__esModule",{value:!0});var s=new n.WhereClauseCache(50,500),y="feature-store:unsupported-query",o=" as ",a=i.createSetFromValues(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);t.validateWhere=function(e,t){if(!t)return!0;var r=s.get(t,e);if(!r)throw new p(y,"invalid SQL expression",{where:t});if(!r.isStandardized)throw new p(y,"where clause is not standard",{where:t});return f(e,r.fieldNames,"where clause contains missing fields"),!0},t.validateHaving=function(o,e,r){if(!e)return!0;var t=s.get(e,o);if(!t)throw new p(y,"invalid SQL expression",{having:e});if(!t.isAggregate)throw new p(y,"having does not contain a valid aggregate function",{having:e});var i=t.fieldNames;if(f(o,i,"having contains missing fields"),!t.getExpressions().every(function(e){var i=e.aggregateType,t=e.field,n=o.has(t)&&o.get(t).name;return r.some(function(e){var t=e.onStatisticField,r=e.statisticType;return(o.has(t)&&o.get(t).name)===n&&r.toLowerCase().trim()===i})}))throw new p(y,"expressions in having should also exist in outStatistics",{having:e});return!0},t.getWhereClause=d,t.validateFields=f,t.getExpressionFromFieldName=h,t.getAliasFromFieldName=function(e){return e.split(o)[1]},t.hasInvalidFieldType=function(e,t){var r=t.get(e);return!!r&&!a.has(r.type)}}.apply(null,i))||(e.exports=n)},1725:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){function M(e,t){return e?t?4:3:t?3:2}function m(e,t,r,i,n,o){for(var s=M(n,o),a=r,l=r+s,u=0,c=0,p=0,d=0,f=0,h=0,y=i-1;h<y;h++,a+=s,l+=s){var g=t[a],m=t[a+1],v=t[a+2],_=t[l],I=t[l+1],S=t[l+2],T=g*I-_*m;d+=T,u+=(g+_)*T,c+=(m+I)*T,n&&(p+=(v+S)*(T=g*S-_*v),f+=T),g<e[0]&&(e[0]=g),g>e[1]&&(e[1]=g),m<e[2]&&(e[2]=m),m>e[3]&&(e[3]=m),n&&(v<e[4]&&(e[4]=v),v>e[5]&&(e[5]=v))}if(0<d&&(d*=-1),0<f&&(f*=-1),!d)return null;var b=[u,c,.5*d];return n&&(b[3]=p,b[4]=.5*f),b}function v(e,t,r,i,n){for(var o=M(i,n),s=t,a=t+o,l=0,u=0,c=0,p=0,d=0,f=r-1;d<f;d++,s+=o,a+=o){var h=e[s],y=e[s+1],g=e[s+2],m=e[a],v=e[a+1],_=e[a+2],I=i?(void 0,G=m-h,O=v-y,P=_-g,Math.sqrt(G*G+O*O+P*P)):(void 0,E=m-h,F=v-y,Math.sqrt(E*E+F*F));if(I)if(l+=I,i){u+=I*(S=[(w=h)+.5*(m-w),(N=y)+.5*(v-N),(R=g)+.5*(_-R)])[0],c+=I*S[1],p+=I*S[2]}else{var S;u+=I*(S=[(T=h)+.5*(m-T),(b=y)+.5*(v-b)])[0],c+=I*S[1]}}var T,b,w,N,R,E,F,G,O,P;return 0<l?i?[u/l,c/l,p/l]:[u/l,c/l]:0<r?i?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}Object.defineProperty(t,"__esModule",{value:!0}),t.getCentroidOptimizedGeometry=function(e,t,i,r){if(!t||!t.lengths.length)return null;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);for(var n=e.coords,o=[],s=i?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],a=t.lengths,l=t.coords,u=M(i,r),c=0,p=0,d=a;p<d.length;p++){var f=d[p],h=m(s,l,c,f,i,r);h&&o.push(h),c+=f*u}if(o.sort(function(e,t){var r=e[2]-t[2];return 0===r&&i&&(r=e[4]-t[4]),r}),o.length){var y=6*o[0][2];n[0]=o[0][0]/y,n[1]=o[0][1]/y,i&&(y=6*o[0][4],n[2]=0!==y?o[0][3]/y:0),(n[0]<s[0]||n[0]>s[1]||n[1]<s[2]||n[1]>s[3]||i&&(n[2]<s[4]||n[2]>s[5]))&&(n.length=0)}if(!n.length){var g=t.lengths[0]?v(l,0,a[0],i,r):null;if(!g)return null;n[0]=g[0],n[1]=g[1],i&&2<g.length&&(n[2]=g[2])}return e},t.lineCentroid=v}.apply(null,i))||(e.exports=n)},1726:function(e,t,n){var r,i;r=[n.dj.c(e.i),t,n(9),n(10),n(6),n(4),n(162),n(318),n(38),n(55),n(1814),n(306),n(302),n(1649),n(1674)],void 0===(i=function(e,t,r,i,u,a,l,c,p,d,f,h,y,g,m){function v(){return a.create(function(t){return n.e(2).then(function(){var e=[n(1571)];t.apply(null,e)}.bind(this)).catch(n.oe)})}Object.defineProperty(t,"__esModule",{value:!0});var _="feature-store:unsupported-query",I={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},S={spatialRelationship:{esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},queryGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},layerGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1}};t.importGeometryEngine=v,t.getGeodesicBufferOperator=function(){return v().then(function(e){return e.geodesicBuffer})},t.getSpatialQueryOperator=function(r,i,n){if(p.isPolygon(i)&&"esriGeometryPoint"===n.geometryType&&("esriSpatialRelIntersects"===r||"esriSpatialRelContains"===r)){var t=h.convertFromPolygon(new y.default,i,!1,!1);return a.resolve(function(e){return f.polygonContainsPoint(t,!1,!1,e)})}if(p.isPolygon(i)&&"esriGeometryMultipoint"===n.geometryType){var o=h.convertFromPolygon(new y.default,i,!1,!1);if("esriSpatialRelContains"===r)return a.resolve(function(e){return f.polygonContainsMultipoint(o,!1,!1,e,n.hasZ,n.hasM)})}if(p.isExtent(i)&&"esriGeometryPoint"===n.geometryType&&("esriSpatialRelIntersects"===r||"esriSpatialRelContains"===r))return a.resolve(function(e){return l.extentContainsPoint(i,m.getGeometry(n,e))});if(p.isExtent(i)&&"esriGeometryMultipoint"===n.geometryType&&"esriSpatialRelContains"===r)return a.resolve(function(e){return l.extentContainsMultipoint(i,m.getGeometry(n,e))});if(p.isExtent(i)&&"esriSpatialRelIntersects"===r){var s=c.getExtentIntersector(n.geometryType);return a.resolve(function(e){return s(i,m.getGeometry(n,e))})}return v().then(function(e){var t=e[I[r]].bind(null,i);return function(e){return t(m.getGeometry(n,e))}})},t.checkSpatialQuerySupport=function(s,a,l){return i(this,void 0,void 0,function(){var n,o;return r(this,function(e){if(n=s.spatialRel,!(o=s.geometry))return[2];if(t=n,!0!==S.spatialRelationship[t])throw new u(_,"Unsupported query spatial relationship",{query:s});var t,r,i;if(!d.isValid(o.spatialReference)||!d.isValid(l))return[2];if(r=o,!0!==S.queryGeometry[p.getJsonType(r)])throw new u(_,"Unsupported query geometry type",{query:s});if(i=a,!0!==S.layerGeometry[i])throw new u(_,"Unsupported layer geometry type",{query:s});return s.outSR?[2,g.checkProjectionSupport(s.geometry&&s.geometry.spatialReference,s.outSR)]:[2]})})},t.canQueryWithRBush=function(e){if(p.isExtent(e))return!0;if(p.isPolygon(e)){for(var t=0,r=e.rings;t<r.length;t++){var i=r[t];if(5!==i.length)return!1;if(i[0][0]!==i[1][0]||i[0][0]!==i[4][0]||i[2][0]!==i[3][0]||i[0][1]!==i[3][1]||i[0][1]!==i[4][1]||i[1][1]!==i[2][1])return!1}return!0}return!1}}.apply(null,r))||(e.exports=i)},1762:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getTimeExtent=function(e,t){if(!e)return null;var i=t.featureAdapter,n=e.startTimeField,o=e.endTimeField,s=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY;if(n&&o)t.forEach(function(e){var t=i.getAttribute(e,n),r=i.getAttribute(e,o);null==t||isNaN(t)||(s=Math.min(s,t)),null==r||isNaN(r)||(a=Math.max(a,r))});else{var r=n||o;t.forEach(function(e){var t=i.getAttribute(e,r);null==t||isNaN(t)||(s=Math.min(s,t),a=Math.max(a,t))})}return{start:s,end:a}},t.getTimeOperator=function(e,t,r){if(!t||!e)return null;var i=e.startTimeField,n=e.endTimeField;if(!i&&!n)return null;var o,s,a,l,u=t.start,c=t.end;return null==u&&null==c?null:i&&n?function(o,s,a,l,u){if(null==l||null==u||l!==u)return null!=l&&null!=u?function(e){return t=l,r=u,i=o.getAttribute(e,s),n=o.getAttribute(e,a),!(r<i||n<t);var t,r,i,n}:null!=l?function(e){return!(o.getAttribute(e,a)<l)}:null!=u?function(e){return!(o.getAttribute(e,s)>u)}:void 0;var t=l;return function(e){return t>=o.getAttribute(e,s)&&t<=o.getAttribute(e,a)}}(r,i,n,u,c):(o=r,s=i||n,l=c,null!=(a=u)&&null!=l&&a===l?function(e){return o.getAttribute(e,s)===a}:null!=a&&null!=l?function(e){return o.getAttribute(e,s)>=a&&o.getAttribute(e,s)<=l}:null!=a?function(e){return o.getAttribute(e,s)>=a}:null!=l?function(e){return o.getAttribute(e,s)<=l}:void 0)}}.apply(null,i))||(e.exports=n)},1813:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(516),r(1570)],void 0===(n=function(e,t,r,o){Object.defineProperty(t,"__esModule",{value:!0});var i=(n.prototype.get=function(e,t){var r=t.uid+":"+e,i=this._cache.get(r);if(i)return i;if(void 0!==this._invalidCache.get(r))return null;try{var n=o.WhereClause.create(e,t);return this._cache.put(r,n),n}catch(e){return this._invalidCache.put(r,null),null}},n);function n(e,t){this._cache=new r(e),this._invalidCache=new r(t)}t.WhereClauseCache=i}.apply(null,i))||(e.exports=n)},1814:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){function d(e,t){return e?t?4:3:t?3:2}function p(e,t,r,i,n){if(!e)return!1;for(var o=d(t,r),s=e.coords,a=!1,l=0,u=0,c=e.lengths;u<c.length;u++){var p=c[u];a=f(a,s,o,l,p,i,n),l+=p*o}return a}function f(e,t,r,i,n,o,s){for(var a=e,l=i,u=i,c=i+n*r;u<c;u+=r){(l=u+r)===c&&(l=i);var p=t[u],d=t[u+1],f=t[l],h=t[l+1];(d<s&&s<=h||h<s&&s<=d)&&p+(s-d)/(h-d)*(f-p)<o&&(a=!a)}return a}Object.defineProperty(t,"__esModule",{value:!0}),t.polygonContainsPoint=function(e,t,r,i){return p(e,t,r,i.coords[0],i.coords[1])},t.polygonContainsMultipoint=function(e,t,r,i,n,o){var s=d(n,o),a=i.coords,l=i.lengths;if(!l)return!1;for(var u=0,c=0;u<l.length;u++,c+=s)if(!p(e,t,r,a[c],a[c+1]))return!1;return!0},t.polygonContainsCoords=p}.apply(null,i))||(e.exports=n)},1815:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1725),r(487),r(302)],void 0===(n=function(e,t,r,i,n){Object.defineProperty(t,"__esModule",{value:!0}),t.optimizedFeatureQueryEngineAdapter={getObjectId:function(e){return e.objectId},getAttributes:function(e){return e.attributes},getAttribute:function(e,t){return e.attributes[t]},cloneWithGeometry:function(e,t){return new i.default(t,e.attributes,null,e.objectId)},getGeometry:function(e){return e.geometry},getCentroid:function(e,t){return e.centroid||(e.centroid=r.getCentroidOptimizedGeometry(new n.default,e.geometry,t.hasZ,t.hasM)),e.centroid}},t.default=t.optimizedFeatureQueryEngineAdapter}.apply(null,i))||(e.exports=n)},2767:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(5),r(9),r(6),r(63),r(3),r(12),r(4),r(80),r(490),r(1695),r(1815),r(1726),r(1762),r(1674),r(301)],void 0===(n=function(e,t,o,r,s,i,l,n,a,u,c,p,d,f,h,y,g,m){Object.defineProperty(t,"__esModule",{value:!0});var v=n.getLogger("esri.views.2d.layers.features.controllers.FeatureFilter"),_=(Object.defineProperty(I.prototype,"hash",{get:function(){return this._hash},enumerable:!0,configurable:!0}),I.prototype.clear=function(){var e=this._resetAllHiddenIds();return this.update(),{show:e,hide:[]}},I.prototype.invalidate=function(){var r=this;this._idToVisibility.forEach(function(e,t){r._idToVisibility.set(t,0)})},I.prototype.setKnownIds=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];this._idToVisibility.set(i,1)}},I.prototype.setTrue=function(e){var n=this,o=[],s=[],a=l.createSetFromValues(e);return this._idToVisibility.forEach(function(e,t){var r=!!(1&n._idToVisibility.get(t)),i=a.has(t);!r&&i?o.push(t):r&&!i&&s.push(t),n._idToVisibility.set(t,i?3:0)}),{show:o,hide:s}},I.prototype.createQuery=function(){var e=this,t=e.geometry,r=e.spatialRel,i=e.where,n=e.timeExtent,o=e.objectIds;return m.fromJSON({geometry:t,spatialRel:r,where:i,timeExtent:n,objectIds:o})},I.prototype.update=function(r,i){return o(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return this._hash=JSON.stringify(r),[4,g.normalizeQueryLike(r,null,i)];case 1:return t=e.sent(),[4,u.all([this._setGeometryFilter(t),this._setIdFilter(t),this._setAttributeFilter(t),this._setTimeFilter(t)])];case 2:return e.sent(),[2]}})})},I.prototype._setAttributeFilter=function(e){if(!e||!e.where)return this._clause=null,void(this.where=null);var t=d.getWhereClause(e.where,this._serviceInfo.fieldsIndex);if(t.isStandardized)this._clause=t;else{var r=new i("mapview - bad input","Unable to apply filter's definition expression, as expression is not standardized.",t);v.error(r)}this.where=e.where},I.prototype._setIdFilter=function(e){this._idsToShow=e&&e.objectIds&&l.createSetFromValues(e.objectIds),this._idsToHide=e&&e.hiddenIds&&l.createSetFromValues(e.hiddenIds),this.objectIds=e&&e.objectIds},I.prototype._setGeometryFilter=function(n){return o(this,void 0,void 0,function(){var t,r,i;return s(this,function(e){switch(e.label){case 0:return n&&n.geometry?(t=n.geometry,r=n.spatialRel||"esriSpatialRelIntersects",[4,h.getSpatialQueryOperator(r,t,this._serviceInfo)]):(this._spatialQueryOperator=null,this.geometry=null,this.spatialRel=null,[2]);case 1:return i=e.sent(),p.getBoundsXY(this._geometryBounds,t),this._spatialQueryOperator=i,this.geometry=t,this.spatialRel=r,[2]}})})},I.prototype._setTimeFilter=function(e){if(this.timeExtent=this._timeOperator=null,e&&e.timeExtent){if(!this._serviceInfo.timeInfo){var t=new i("feature-layer-view:time-filter-not-available","Unable to apply time filter, as layer doesn't have time metadata.",e.timeExtent);return void v.error(t)}this.timeExtent=e.timeExtent,this._timeOperator=y.getTimeOperator(this._serviceInfo.timeInfo,e.timeExtent,f.optimizedFeatureQueryEngineAdapter)}},I.prototype._applyFilter=function(e){return this._filterByGeometry(e)&&this._filterById(e)&&this._filterByTime(e)&&this._filterByExpression(e)},I.prototype._filterByExpression=function(e){return!this.where||this._clause.testFeature(e)},I.prototype._filterById=function(e){return(!this._idsToHide||!this._idsToHide.has(e.objectId))&&(!this._idsToShow||this._idsToShow.has(e.objectId))},I.prototype._filterByGeometry=function(e){return!this.geometry||!!this._earlyGeometryReject(e)&&this._spatialQueryOperator(e.geometry)},I.prototype._filterByTime=function(e){return!a.isSome(this._timeOperator)||this._timeOperator(e)},I.prototype._earlyGeometryReject=function(e){return!(!e.geometry||!e.geometry.coords.length)&&(!e.centroid||"esriSpatialRelContains"!==this.spatialRel||c.containsPoint(this._geometryBounds,e.centroid.coords))},I.prototype._resetAllHiddenIds=function(){var r=this,i=[];return this._idToVisibility.forEach(function(e,t){1&e||(r._idToVisibility.set(t,1),i.push(t))}),i},I);function I(e){var n=this;this._geometryBounds=c.create(),this._idToVisibility=new Map,this.check=function(e){var t=e.objectId,r=n._idToVisibility,i=n._applyFilter(e);return r.set(t,i?3:2),!!(1&r.get(t))},this._serviceInfo=e}t.default=_}.apply(null,i))||(e.exports=n)}}]);