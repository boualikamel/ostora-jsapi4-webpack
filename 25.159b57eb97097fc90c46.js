(function(){(this||window).webpackJsonp.registerAbsMids({"esri/layers/KMLLayer":1581,"esri/layers/support/kmlUtils":1768,"esri/layers/support/KMLSublayer":2606})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{1581:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(5),r(1),r(0),r(9),r(10),r(28),r(18),r(223),r(12),r(120),r(4),r(2),r(31),r(100),r(124),r(122),r(213),r(155),r(2606),r(1768)],void 0===(o=function(e,t,r,n,o,i,l,s,a,u,p,y,f,c,d,h,b,v,g,m,S,w){return x=c.declared(g.RefreshableLayer(m.ScaleRangeLayer(b.OperationalLayer(v.PortalLayer(y.MultiOriginJSONMixin(h)))))),n(O,x),O.prototype.initialize=function(){var r=this;this.watch("sublayers",function(e,t){t&&t.forEach(function(e){e.parent=null,e.layer=null}),e&&e.forEach(function(e){e.parent=r,e.layer=r})},!0),this.on("sublayer-update",function(){return r.notifyChange("fullExtent")})},O.prototype.normalizeCtorArgs=function(e,t){return"string"==typeof e?r({url:e},t):e},O.prototype.readSublayersFromItemOrWebMap=function(e,t){this._visibleFolders=t.visibleFolders},O.prototype.readSublayers=function(e,t,r){return w.sublayersFromJSON(S,t,r,this._visibleFolders)},O.prototype.writeSublayers=function(e,t){for(var r=[],n=e.toArray();n.length;){var o=n[0];o.networkLink||(o.visible&&r.push(o.id),o.sublayers&&n.push.apply(n,o.sublayers.toArray())),n.shift()}t.visibleFolders=r},Object.defineProperty(O.prototype,"title",{get:function(){if(this._get("title")&&"defaults"!==this.originOf("title"))return this._get("title");if(this.url){var e=this.url.substring(this.url.lastIndexOf("/")+1,this.parsedUrl.path.lastIndexOf("."));return 0===e.length&&(e="KML"),e}return this._get("title")||""},set:function(e){this._set("title",e)},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"visibleSublayers",{get:function(){var e=this.sublayers,t=[],r=function(e){e.visible&&(t.push(e),e.sublayers&&e.sublayers.forEach(r))};return e&&e.forEach(r),t},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"fullExtent",{get:function(){return this._recomputeFullExtent()},enumerable:!0,configurable:!0}),O.prototype.load=function(e){var t=this,r=p.isSome(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["KML"]},e).then(function(){return t._fetchService(r)})),this.when()},O.prototype._fetchService=function(o){return l(this,void 0,void 0,function(){var t,r,n=this;return i(this,function(e){switch(e.label){case 0:return[4,f.resolve().then(function(){return n.resourceInfo?{ssl:!1,data:n.resourceInfo}:w.fetchService(n.url,n.outSpatialReference,n.refreshInterval,o)})];case 1:return t=e.sent(),(r=w.parseKML(t.data))&&this.read(r,{origin:"service"}),[2]}})})},O.prototype._recomputeFullExtent=function(){var o=null;this.extent&&(o=this.extent.clone());var i=function(e){if(e.sublayers)for(var t=0,r=e.sublayers.items;t<r.length;t++){var n=r[t];i(n),n.visible&&n.fullExtent&&(o?o.union(n.fullExtent):o=n.fullExtent.clone())}};return i(this),o},o([c.property({readOnly:!0})],O.prototype,"allSublayers",void 0),o([c.property({type:d})],O.prototype,"outSpatialReference",void 0),o([c.property({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],O.prototype,"path",void 0),o([c.property({type:["show","hide","hide-children"]})],O.prototype,"listMode",void 0),o([c.property({type:["KML"]})],O.prototype,"operationalLayerType",void 0),o([c.property({type:a.ofType(S),json:{write:{ignoreOrigin:!0}}})],O.prototype,"sublayers",void 0),o([c.reader(["web-map","portal-item"],"sublayers",["visibleFolders"])],O.prototype,"readSublayersFromItemOrWebMap",null),o([c.reader("service","sublayers",["sublayers"])],O.prototype,"readSublayers",null),o([c.writer("sublayers")],O.prototype,"writeSublayers",null),o([c.property({readOnly:!0,json:{read:!1}})],O.prototype,"type",void 0),o([c.property({json:{origins:{"web-map":{read:{source:"title"}}},write:{ignoreOrigin:!0}},dependsOn:["url","parsedUrl"]})],O.prototype,"title",null),o([c.property()],O.prototype,"url",void 0),o([c.property({readOnly:!0,dependsOn:["sublayers"]})],O.prototype,"visibleSublayers",null),o([c.property({type:s.Extent})],O.prototype,"extent",void 0),o([c.property({dependsOn:["extent"]})],O.prototype,"fullExtent",null),o([c.subclass("esri.layers.KMLLayer")],O);function O(e,t){var r=x.call(this,e,t)||this;return r._visibleFolders=[],r.allSublayers=new u({root:r,rootCollectionNames:["sublayers"],getChildrenFunction:function(e){return e.sublayers}}),r.outSpatialReference=d.WGS84,r.path=null,r.operationalLayerType="KML",r.sublayers=null,r.type="kml",r.url=null,r}var x}.apply(null,n))||(e.exports=o)},1768:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(9),r(10),r(5),r(58),r(105),r(29),r(8),r(31),r(492),r(490),r(157),r(207)],void 0===(o=function(e,t,f,r,n,i,c,l,d,h,b,v,g,m){function S(t,r,e){e.forEach(function(e){t.set(e.attributes[r],e)})}function w(e){for(var t=b.create(),r=b.create(b.NEGATIVE_INFINITY),n=0,o=e;n<o.length;n++){var i=o[n];if(i.polygons&&i.polygons.featureSet&&i.polygons.featureSet.features)for(var l=0,s=i.polygons.featureSet.features;l<s.length;l++){var a=s[l];v.getBoundsXYZ(t,a.geometry),b.expand(r,t,r)}if(i.polylines&&i.polylines.featureSet&&i.polylines.featureSet.features)for(var u=0,p=i.polylines.featureSet.features;u<p.length;u++){a=p[u];v.getBoundsXYZ(t,a.geometry),b.expand(r,t,r)}if(i.points&&i.points.featureSet&&i.points.featureSet.features)for(var y=0,f=i.points.featureSet.features;y<f.length;y++){a=f[y];v.getBoundsXYZ(t,a.geometry),b.expand(r,t,r)}if(i.mapImages)for(var c=0,d=i.mapImages;c<d.length;c++){a=d[c];v.getBoundsXYZ(t,a.extent),b.expand(r,t,r)}}return b.equals(r,b.NEGATIVE_INFINITY)?null:{xmin:r[0],ymin:r[1],zmin:r[2],xmax:r[3],ymax:r[4],zmax:r[5],spatialReference:h.WGS84}}Object.defineProperty(t,"__esModule",{value:!0});var O={esriGeometryPoint:"points",esriGeometryPolyline:"polylines",esriGeometryPolygon:"polygons"};t.parseKML=function(s){var e=s.folders||[],a=e.slice(),o=new Map,i=new Map,l=new Map,u=new Map,p=new Map,y={esriGeometryPoint:i,esriGeometryPolyline:l,esriGeometryPolygon:u};(s.featureCollection&&s.featureCollection.layers||[]).forEach(function(e){var t=d.clone(e);t.featureSet.features=[];var r=e.featureSet.geometryType;o.set(r,t);var n=e.layerDefinition.objectIdField;"esriGeometryPoint"===r?S(i,n,e.featureSet.features):"esriGeometryPolyline"===r?S(l,n,e.featureSet.features):"esriGeometryPolygon"===r&&S(u,n,e.featureSet.features)}),s.groundOverlays&&s.groundOverlays.forEach(function(e){p.set(e.id,e)}),e.forEach(function(l){l.networkLinkIds.forEach(function(e){var t,r,n,o,i=(t=e,r=l.id,n=s.networkLinks,(o=function(t,e){var r;return e.some(function(e){return e.id===t&&(r=e,!0)}),r}(t,n))&&(o.parentFolderId=r,o.networkLink=o),o);i&&a.push(i)})}),a.forEach(function(n){n.featureInfos&&(n.points=d.clone(o.get("esriGeometryPoint")),n.polylines=d.clone(o.get("esriGeometryPolyline")),n.polygons=d.clone(o.get("esriGeometryPolygon")),n.mapImages=[],n.featureInfos.map(function(e){switch(e.type){case"esriGeometryPoint":case"esriGeometryPolyline":case"esriGeometryPolygon":var t=y[e.type].get(e.id);t&&n[O[e.type]].featureSet.features.push(t);break;case"GroundOverlay":var r=p.get(e.id);r&&n.mapImages.push(r)}}),n.fullExtent=w([n]))});var t=w(a);return{folders:e,sublayers:a,extent:t}},t.fetchService=function(e,t,r,n){var o=i.kmlServiceUrl;return l(o,{query:{url:e,model:"simple",folders:"",refresh:0!==r||void 0,outSR:JSON.stringify(t)},responseType:"json",signal:n})},t.sublayersFromJSON=function(n,e,o,i){void 0===o&&(o=null),void 0===i&&(i=[]);var l=[],s={},t=e.sublayers,a=e.folders.map(function(e){return e.id});return t.forEach(function(e){var t=new n;if(o?t.read(e,o):t.read(e),i.length&&-1<a.indexOf(t.id)&&(t.visible=-1!==i.indexOf(t.id)),s[e.id]=t,null!=e.parentFolderId&&-1!==e.parentFolderId){var r=s[e.parentFolderId];r.sublayers||(r.sublayers=[]),r.sublayers.unshift(t)}else l.unshift(t)}),l},t.getGraphics=function(y){return r(this,void 0,void 0,function(){var t,r,n,o,i,l,s,a,u,p;return f(this,function(e){switch(e.label){case 0:t=m.fromJSON(y.featureSet),r=t.features,n=y.layerDefinition,o=g.fromJSON(n.drawingInfo.renderer),i=c.fromJSON(y.popupInfo),l=[],s=0,a=r,e.label=1;case 1:return s<a.length?(u=a[s],[4,o.getSymbolAsync(u)]):[3,4];case 2:p=e.sent(),u.symbol=p,u.popupTemplate=i,u.visible=!!u.attributes.visibility,l.push(u),e.label=3;case 3:return s++,[3,1];case 4:return[2,l]}})})},t.computeExtent=w}.apply(null,n))||(e.exports=o)},2606:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(1),r(0),r(91),r(28),r(18),r(54),r(7),r(65),r(12),r(16),r(2),r(19),r(1768)],void 0===(o=function(e,t,r,n,o,i,l,s,a,u,p,y,f,c,d){return b=f.declared(s.EventedMixin(a.JSONSupportMixin(u))),r(h,b),(v=h).prototype.initialize=function(){var e=this;y.whenOnce(this,"networkLink").then(function(){return y.whenTrueOnce(e,"visible")}).then(function(){return e.load()})},h.prototype.load=function(e){var n=this;if(this.networkLink){var t=p.isSome(e)?e.signal:null,r=this._fetchService(this._get("networkLink").href,t).then(function(e){var t=d.computeExtent(e.sublayers);n.fullExtent=i.Extent.fromJSON(t),n.sourceJSON=e;var r=c.default(l.ofType(v),d.sublayersFromJSON(v,e));n.sublayers?n.sublayers.addMany(r):n.sublayers=r,n.layer.emit("sublayer-update"),n.layer&&n.layer.notifyChange("visibleSublayers")});return this.addResolvingPromise(r),this.when()}},Object.defineProperty(h.prototype,"sublayers",{set:function(e){var r=this,t=this._get("sublayers");t&&(t.forEach(function(e){e.parent=null,e.layer=null}),this._sublayersHandles.forEach(function(e){return e.remove()}),this._sublayersHandles=null),e&&(e.forEach(function(e){e.parent=r,e.layer=r.layer}),this._sublayersHandles=[e.on("after-add",function(e){var t=e.item;t.parent=r,t.layer=r.layer}),e.on("after-remove",function(e){var t=e.item;t.parent=null,t.layer=null})]),this._set("sublayers",e)},enumerable:!0,configurable:!0}),h.prototype.castSublayers=function(e){return c.default(l.ofType(v),e)},Object.defineProperty(h.prototype,"visible",{get:function(){return this._get("visible")},set:function(e){this._get("visible")!==e&&(this._set("visible",e),this.layer&&this.layer.notifyChange("visibleSublayers"))},enumerable:!0,configurable:!0}),h.prototype.readVisible=function(e,t){return!!t.visibility},Object.defineProperty(h.prototype,"layer",{set:function(t){this._set("layer",t),this.sublayers&&this.sublayers.forEach(function(e){return e.layer=t})},enumerable:!0,configurable:!0}),h.prototype._fetchService=function(e,t){return d.fetchService(e,this.layer.outSpatialReference,this.layer.refreshInterval,t).then(function(e){return d.parseKML(e.data)})},n([f.property()],h.prototype,"description",void 0),n([f.property()],h.prototype,"id",void 0),n([f.property({readOnly:!0,value:null})],h.prototype,"networkLink",void 0),n([f.property({json:{write:{allowNull:!0}}})],h.prototype,"parent",void 0),n([f.property({value:null,json:{write:{allowNull:!0}}})],h.prototype,"sublayers",null),n([f.cast("sublayers")],h.prototype,"castSublayers",null),n([f.property({value:null,json:{read:{source:"name"}}})],h.prototype,"title",void 0),n([f.property({value:!0})],h.prototype,"visible",null),n([f.reader("visible",["visibility"])],h.prototype,"readVisible",null),n([f.property()],h.prototype,"sourceJSON",void 0),n([f.property({value:null})],h.prototype,"layer",null),n([f.property({type:i.Extent})],h.prototype,"fullExtent",void 0),v=n([f.subclass("esri.layers.support.KMLSublayer")],h);function h(){var e=null!==b&&b.apply(this,arguments)||this;return e._sublayersHandles=null,e.description=null,e.id=null,e.networkLink=null,e.title=null,e.sourceJSON=null,e.fullExtent=null,e}var b,v}.apply(null,n))||(e.exports=o)}}]);