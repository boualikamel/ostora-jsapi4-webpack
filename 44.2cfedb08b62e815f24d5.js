(function(){(this||window).webpackJsonp.registerAbsMids({"esri/views/2d/mapViewDeps":1600,"esri/core/throttle":1794,"esri/views/navigation/Momentum":1801,"esri/views/navigation/FilteredFiniteDifference":1895,"esri/views/navigation/MomentumEstimator":1896,"esri/views/2d/LabelManager":2410,"esri/views/2d/navigation/MapViewNavigation":2416,"esri/views/2d/navigation/ZoomBox":2417,"esri/views/2d/navigation/actions/Pan":2418,"esri/views/navigation/PanPlanarMomentumEstimator":2419,"esri/views/2d/navigation/actions/Pinch":2420,"esri/views/navigation/RotationMomentumEstimator":2421,"esri/views/navigation/ZoomMomentumEstimator":2422,"esri/views/2d/navigation/actions/Rotate":2423,"esri/views/2d/magnifier/MagnifierView2D":2424})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{1600:function(t,e,i){var o,n;o=[i.dj.c(t.i),e,i(2410),i(1713),i(2416),i(2424)],void 0===(n=function(t,e,i,o,n,a){Object.defineProperty(e,"__esModule",{value:!0}),e.LabelManager=i.default,e.GraphicsView2D=o.default,e.MapViewNavigation=n.default,e.MagnifierView2D=a.default}.apply(null,o))||(t.exports=n)},1794:function(t,e,i){var o,n;o=[i.dj.c(t.i),e],void 0===(n=function(t,e){function i(t,e,i,o){var n=null,a=1e3;"number"==typeof e?(a=e,o=i):(n=e,a=i);function r(){l=0,t.apply(o,u)}function s(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];n&&n.apply(o,t),u=t,a?l=l||setTimeout(r,a):r()}var u,l=0;return s.remove=function(){l&&(clearTimeout(l),l=0)},s.forceUpdate=function(){l&&(clearTimeout(l),r())},s.hasPendingUpdates=function(){return!!l},s}Object.defineProperty(e,"__esModule",{value:!0}),e.throttle=i,e.default=i}.apply(null,o))||(t.exports=n)},1801:function(t,e,i){var o,n;o=[i.dj.c(t.i),e,i(11)],void 0===(n=function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var o=(Object.defineProperty(n.prototype,"duration",{get:function(){return this._duration},enumerable:!0,configurable:!0}),n.prototype.isFinished=function(t){return t>this.duration},Object.defineProperty(n.prototype,"friction",{get:function(){return this._friction},enumerable:!0,configurable:!0}),n.prototype.value=function(t){return this.valueFromInitialVelocity(this._initialVelocity,t)},n.prototype.valueDelta=function(t,e){var i=this.value(t);return this.value(t+e)-i},n.prototype.valueFromInitialVelocity=function(t,e){e=Math.min(e,this.duration);var i=1-this.friction;return t*(Math.pow(i,e)-1)/Math.log(i)},n);function n(t,e,i){this._initialVelocity=t,this._stopVelocity=e,this._friction=i,this._duration=Math.abs(Math.log(Math.abs(this._initialVelocity)/this._stopVelocity)/Math.log(1-this._friction))}e.Momentum=o}.apply(null,o))||(t.exports=n)},1895:function(t,e,i){var o,n;o=[i.dj.c(t.i),e],void 0===(n=function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var i=(o.prototype.update=function(t){if(this.hasLastValue){var e=this.computeDelta(t);this.updateDelta(e)}this.lastValue=t},o.prototype.reset=function(){this.lastValue=void 0,this.filteredDelta=void 0},Object.defineProperty(o.prototype,"hasLastValue",{get:function(){return void 0!==this.lastValue},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"hasFilteredDelta",{get:function(){return void 0!==this.filteredDelta},enumerable:!0,configurable:!0}),o.prototype.computeDelta=function(t){return t-this.lastValue},o.prototype.updateDelta=function(t){this.hasFilteredDelta?this.filteredDelta=(1-this.gain)*this.filteredDelta+this.gain*t:this.filteredDelta=t},o);function o(t){this.gain=t}e.FilteredFiniteDifference=i}.apply(null,o))||(t.exports=n)},1896:function(t,e,i){var o,n;o=[i.dj.c(t.i),e,i(11),i(33),i(1895),i(1801)],void 0===(n=function(t,e,i,o,n,a){Object.defineProperty(e,"__esModule",{value:!0});var r=(s.prototype.add=function(t,e){if(this.enabled){if(this.time.hasLastValue){if(this.time.computeDelta(e)<.01)return;if(this.value.hasFilteredDelta){var i=this.value.computeDelta(t);this.value.filteredDelta*i<0&&this.value.reset()}}this.time.update(e),this.value.update(t)}},s.prototype.reset=function(){this.value.reset(),this.time.reset()},s.prototype.evaluateMomentum=function(){if(!this.enabled||!this.value.hasFilteredDelta)return null;var t=this.value.filteredDelta/this.time.filteredDelta;return t=o.clamp(t,-this.maxVelocity,this.maxVelocity),Math.abs(t)<this.minimumInitialVelocity?null:this.createMomentum(t,this.stopVelocity,this.friction)},s.prototype.createMomentum=function(t,e,i){return new a.Momentum(t,e,i)},s);function s(t,e,i,o){void 0===t&&(t=2.5),void 0===e&&(e=.01),void 0===i&&(i=.95),void 0===o&&(o=12),this.minimumInitialVelocity=t,this.stopVelocity=e,this.friction=i,this.maxVelocity=o,this.enabled=!0,this.value=new n.FilteredFiniteDifference(.8),this.time=new n.FilteredFiniteDifference(.3)}e.MomentumEstimator=r}.apply(null,o))||(t.exports=n)},2410:function(t,e,i){var o,n;o=[i.dj.c(t.i),e,i(1),i(0),i(13),i(6),i(206),i(3),i(1794),i(2),i(90)],void 0===(n=function(t,e,i,o,n,a,r,s,u,l,p){Object.defineProperty(e,"__esModule",{value:!0});var h,c=s.getLogger("esri.views.2d.layers.labels.LabelManager"),m=(h=l.declared(r.HandleOwnerMixin(n)),i(d,h),d.prototype.initialize=function(){var o=this;this.collisionEngine=new p.CollisionEngine(this.view.featuresTilingScheme),this._layerViewSorter=new p.LayerViewSorter(function(e,t){o.collisionEngine.registerLayerView(e,t);var i=e.tileRenderer;i&&i.forEachTile(function(t){t.isDirty=!0,o.addTile(e,t)}),o.requestUpdate()},function(t){o.collisionEngine.unregisterLayerView(t),o.requestUpdate()}),this.handles.add(this.view.allLayerViews.on("change",function(t){o._layerViewSorter.update(t)}))},d.prototype.destroy=function(){this._layerViewSorter.destroy(),this._layerViewSorter=null,this.collisionEngine=null,this._applyVisibilityPassThrottled.remove()},Object.defineProperty(d.prototype,"updating",{get:function(){return this.updateRequested},enumerable:!0,configurable:!0}),d.prototype.update=function(t){this._applyVisibilityPassThrottled(t)},d.prototype.viewChange=function(){this.requestUpdate()},d.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate(this))},d.prototype.processUpdate=function(t){this._set("updateParameters",t),this.updateRequested&&(this.update(t),this.updateRequested=!1)},d.prototype.addTile=function(t,e){this.collisionEngine.addTile(t,e)},d.prototype.removeTile=function(t,e){this.collisionEngine.removeTile(t,e)},d.prototype._applyVisibilityPass=function(t){try{var e=this.view.featuresTilingScheme.getClosestInfoForScale(t.state.scale).level;this.collisionEngine.run(t,e)}catch(t){c.error(new a("mapview-labeling","Encountered an error during label decluttering",t))}},o([l.property()],d.prototype,"updateRequested",void 0),o([l.property({readOnly:!0})],d.prototype,"updateParameters",void 0),o([l.property({dependsOn:["updateRequested"]})],d.prototype,"updating",null),o([l.property()],d.prototype,"view",void 0),o([l.subclass("esri.views.2d.layers.labels.LabelManager")],d));function d(t){var e=h.call(this,t)||this;return e._applyVisibilityPassThrottled=u.throttle(e._applyVisibilityPass,64,e),e.lastUpdateId=-1,e.updateRequested=!1,e.view=null,e}e.default=m}.apply(null,o))||(t.exports=n)},2416:function(t,e,i){var o,n;o=[i.dj.c(t.i),e,i(1),i(0),i(9),i(10),i(163),i(13),i(106),i(2),i(43),i(129),i(2417),i(2418),i(2420),i(2423)],void 0===(n=function(t,e,i,o,h,n,a,r,s,u,l,d,p,c,m,v){Object.defineProperty(e,"__esModule",{value:!0});var f,y=new a({targetGeometry:new l}),_=[0,0],g=(f=u.declared(r),i(w,f),w.prototype.initialize=function(){this.pan=new c({navigation:this}),this.rotate=new v({navigation:this}),this.pinch=new m({navigation:this}),this.zoomBox=new p({view:this.view,navigation:this})},w.prototype.destroy=function(){this.zoomBox.destroy(),this.zoomBox=null,this.animationManager=null},w.prototype.begin=function(){this._set("interacting",!0)},w.prototype.end=function(){this._lastEventTimestamp=s(),this._startTimer(250)},w.prototype.zoom=function(e,i){return void 0===i&&(i=this._getDefaultAnchor()),n(this,void 0,void 0,function(){return h(this,function(t){return this.stop(),this.begin(),this.view.constraints.snapToZoom&&this.view.constraints.effectiveLODs?e<1?[2,this.zoomIn(i)]:[2,this.zoomOut(i)]:(this.setViewpoint(i,e,0,[0,0]),[2])})})},w.prototype.zoomIn=function(o){return n(this,void 0,void 0,function(){var e,i;return h(this,function(t){return e=this.view,i=e.constraints.snapToNextScale(e.scale),[2,this._zoomToScale(i,o)]})})},w.prototype.zoomOut=function(o){return n(this,void 0,void 0,function(){var e,i;return h(this,function(t){return e=this.view,i=e.constraints.snapToPreviousScale(e.scale),[2,this._zoomToScale(i,o)]})})},w.prototype.setViewpoint=function(t,e,i,o){this.begin(),this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,t,e,i,o),this.end()},w.prototype.setViewpointImmediate=function(t,e,i,o){void 0===e&&(e=0),void 0===i&&(i=[0,0]),void 0===o&&(o=this._getDefaultAnchor()),this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,o,t,e,i)},w.prototype.continousRotateClockwise=function(){var t=this.get("view.viewpoint");this.animationManager.animateContinous(t,function(t){d.rotateBy(t,t,-1)})},w.prototype.continousRotateCounterclockwise=function(){var t=this.get("view.viewpoint");this.animationManager.animateContinous(t,function(t){d.rotateBy(t,t,1)})},w.prototype.resetRotation=function(){this.view.rotation=0},w.prototype.continousPanLeft=function(){var t=this.get("view.viewpoint");this.animationManager.animateContinous(t,function(t){d.translateBy(t,t,[-10,0])})},w.prototype.continousPanRight=function(){var t=this.get("view.viewpoint");this.animationManager.animateContinous(t,function(t){d.translateBy(t,t,[10,0])})},w.prototype.continousPanUp=function(){var t=this.get("view.viewpoint");this.animationManager.animateContinous(t,function(t){d.translateBy(t,t,[0,10])})},w.prototype.continousPanDown=function(){var t=this.get("view.viewpoint");this.animationManager.animateContinous(t,function(t){d.translateBy(t,t,[0,-10])})},w.prototype.stop=function(){this.pan.stopMomentumNavigation(),this.animationManager.stop(),this.end(),null!==this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=null,this._set("interacting",!1))},w.prototype._startTimer=function(t){var e=this;return null!==this._endTimer||(this._endTimer=setTimeout(function(){e._endTimer=null;var t=s()-e._lastEventTimestamp;t<250?e._endTimer=e._startTimer(t):e._set("interacting",!1)},t)),this._endTimer},w.prototype._getDefaultAnchor=function(){var t=this.view,e=t.size,i=t.padding,o=i.left,n=i.right,a=i.top,r=i.bottom;return _[0]=.5*(e[0]-n+o),_[1]=.5*(e[1]-r+a),_},w.prototype._zoomToScale=function(l,p){return void 0===p&&(p=this._getDefaultAnchor()),n(this,void 0,void 0,function(){var e,i,o,n,a,r,s,u;return h(this,function(t){return e=this.view,i=e.constraints,o=e.scale,n=e.viewpoint,a=e.size,r=e.padding,s=i.canZoomInTo(l),u=i.canZoomOutTo(l),l<o&&!s||o<l&&!u?[2]:[2,e.goTo(d.padAndScaleAndRotateBy(y,n,l/o,0,p,a,r),{animate:!0})]})})},w.prototype._scaleRotateTranslateViewpoint=function(t,e,i,o,n){var a=this.view,r=a.size,s=a.padding,u=a.constraints,l=a.scale,p=a.viewpoint,h=l*i,c=u.canZoomInTo(h),m=u.canZoomOutTo(h);return(i<1&&!c||1<i&&!m)&&(i=1),d.translateBy(p,p,n),d.padAndScaleAndRotateBy(t,p,i,o,e,r,s)},o([u.property()],w.prototype,"animationManager",void 0),o([u.property({type:Boolean,readOnly:!0})],w.prototype,"interacting",void 0),o([u.property()],w.prototype,"pan",void 0),o([u.property()],w.prototype,"pinch",void 0),o([u.property()],w.prototype,"rotate",void 0),o([u.property()],w.prototype,"view",void 0),o([u.property()],w.prototype,"zoomBox",void 0),o([u.subclass("esri.views.2d.navigation.MapViewNavigation")],w));function w(t){var e=f.call(this,t)||this;return e._endTimer=null,e.animationManager=null,e}e.default=g}.apply(null,o))||(t.exports=n)},2417:function(t,e,i){var o,n;o=[i.dj.c(t.i),e,i(1),i(0),i(13),i(15),i(2)],void 0===(n=function(t,e,i,o,n,u,a){var r,s="esri-zoom-box__container",l="esri-zoom-box__overlay",p="esri-zoom-box__overlay-background",h="esri-zoom-box__outline",c="Shift",m="Ctrl";return r=a.declared(n),i(d,r),d.prototype.destroy=function(){this.view=null},Object.defineProperty(d.prototype,"view",{set:function(t){var e=this;this._handles&&this._handles.forEach(function(t){t.remove()}),this._handles=null,this._destroyOverlay(),this._set("view",t),t&&(t.on("drag",[c],function(t){return e._handleDrag(t,1)}),t.on("drag",[c,m],function(t){return e._handleDrag(t,-1)}))},enumerable:!0,configurable:!0}),d.prototype._start=function(){this._createContainer(),this._createOverlay(),this.navigation.begin()},d.prototype._update=function(t,e,i,o){this._box.x=t,this._box.y=e,this._box.width=i,this._box.height=o,this._rafId||(this._rafId=requestAnimationFrame(this._redraw))},d.prototype._end=function(t,e,i,o,n){var a=this.view,r=a.toMap(u.createScreenPoint(t+.5*i,e+.5*o)),s=Math.max(i/a.width,o/a.height);-1===n&&(s=1/s),this._destroyOverlay(),this.navigation.end(),a.goTo({center:r,scale:a.scale*s})},d.prototype._updateBox=function(t,e,i,o){var n=this._boxShape;n.setAttributeNS(null,"x",""+t),n.setAttributeNS(null,"y",""+e),n.setAttributeNS(null,"width",""+i),n.setAttributeNS(null,"height",""+o),n.setAttributeNS(null,"class",h)},d.prototype._updateBackground=function(t,e,i,o){this._backgroundShape.setAttributeNS(null,"d",this._toSVGPath(t,e,i,o,this.view.width,this.view.height))},d.prototype._createContainer=function(){var t=document.createElement("div");t.className=s,this.view.root.appendChild(t),this._container=t},d.prototype._createOverlay=function(){var t=this.view.width,e=this.view.height,i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttributeNS(null,"d","M 0 0 L "+t+" 0 L "+t+" "+e+" L 0 "+e+" Z"),i.setAttributeNS(null,"class",p);var o=document.createElementNS("http://www.w3.org/2000/svg","rect"),n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),n.setAttributeNS(null,"class",l),n.appendChild(i),n.appendChild(o),this._container.appendChild(n),this._backgroundShape=i,this._boxShape=o,this._overlay=n},d.prototype._destroyOverlay=function(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container),this._container=this._backgroundShape=this._boxShape=this._overlay=null},d.prototype._toSVGPath=function(t,e,i,o,n,a){var r=t+i,s=e+o;return"M 0 0 L "+n+" 0 L "+n+" "+a+" L 0 "+a+" ZM "+t+" "+e+" L "+t+" "+s+" L "+r+" "+s+" L "+r+" "+e+" Z"},d.prototype._handleDrag=function(t,e){var i,o,n,a,r=t.x,s=t.y,u=t.origin.x,l=t.origin.y;switch(n=u<r?r-(i=u):u-(i=r),a=l<s?s-(o=l):l-(o=s),t.action){case"start":this._start();break;case"update":this._update(i,o,n,a);break;case"end":this._end(i,o,n,a,e)}t.stopPropagation()},d.prototype._redraw=function(){if(this._rafId&&(this._rafId=null,this._overlay)){var t=this._box,e=t.x,i=t.y,o=t.width,n=t.height;this._updateBox(e,i,o,n),this._updateBackground(e,i,o,n),this._rafId=requestAnimationFrame(this._redraw)}},o([a.property()],d.prototype,"navigation",void 0),o([a.property()],d.prototype,"view",null),o([a.subclass("esri.views.2d.navigation.ZoomBox")],d);function d(t){var e=r.call(this,t)||this;return e._container=null,e._overlay=null,e._backgroundShape=null,e._boxShape=null,e._box={x:0,y:0,width:0,height:0},e._redraw=e._redraw.bind(e),e}}.apply(null,o))||(t.exports=n)},2418:function(t,e,i){var o,n;o=[i.dj.c(t.i),e,i(1),i(0),i(28),i(163),i(13),i(15),i(2),i(118),i(150),i(129),i(2419)],void 0===(n=function(t,e,i,o,n,a,r,s,u,l,p,h,c){return d=u.declared(r),i(m,d),m.prototype.begin=function(t,e){this.navigation.begin(),this.momentumEstimator.reset(),this.addToEstimator(e),this.previousDrag=e},m.prototype.update=function(t,e){this.addToEstimator(e);var i=e.center.x,o=e.center.y,n=this.previousDrag;i=n?n.center.x-i:-i,o=n?o-n.center.y:o,t.viewpoint=h.translateBy(this.viewpoint,t.viewpoint,[i||0,o||0]),this.previousDrag=e},m.prototype.end=function(t,e){this.addToEstimator(e);var i=t.navigation.momentumEnabled;this.momentum=i?this.momentumEstimator.evaluateMomentum():null,this.animationTime=0,this.momentum&&this.onAnimationUpdate(t),this.previousDrag=null,this.navigation.end()},m.prototype.addToEstimator=function(t){var e=t.center.x,i=t.center.y,o=s.createScreenPointArray(-e,i),n=p.vec3f64.fromValues(-e,i,0);this.momentumEstimator.add(o,n,.001*t.timestamp)},m.prototype.onAnimationUpdate=function(n){var a=this;this.navigation.animationManager.animateContinous(n.viewpoint,function(t,e){a.momentumFinished=!a.momentum||a.momentum.isFinished(a.animationTime);var i=.001*e;if(!a.momentumFinished){var o=a.momentum.valueDelta(a.animationTime,i);l.vec3.scale(a.tmpMomentum,a.momentum.direction,o),n.viewpoint=h.translateBy(t,t,a.tmpMomentum)}a.animationTime+=i})},m.prototype.stopMomentumNavigation=function(){this.momentum&&(this.momentumEstimator.reset(),this.momentum=null,this.navigation.stop())},o([u.property()],m.prototype,"momentumFinished",void 0),o([u.property()],m.prototype,"viewpoint",void 0),o([u.property()],m.prototype,"navigation",void 0),o([u.subclass("esri.views.2d.navigation.actions.Pan")],m);function m(t){var e=d.call(this,t)||this;return e.animationTime=0,e.momentumEstimator=new c.PanPlanarMomentumEstimator(500,6,.92),e.momentum=null,e.tmpMomentum=p.vec3f64.create(),e.momentumFinished=!1,e.viewpoint=new a({targetGeometry:new n.Point,scale:0,rotation:0}),e.watch("momentumFinished",function(t){t&&e.navigation.stop()}),e}var d}.apply(null,o))||(t.exports=n)},2419:function(t,e,i){var o,n;o=[i.dj.c(t.i),e,i(11),i(118),i(150),i(1895),i(1801)],void 0===(n=function(t,e,i,a,o,n,r){Object.defineProperty(e,"__esModule",{value:!0});var s,u=(s=r.Momentum,i(l,s),l.prototype.value=function(t){return s.prototype.valueFromInitialVelocity.call(this,this.sceneVelocity,t)},l);function l(t,e,i,o,n){var a=s.call(this,t,e,i)||this;return a.sceneVelocity=o,a.direction=n,a}e.PanPlanarMomentum=u;var p=(h.prototype.add=function(t,e,i){if(this.enabled){if(this.time.hasLastValue&&this.time.computeDelta(i)<.015)return;this.screen[0].update(t[0]),this.screen[1].update(t[1]),this.scene[0].update(e[0]),this.scene[1].update(e[1]),this.scene[2].update(e[2]),this.time.update(i)}},h.prototype.reset=function(){this.screen[0].reset(),this.screen[1].reset(),this.scene[0].reset(),this.scene[1].reset(),this.scene[2].reset(),this.time.reset()},h.prototype.evaluateMomentum=function(){if(!this.enabled||!this.screen[0].hasFilteredDelta)return null;var t=this.screen[0].filteredDelta,e=this.screen[1].filteredDelta,i=Math.sqrt(t*t+e*e)/this.time.filteredDelta;return Math.abs(i)<this.minimumInitialVelocity?null:this.createMomentum(i,this.stopVelocity,this.friction)},h.prototype.createMomentum=function(t,e,i){a.vec3.set(this.tmpDirection,this.scene[0].filteredDelta,this.scene[1].filteredDelta,this.scene[2].filteredDelta);var o=a.vec3.length(this.tmpDirection);0<o&&a.vec3.scale(this.tmpDirection,this.tmpDirection,1/o);var n=o/this.time.filteredDelta;return new u(t,e,i,n,this.tmpDirection)},h);function h(t,e,i){void 0===t&&(t=300),void 0===e&&(e=12),void 0===i&&(i=.84),this.minimumInitialVelocity=t,this.stopVelocity=e,this.friction=i,this.enabled=!0,this.time=new n.FilteredFiniteDifference(.6),this.screen=[new n.FilteredFiniteDifference(.4),new n.FilteredFiniteDifference(.4)],this.scene=[new n.FilteredFiniteDifference(.6),new n.FilteredFiniteDifference(.6),new n.FilteredFiniteDifference(.6)],this.tmpDirection=o.vec3f64.create()}e.PanPlanarMomentumEstimator=p}.apply(null,o))||(t.exports=n)},2420:function(t,e,i){var o,n;o=[i.dj.c(t.i),e,i(1),i(0),i(28),i(163),i(13),i(2),i(48),i(127),i(129),i(2421),i(2422)],void 0===(n=function(t,e,i,o,n,a,r,s,v,f,y,u,l){return h=s.declared(r),i(p,h),p.prototype.begin=function(t,e){this.navigation.begin(),this._rotationMomentumEstimator.reset(),this._zoomMomentumEstimator.reset(),this._zoomOnly=null,this._previousAngle=this._startAngle=e.angle,this._previousRadius=this._startRadius=e.radius,this._previousCenter=e.center,this._updateTimestamp=null,t.constraints.rotationEnabled&&this.addToRotateEstimator(0,e.timestamp),this.addToZoomEstimator(e,1)},p.prototype.update=function(t,e){null===this._updateTimestamp&&(this._updateTimestamp=e.timestamp);var i=e.angle,o=e.radius,n=e.center,a=Math.abs(180*(i-this._startAngle)/Math.PI),r=Math.abs(o-this._startRadius),s=this._startRadius/o;if(this._previousRadius){var u=o/this._previousRadius,l=180*(i-this._previousAngle)/Math.PI;this._rotationDirection=0<=l?1:-1,this._zoomDirection=1<=u?1:-1,t.constraints.rotationEnabled?(null===this._zoomOnly&&200<e.timestamp-this._updateTimestamp&&(this._zoomOnly=0<r-a),null===this._zoomOnly||this._zoomOnly?l=0:this.addToRotateEstimator(i-this._startAngle,e.timestamp)):l=0,this.addToZoomEstimator(e,s),this.navigation.setViewpoint([n.x,n.y],1/u,l,[this._previousCenter.x-n.x,n.y-this._previousCenter.y])}this._previousAngle=i,this._previousRadius=o,this._previousCenter=n},p.prototype.end=function(t){this.rotateMomentum=this._rotationMomentumEstimator.evaluateMomentum(),this.zoomMomentum=this._zoomMomentumEstimator.evaluateMomentum(),this._animationTime=0,(this.rotateMomentum||this.zoomMomentum)&&this.onAnimationUpdate(t),this.navigation.end()},p.prototype.addToRotateEstimator=function(t,e){this._rotationMomentumEstimator.add(t,.001*e)},p.prototype.addToZoomEstimator=function(t,e){this._zoomMomentumEstimator.add(e,.001*t.timestamp)},p.prototype.canZoomIn=function(t){var e=t.scale,i=t.constraints.effectiveMaxScale;return 0===i||i<e},p.prototype.canZoomOut=function(t){var e=t.scale,i=t.constraints.effectiveMinScale;return 0===i||e<i},p.prototype.onAnimationUpdate=function(m){var d=this;this.navigation.animationManager.animateContinous(m.viewpoint,function(t,e){var i=!d.canZoomIn(m)&&1<d._zoomDirection||!d.canZoomOut(m)&&d._zoomDirection<1,o=!d.rotateMomentum||d.rotateMomentum.isFinished(d._animationTime),n=i||!d.zoomMomentum||d.zoomMomentum.isFinished(d._animationTime),a=.001*e;if(d._momentumFinished=o&&n,!d._momentumFinished){var r=d.rotateMomentum?Math.abs(d.rotateMomentum.valueDelta(d._animationTime,a))*d._rotationDirection*180/Math.PI:0,s=d.zoomMomentum?Math.abs(d.zoomMomentum.valueDelta(d._animationTime,a)):1,u=f.vec2f64.create(),l=f.vec2f64.create();if(d._previousCenter){v.vec2.set(u,d._previousCenter.x,d._previousCenter.y),y.getPaddingScreenTranslation(l,m.size,m.padding),v.vec2.add(u,u,l);var p=m.constraints,h=m.scale,c=h*s;s<1&&!p.canZoomInTo(c)?(s=h/p.effectiveMaxScale,d.zoomMomentum=null,d.rotateMomentum=null):1<s&&!p.canZoomOutTo(c)&&(s=h/p.effectiveMinScale,d.zoomMomentum=null,d.rotateMomentum=null),y.scaleAndRotateBy(t,m.viewpoint,s,r,u,m.size)}}d._animationTime+=a})},p.prototype.stopMomentumNavigation=function(){(this.rotateMomentum||this.zoomMomentum)&&(this.rotateMomentum&&(this._rotationMomentumEstimator.reset(),this.rotateMomentum=null),this.zoomMomentum&&(this._zoomMomentumEstimator.reset(),this.zoomMomentum=null),this.navigation.stop())},o([s.property()],p.prototype,"_momentumFinished",void 0),o([s.property()],p.prototype,"viewpoint",void 0),o([s.property()],p.prototype,"navigation",void 0),o([s.subclass("esri.views.2d.navigation.actions.Pinch")],p);function p(t){var e=h.call(this,t)||this;return e._animationTime=0,e._momentumFinished=!1,e._rotationMomentumEstimator=new u.RotationMomentumEstimator(.6,.15,.95),e._rotationDirection=1,e._zoomDirection=1,e._zoomMomentumEstimator=new l.ZoomMomentumEstimator,e._zoomOnly=null,e.zoomMomentum=null,e.rotateMomentum=null,e.viewpoint=new a({targetGeometry:new n.Point,scale:0,rotation:0}),e.watch("_momentumFinished",function(t){t&&e.navigation.stop()}),e}var h}.apply(null,o))||(t.exports=n)},2421:function(t,e,i){var o,n;o=[i.dj.c(t.i),e,i(11),i(1896)],void 0===(n=function(t,e,i,o){Object.defineProperty(e,"__esModule",{value:!0});var n,a=(n=o.MomentumEstimator,i(r,n),r.prototype.add=function(t,e){if(this.value.hasLastValue){for(var i=this.value.lastValue,o=t-i;o>Math.PI;)o-=2*Math.PI;for(;o<-Math.PI;)o+=2*Math.PI;t=i+o}n.prototype.add.call(this,t,e)},r);function r(t,e,i,o){return void 0===t&&(t=3),void 0===e&&(e=.01),void 0===i&&(i=.95),void 0===o&&(o=12),n.call(this,t,e,i,o)||this}e.RotationMomentumEstimator=a}.apply(null,o))||(t.exports=n)},2422:function(t,e,i){var o,n;o=[i.dj.c(t.i),e,i(11),i(1801),i(1896)],void 0===(n=function(t,e,i,o,n){Object.defineProperty(e,"__esModule",{value:!0});var a,r=(a=o.Momentum,i(s,a),s.prototype.value=function(t){var e=a.prototype.value.call(this,t);return Math.exp(e)},s.prototype.valueDelta=function(t,e){var i=a.prototype.value.call(this,t),o=a.prototype.value.call(this,t+e)-i;return Math.exp(o)},s);function s(t,e,i){return a.call(this,t,e,i)||this}e.ZoomMomentum=r;var u,l=(u=n.MomentumEstimator,i(p,u),p.prototype.add=function(t,e){u.prototype.add.call(this,Math.log(t),e)},p.prototype.createMomentum=function(t,e,i){return new r(t,e,i)},p);function p(t,e,i,o){return void 0===t&&(t=2.5),void 0===e&&(e=.01),void 0===i&&(i=.95),void 0===o&&(o=12),u.call(this,t,e,i,o)||this}e.ZoomMomentumEstimator=l}.apply(null,o))||(t.exports=n)},2423:function(t,e,i){var o,n;o=[i.dj.c(t.i),e,i(1),i(0),i(28),i(163),i(13),i(2),i(48),i(127),i(129)],void 0===(n=function(t,e,i,o,n,a,r,s,u,l,p){var h,c=l.vec2f64.create(),m=l.vec2f64.create();return h=s.declared(r),i(d,h),d.prototype.begin=function(t,e){this.navigation.begin(),u.vec2.set(this._previousCenter,e.center.x,e.center.y)},d.prototype.update=function(t,e){var i=t.state,o=i.size,n=i.padding;u.vec2.set(c,e.center.x,e.center.y),p.getAnchor(m,o,n),t.viewpoint=p.rotateBy(this.viewpoint,t.content.viewpoint,p.angleBetween(m,this._previousCenter,c)),u.vec2.copy(this._previousCenter,c)},d.prototype.end=function(){this.navigation.end()},o([s.property()],d.prototype,"viewpoint",void 0),o([s.property()],d.prototype,"navigation",void 0),o([s.subclass("esri.views.2d.actions.Rotate")],d);function d(t){var e=h.call(this,t)||this;return e._previousCenter=l.vec2f64.create(),e.viewpoint=new a({targetGeometry:new n.Point,scale:0,rotation:0}),e}}.apply(null,o))||(t.exports=n)},2424:function(t,e,i){var o,n;o=[i.dj.c(t.i),e,i(11),i(10),i(9),i(29),i(4),i(20),i(90)],void 0===(n=function(D,t,e,i,r,s,u,l,p){Object.defineProperty(t,"__esModule",{value:!0});var o,P=(l.enums.DataType,l.enums.Usage,l.enums.TextureSamplingMode,l.enums.TextureType,l.enums.TextureWrapMode,l.enums.PrimitiveType,l.enums.PixelFormat,l.enums.PixelType,p.enums.WGLDrawPhase),n=(o=p.DisplayObject,e(a,o),a.prototype.destroy=function(){this._readbackTexture&&(this._readbackTexture.dispose(),this._readbackTexture=null,this._maskTexture.dispose(),this._maskTexture=null,this._overlayTexture.dispose(),this._overlayTexture=null,this._vertexArrayObject.dispose(),this._vertexArrayObject=null,this._program.dispose(),this._program=null,this._resourcesPromise=null)},Object.defineProperty(a.prototype,"magnifier",{get:function(){return this._magnifier},set:function(t){var e=this;this._magnifier=t,this._handle&&this._handle.remove(),this._handle=t.watch("version",function(){e.visible=t.visible}),this.visible=t.visible},enumerable:!0,configurable:!0}),a.prototype.doRender=function(t){var e=this.stage.context;if(this._resourcesPromise){if(t.drawPhase===P.MAP&&this._canRender()){this._updateResources(e);var i=this._magnifier,o=1/i.factor,n=Math.ceil(o*this.overlay.width),a=Math.ceil(o*this.overlay.height),r=t.state.size,s=t.pixelRatio,u=s*r[0],l=s*r[1],p=i.position||{x:.5*r[0],y:.5*r[1]},h=s*p.x,c=l-s*p.y,m=.5*n,d=.5*a;h<m?h=m:u-m<=h&&(h=u-m-1),c<d?c=d:l-d<=c&&(c=l-d-1);var v=h-m,f=c-d,y=this._readbackTexture;e.bindTexture(y,0),e.gl.copyTexImage2D(y.descriptor.target,0,y.descriptor.pixelFormat,v,f,n,a,0);var _=this.stage.background&&this.stage.background.color,g=_?[_.a*_.r/255,_.a*_.g/255,_.a*_.b/255,_.a]:[1,1,1,1],w=(h+i.offsetX)/u*2-1,M=(c-i.offsetY)/l*2-1,b=this.overlay.width/u*2,T=this.overlay.height/l*2,x=this._program;e.bindVAO(this._vertexArrayObject),e.bindTexture(this._overlayTexture,6),e.bindTexture(this._maskTexture,7),e.bindProgram(x),x.setUniform4fv("u_background",g),x.setUniform1i("u_readbackTexture",0),x.setUniform1i("u_overlyTexture",6),x.setUniform1i("u_maskTexture",7),x.setUniform2f("u_drawPos",w,M),x.setUniform1f("u_width",b),x.setUniform1f("u_height",T),e.setStencilTestEnabled(!1),e.drawArrays(5,0,4),e.bindVAO()}}else this._resourcesPromise=this._loadResources(D.toUrl("../../../images/magnifier/mask.png"),D.toUrl("../../../images/magnifier/overlay.png"))},a.prototype._canRender=function(){return this.mask&&this.overlay&&null!=this._magnifier},a.prototype._loadResources=function(n,a){return i(this,void 0,void 0,function(){var e,i,o;return r(this,function(t){switch(t.label){case 0:return[4,u.all([s(n,{responseType:"image"}),s(a,{responseType:"image"})])];case 1:return e=t.sent(),i=e[0].data,o=e[1].data,this.mask=i,this.overlay=o,this.requestRender(),[2]}})})},a.prototype._updateResources=function(t){if(!this._readbackTexture){var e=1/this._magnifier.factor,i=Math.ceil(e*this.overlay.width),o=Math.ceil(e*this.overlay.height);this._program=p.createMagnifierProgram(t);var n=new Uint16Array([0,1,0,0,1,1,1,0]),a=p.magnifier.attributes;this._vertexArrayObject=new l.VertexArrayObject(t,a,{geometry:[{name:"a_pos",count:2,type:5123,offset:0,stride:4,normalized:!1,divisor:0}]},{geometry:l.BufferObject.createVertex(t,35044,n)}),this._overlayTexture=new l.Texture(t,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9728,flipped:!0},this.overlay),this._maskTexture=new l.Texture(t,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9728,flipped:!0},this.mask),this._readbackTexture=new l.Texture(t,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:i,height:o})}},a);function a(){var t=o.call(this)||this;return t.visible=!1,t}t.default=n}.apply(null,o))||(t.exports=n)}}]);