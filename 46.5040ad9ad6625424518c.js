(function(){(this||window).webpackJsonp.registerAbsMids({"esri/views/2d/layers/WMSLayerView2D":1619,"esri/views/layers/support/ClipArea":1627,"esri/views/layers/LayerView":1635,"esri/views/2d/layers/LayerView2D":1636,"esri/views/layers/support/ClipRect":1637,"esri/views/layers/support/Geometry":1638,"esri/views/layers/support/Path":1639,"esri/views/2d/layers/BitmapLayerView2D":1688,"esri/views/2d/layers/support/ExportStrategy":1689,"esri/views/2d/viewStateUtils":1690,"esri/layers/support/wmsUtils":1769,"esri/layers/support/ExportWMSImageParameters":1829,"esri/views/layers/WMSLayerView":2576})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{1619:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(5),r(1),r(0),r(9),r(10),r(3),r(4),r(2),r(37),r(1829),r(1688),r(1636),r(1689),r(1635),r(496),r(2576)],void 0===(n=function(e,t,n,r,i,a,o,s,p,l,h,u,d,c,y,f,v,m){var g,b=s.getLogger("esri.views.2d.layers.WMSLayerView2D");return g=l.declared(m.WMSLayerView(v.RefreshableLayerView(d.BitmapLayerView2D(c.LayerView2D(f))))),r(x,g),x.prototype.hitTest=function(){return null},x.prototype.update=function(e){this.strategy.update(e).catch(function(e){p.isAbortError(e)||b.error(e)})},x.prototype.attach=function(){var t=this,e=this.layer,r=this.view,i=e.imageMaxHeight,n=e.imageMaxWidth;this.strategy=new y({container:this.container,fetchSource:this.fetchImage.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxHeight:i,imageMaxWidth:n,imageRotationSupported:!1,imageNormalizationSupported:!1,hidpi:!1}),this._exportWMSImageParameters=new u({layer:e,view:r}),this.handles.add(this._exportWMSImageParameters.watch("version",function(e){t._exportImageVersion!==e&&(t._exportImageVersion=e,t.requestUpdate())}),"wms")},x.prototype.detach=function(){this.handles.remove("wms"),this.container.removeAllChildren(),this.strategy.destroy(),this._exportWMSImageParameters.layer=null,this._exportWMSImageParameters.destroy(),this._exportWMSImageParameters=null,this.container.removeAllChildren()},x.prototype.moveStart=function(){},x.prototype.viewChange=function(){},x.prototype.moveEnd=function(){this.requestUpdate()},x.prototype.canResume=function(){var e=this.inherited(arguments);return e?this.layer.supportsSpatialReference(this.view.spatialReference):e},x.prototype.createFetchPopupFeaturesQuery=function(e){var t=this.container,r=this.view,p=e.x,l=e.y,u=r.spatialReference,d=null,c=0,y=0;t.children.some(function(e){var t=e.width,r=e.height,i=e.resolution,n=e.x,a=e.y,o=n+i*t,s=a-i*r;return n<=p&&p<=o&&l<=a&&s<=l&&(d=new h({xmin:n,ymin:s,xmax:o,ymax:a,spatialReference:u}),c=t,y=r,!0)});var i=d.width/c,n=Math.round((p-d.xmin)/i),a=Math.round((d.ymax-l)/i);return{extent:d,width:c,height:y,x:n,y:a}},x.prototype.doRefresh=function(){return o(this,void 0,void 0,function(){return a(this,function(e){return this.requestUpdate(),[2]})})},x.prototype.isUpdating=function(){return this.attached&&(this.strategy.updating||this.updateRequested)},x.prototype.fetchImage=function(e,t,r,i){return this.layer.fetchImage(e,t,r,n({timestamp:this.refreshTimestamp},i))},i([l.property()],x.prototype,"strategy",void 0),i([l.property({dependsOn:["view.spatialReference","layer.spatialReferences"]})],x.prototype,"suspended",void 0),i([l.property({dependsOn:["strategy.updating"]})],x.prototype,"updating",void 0),i([l.subclass("esri.views.2d.layers.WMSLayerView2D")],x);function x(){return null!==g&&g.apply(this,arguments)||this}}.apply(null,i))||(e.exports=n)},1627:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(0),r(1),r(7),r(2)],void 0===(n=function(e,t,r,i,n,a){return s=a.declared(n.JSONSupport),i(o,s),r([a.subclass("esri.views.layers.support.ClipArea")],o);function o(){return null!==s&&s.apply(this,arguments)||this}var s}.apply(null,i))||(e.exports=n)},1635:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1),r(0),r(13),r(54),r(206),r(121),r(3),r(119),r(2)],void 0===(n=function(e,t,r,i,n,a,o,s,p,l,u){return c=u.declared(o.HandleOwnerMixin(s.IdentifiableMixin(l.EsriPromiseMixin(a.EventedMixin(n))))),r(d,c),d.prototype.initialize=function(){var i=this;this.addResolvingPromise(this.layer),this.when().catch(function(e){if("layerview:create-error"!==e.name){var t=i.layer&&i.layer.id||"no id",r=i.layer&&i.layer.title||"no title";throw p.getLogger(i.declaredClass).error("#resolve()","Failed to resolve layer view (layer title: '"+r+"', id: '"+t+"')",e),e}})},d.prototype.destroy=function(){this.layer=this.parent=null},Object.defineProperty(d.prototype,"fullOpacity",{get:function(){function e(e){return null==e?1:e}return e(this.get("layer.opacity"))*e(this.get("parent.fullOpacity"))},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"suspended",{get:function(){return!this.canResume()},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"updating",{get:function(){return!!(this.updatingHandles&&this.updatingHandles.updating||this.isUpdating())},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"visible",{get:function(){return!0===this.get("layer.visible")},set:function(e){void 0!==e?this._override("visible",e):this._clearOverride("visible")},enumerable:!0,configurable:!0}),d.prototype.canResume=function(){return!this.get("parent.suspended")&&this.get("view.ready")&&this.get("layer.loaded")&&this.visible||!1},d.prototype.isUpdating=function(){return!1},i([u.property({dependsOn:["layer.opacity","parent.fullOpacity"]})],d.prototype,"fullOpacity",null),i([u.property()],d.prototype,"layer",void 0),i([u.property()],d.prototype,"parent",void 0),i([u.property({readOnly:!0,dependsOn:["visible","layer.loaded","parent.suspended"]})],d.prototype,"suspended",null),i([u.property({type:Boolean,dependsOn:["updatingHandles.updating"],readOnly:!0})],d.prototype,"updating",null),i([u.property({dependsOn:["layer.visible"]})],d.prototype,"visible",null),i([u.subclass("esri.views.layers.LayerView")],d);function d(e){var t=c.call(this,e)||this;return t.layer=null,t.parent=null,t}var c}.apply(null,i))||(e.exports=n)},1636:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1),r(0),r(18),r(123),r(16),r(2),r(1627),r(1637),r(1638),r(1639)],void 0===(n=function(e,t,i,n,r,a,o,s,p,l,u,d){Object.defineProperty(t,"__esModule",{value:!0});var c=r.ofType({key:"type",base:p,typeMap:{rect:l,path:d,geometry:u}});t.LayerView2D=function(e){return r=s.declared(e),i(t,r),t.prototype.initialize=function(){var t=this;function e(){return t.notifyChange("rendering")}this.when(function(){t.requestUpdate()},function(){}),this.handles.add([o.init(this,"suspended",function(e){t.container&&(t.container.visible=!e),t.view&&!e&&t.updateRequested&&t.view.requestLayerViewUpdate(t)},!0),o.init(this,["fullOpacity","container"],function(){t.container&&(t.container.opacity=t.fullOpacity)},!0),o.on(this,"container","post-render",e),o.on(this,"container","will-render",e)])},t.prototype.destroy=function(){this.attached&&(this.attached=!1,this.detach()),this.handles.remove("initialize"),this.updateRequested=!1,this.layer=null,this.view=null},Object.defineProperty(t.prototype,"rendering",{get:function(){return this.attached&&!this.suspended&&(this.moving||this.container.renderRequested||this.isRendering())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return!this.suspended&&(!this.attached||this.updateRequested||this.isUpdating())},enumerable:!0,configurable:!0}),t.prototype.isVisibleAtScale=function(e){var t=!0,r=this.layer,i=r.minScale,n=r.maxScale;if(null!=i&&null!=n){var a=!i,o=!n;!a&&e<=i&&(a=!0),!o&&n<=e&&(o=!0),t=a&&o}return t},t.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestLayerViewUpdate(this))},t.prototype.processUpdate=function(e){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",e),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(e))):this.updateRequested=!1},t.prototype.isUpdating=function(){return!1},t.prototype.isRendering=function(){return!1},t.prototype.canResume=function(){var e=this.inherited(arguments);return e=e&&this.isVisibleAtScale(this.view.scale)},n([s.property({type:c,set:function(e){var t=a.referenceSetter(e,this._get("clips"),c);this._set("clips",t)}})],t.prototype,"clips",void 0),n([s.property()],t.prototype,"moving",void 0),n([s.property({dependsOn:["attached","suspended","moving"]})],t.prototype,"rendering",null),n([s.property()],t.prototype,"attached",void 0),n([s.property()],t.prototype,"container",void 0),n([s.property({dependsOn:["view.scale","layer.minScale","layer.maxScale"]})],t.prototype,"suspended",void 0),n([s.property({readOnly:!0})],t.prototype,"updateParameters",void 0),n([s.property()],t.prototype,"updateRequested",void 0),n([s.property({dependsOn:["updateRequested","attached","suspended"]})],t.prototype,"updating",null),n([s.property()],t.prototype,"view",void 0),n([s.subclass("esri.views.2d.layers.LayerView2D")],t);function t(){var e=null!==r&&r.apply(this,arguments)||this;return e.clips=new c,e.moving=!1,e.attached=!1,e.lastUpdateId=-1,e.updateRequested=!1,e}var r}}.apply(null,i))||(e.exports=n)},1637:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(0),r(1),r(2),r(1627)],void 0===(n=function(e,t,r,i,n,a){return s=n.declared(a),i(o,s),(p=o).prototype.clone=function(){return new p({left:this.left,right:this.right,top:this.top,bottom:this.bottom})},Object.defineProperty(o.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0}),r([n.property({type:[Number,String],json:{write:!0}})],o.prototype,"left",void 0),r([n.property({type:[Number,String],json:{write:!0}})],o.prototype,"right",void 0),r([n.property({type:[Number,String],json:{write:!0}})],o.prototype,"top",void 0),r([n.property({type:[Number,String],json:{write:!0}})],o.prototype,"bottom",void 0),r([n.property({readOnly:!0,dependsOn:["left","right","top","bottom"]})],o.prototype,"version",null),p=r([n.subclass("esri.views.layers.support.ClipRect")],o);function o(){var e=null!==s&&s.apply(this,arguments)||this;return e.type="rect",e.left=null,e.right=null,e.top=null,e.bottom=null,e}var s,p}.apply(null,i))||(e.exports=n)},1638:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(0),r(1),r(28),r(2),r(81),r(38),r(1627)],void 0===(n=function(e,t,r,i,n,a,o,s,p){var l,u,d={base:o,key:"type",typeMap:{extent:n.Extent,polygon:n.Polygon}};return l=a.declared(p),i(c,l),u=c,Object.defineProperty(c.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0}),c.prototype.clone=function(){return new u({geometry:this.geometry.clone()})},r([a.property({types:d,json:{read:s.fromJSON,write:!0}})],c.prototype,"geometry",void 0),r([a.property({readOnly:!0,dependsOn:["geometry"]})],c.prototype,"version",null),u=r([a.subclass("esri.views.layers.support.Geometry")],c);function c(){var e=null!==l&&l.apply(this,arguments)||this;return e.type="geometry",e.geometry=null,e}}.apply(null,i))||(e.exports=n)},1639:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(0),r(1),r(2),r(1627)],void 0===(n=function(e,t,r,i,n,a){return s=n.declared(a),i(o,s),Object.defineProperty(o.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0}),r([n.property({type:[[[Number]]],json:{write:!0}})],o.prototype,"path",void 0),r([n.property({readOnly:!0,dependsOn:["path"]})],o.prototype,"version",null),r([n.subclass("esri.views.layers.support.Path")],o);function o(){var e=null!==s&&s.apply(this,arguments)||this;return e.type="path",e.path=[],e}var s}.apply(null,i))||(e.exports=n)},1688:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(0),r(1),r(2),r(508)],void 0===(n=function(e,t,i,n,a,o){Object.defineProperty(t,"__esModule",{value:!0}),t.BitmapLayerView2D=function(e){return r=a.declared(e),n(t,r),t.prototype.initialize=function(){var e=this;this.handles.add(this.clips.on("change",function(){return e.container.setClips(e.clips)}))},i([a.subclass("esri.views.2d.layers.BitmapLayerView2D")],t);function t(){var e=null!==r&&r.apply(this,arguments)||this;return e.container=new o.BitmapContainer(e.clips),e}var r}}.apply(null,i))||(e.exports=n)},1689:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(5),r(9),r(10),r(1),r(0),r(13),r(4),r(2),r(37),r(80),r(55),r(92),r(90),r(1690),r(495),r(102)],void 0===(n=function(e,t,r,y,i,n,a,o,h,s,f,p,v,m,l,g,b,u){var d,x=p.create(),w=[0,0],S=new u(0,0,0,0),c=2048,O=2048,M=!1,N=!1,R=!1;return d=s.declared(o),n(_,d),_.prototype.destroy=function(){},Object.defineProperty(_.prototype,"updating",{get:function(){return null!==this._imagePromise},enumerable:!0,configurable:!0}),_.prototype.updateExports=function(e){for(var t=0,r=this.container.children;t<r.length;t++){var i=r[t];if(!i.visible||!i.attached)return;e(i)?console.error("ExportStrategy.updateExports doesn't support promise yet"):(i.invalidateTexture(),i.requestRender())}},_.prototype._export=function(r,i,e,n,a,t){var o=this;return h.resolve().then(function(){return o.fetchSource(r,Math.floor(i*a),Math.floor(e*a),{rotation:n,pixelRatio:a,signal:t})}).then(function(e){var t=new l.Bitmap(e);return t.x=r.xmin,t.y=r.ymax,t.resolution=r.width/i,t.rotation=n,t.pixelRatio=a,t})},_.prototype._singleExport=function(e,t,r,i,n){g.getBBox(x,e.center,e.resolution,t);var a=new f(x[0],x[1],x[2],x[3],e.spatialReference);return this._export(a,t[0],t[1],r,i,n).then(function(e){return[e]})},_.prototype._tiledExport=function(a,o,s,p,l){var u=this,e=m.create({size:o,spatialReference:a.spatialReference,scales:[a.scale]}),d=new b(e),t=d.getTileCoverage(a);if(!t)return null;var c=[];return t.forEach(function(e,t,r,i){S.set(e,t,r,i),d.getTileBounds(x,S);var n=new f(x[0],x[1],x[2],x[3],a.spatialReference);c.push(u._export(n,o,o,s,p,l))}),h.all(c)},a([s.property()],_.prototype,"_imagePromise",void 0),a([s.property()],_.prototype,"container",void 0),a([s.property()],_.prototype,"disposeSource",void 0),a([s.property()],_.prototype,"fetchSource",void 0),a([s.property()],_.prototype,"hidpi",void 0),a([s.property()],_.prototype,"imageMaxWidth",void 0),a([s.property()],_.prototype,"imageMaxHeight",void 0),a([s.property()],_.prototype,"imageRotationSupported",void 0),a([s.property()],_.prototype,"imageNormalizationSupported",void 0),a([s.property()],_.prototype,"requestUpdate",void 0),a([s.property({dependsOn:["_imagePromise"]})],_.prototype,"updating",null),a([s.subclass("esri.views.2d.layers.support.ExportStrategy")],_);function _(e){var t=d.call(this,e)||this;return t._imagePromise=null,t.hidpi=R,t.imageMaxWidth=c,t.imageMaxHeight=O,t.imageRotationSupported=M,t.imageNormalizationSupported=N,t.update=h.debounce(function(d,c){return i(t,void 0,void 0,function(){var t,r,i,n,a,o,s,p,l,u=this;return y(this,function(e){return t=d.state,r=v.getInfo(t.spatialReference),i=this.hidpi?d.pixelRatio:1,!d.stationary||this.destroyed?[2]:(this.imageRotationSupported?(w[0]=t.size[0],w[1]=t.size[1]):g.getOuterSize(w,t),n=Math.floor(w[0]*i)>this.imageMaxWidth||Math.floor(w[1]*i)>this.imageMaxHeight,a=r&&(t.extent.xmin<r.valid[0]||t.extent.xmax>r.valid[1]),o=!this.imageNormalizationSupported&&a,s=!n&&!o,p=this.imageRotationSupported?t.rotation:0,s?this._imagePromise=this._singleExport(t,w,p,i,c):(l=Math.min(this.imageMaxWidth,this.imageMaxHeight),o&&(l=Math.min(t.worldScreenWidth,l)),this._imagePromise=this._tiledExport(t,l,p,i,c)),[2,this._imagePromise.then(function(e){u._imagePromise=null;var t=u.container.children.slice();u.container.removeAllChildren(),e.forEach(u.container.addChild,u.container),u.disposeSource&&t.forEach(function(e){u.disposeSource(e.source)},u)}).catch(function(e){throw u._imagePromise=null,e})])})})},5e3),t}}.apply(null,i))||(e.exports=n)},1690:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var p=Math.PI/180;t.snapToPixel=function(e,t,r){var i=r.resolution,n=r.size;return e[0]=i*(Math.round(t[0]/i)+n[0]%2*.5),e[1]=i*(Math.round(t[1]/i)+n[1]%2*.5),e},t.getOuterSize=function(e,t){var r=t.rotation*p,i=Math.abs(Math.cos(r)),n=Math.abs(Math.sin(r)),a=t.size,o=a[0],s=a[1];return e[0]=Math.round(s*n+o*i),e[1]=Math.round(s*i+o*n),e},t.getBBox=function(e,t,r,i){var n=t[0],a=t[1],o=i[0],s=i[1],p=.5*r;return e[0]=n-p*o,e[1]=a-p*s,e[2]=n+p*o,e[3]=a+p*s,e},t.bboxIntersects=function(e,t){var r=e[0],i=e[1],n=e[2],a=e[3],o=t[0],s=t[1],p=t[2],l=t[3];return!(p<r||n<o||l<i||a<s)}}.apply(null,i))||(e.exports=n)},1769:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(6),r(22),r(37),r(31)],void 0===(n=function(e,t,P,u,L,c){function y(i){return r.some(function(e){var t=e[0],r=e[1];return t<=i&&i<=r})}function j(e,t){var r=t&&t.getElementsByTagName(e);return r&&0<r.length?r[0]:null}function A(e,t,r){var i=j(e,t);return i?i.textContent:r}function h(e,t,r){if(!e)return null;var i,n,a,o,s=parseFloat(e.getAttribute("minx")),p=parseFloat(e.getAttribute("miny")),l=parseFloat(e.getAttribute("maxx")),u=parseFloat(e.getAttribute("maxy"));o=r?(i=isNaN(p)?-Number.MAX_VALUE:p,n=isNaN(s)?-Number.MAX_VALUE:s,a=isNaN(u)?Number.MAX_VALUE:u,isNaN(l)?Number.MAX_VALUE:l):(i=isNaN(s)?-Number.MAX_VALUE:s,n=isNaN(p)?-Number.MAX_VALUE:p,a=isNaN(l)?Number.MAX_VALUE:l,isNaN(u)?Number.MAX_VALUE:u);var d=new c({wkid:t});return new L({xmin:i,ymin:n,xmax:a,ymax:o,spatialReference:d})}function q(e,t){var r,i,n,a=j(t,e),o=j("DCPType",a);if(o){var s=j("HTTP",o);if(s){var p=j("Get",s);if(p){var l=(r="xlink:href",i=null,(n=j("OnlineResource",p))?n.getAttribute(r):i);if(l)return l.indexOf("&")===l.length-1&&(l=l.substring(0,l.length-1)),function(e,t){var r=[],i=u.urlToObject(e);for(var n in i.query)i.query.hasOwnProperty(n)&&-1===t.indexOf(n.toLowerCase())&&r.push(n+"="+i.query[n]);return i.path+(r.length?"?"+r.join("&"):"")}(l,["service","request"])}}}return null}function C(e,r){var t=e.getElementsByTagName("Operation");if(!t||!t.length){var i=j(r,e).getElementsByTagName("Format");return Array.prototype.slice.call(i).map(function(e){return e.textContent})}var n=Array.prototype.slice.call(t),a=[];return n.forEach(function(e){if(e.getAttribute("name")===r){var t=e.getElementsByTagName("Format");Array.prototype.slice.call(t).forEach(function(e){a.push(e.textContent)})}}),a}function i(e,t,r){var i=function(e,t){for(var r=0;r<t.childNodes.length;r++){var i=t.childNodes[r];if(i.nodeType===Node.ELEMENT_NODE&&i.nodeName===e)return i}return null}(t,e);if(!i)return r;var n=i.textContent;if(null==n||""===n)return r;var a=Number(n);return isNaN(a)?r:a}function I(e,p){if(!e)return null;var l={id:U++,fullExtents:[],parentLayerId:null,queryable:"1"===e.getAttribute("queryable"),spatialReferences:[],sublayers:null},t=j("LatLonBoundingBox",e),r=j("EX_GeographicBoundingBox",e),u=null;t&&(u=h(t,4326)),r&&((u=new L(0,0,0,0,new c({wkid:4326}))).xmin=parseFloat(A("westBoundLongitude",r,0)),u.ymin=parseFloat(A("southBoundLatitude",r,0)),u.xmax=parseFloat(A("eastBoundLongitude",r,0)),u.ymax=parseFloat(A("northBoundLatitude",r,0))),t||r||(u=new L(-180,-90,180,90,new c({wkid:4326}))),l.minScale=i(e,"MaxScaleDenominator",0),l.maxScale=i(e,"MinScaleDenominator",0);var d=-1<["1.0.0","1.1.0","1.1.1"].indexOf(p)?"SRS":"CRS";return Array.prototype.slice.call(e.childNodes).forEach(function(e){if("Name"===e.nodeName)l.name=e.textContent||"";else if("Title"===e.nodeName)l.title=e.textContent||"";else if("Abstract"===e.nodeName)l.description=e.textContent||"";else if("BoundingBox"===e.nodeName){var t=e.getAttribute(d);if(t&&0===t.indexOf("EPSG:"))0===(i=parseInt(t.substring(5),10))||isNaN(i)||u||(u="1.3.0"===p?h(e,i,y(i)):h(e,i));var r=t&&t.indexOf(":");if(r&&-1<r){var i;0===(i=parseInt(t.substring(r+1,t.length),10))||isNaN(i)||(i=f[i]?f[i]:i);var n="1.3.0"===p?h(e,i,y(i)):h(e,i);l.fullExtents.push(n)}}else if(e.nodeName===d){e.textContent.split(" ").forEach(function(e){0===(e=-1<e.indexOf(":")?parseInt(e.split(":")[1],10):parseInt(e,10))||isNaN(e)||(f[e]&&(e=f[e]),-1===l.spatialReferences.indexOf(e)&&l.spatialReferences.push(e))})}else if("Style"!==e.nodeName||l.legendURL){if("Layer"===e.nodeName){var a=I(e,p);a&&(a.parentLayerId=l.id,l.sublayers||(l.sublayers=[]),l.sublayers.push(a))}}else{var o=j("LegendURL",e);if(o){var s=j("OnlineResource",o);s&&(l.legendURL=s.getAttribute("xlink:href"))}}}),l.extent=u&&u.toJSON(),l}Object.defineProperty(t,"__esModule",{value:!0});var U,r=[[4001,4999],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3416,3416],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]],f={84:4326,83:4269,27:4267};t.parseCapabilities=function(e){if(e){U=-1,"string"==typeof e&&(e=(new DOMParser).parseFromString(e,"text/xml"));var t=e.documentElement;if("ServiceExceptionReport"===t.nodeName){var r=Array.prototype.slice.call(t.childNodes).map(function(e){return e.textContent}).join("\r\n");throw new P("wmslayer:wms-capabilities-xml-is-not-valid","The server returned errors when the WMS capabilities were requested.",r)}var i=j("Layer",t);if(i){var n,a="WMS_Capabilities"===t.nodeName||"WMT_MS_Capabilities"===t.nodeName?t.getAttribute("version"):"1.3.0",o=j("Service",t),s=A("Title",o,"")||A("Name",o,""),p=A("AccessConstraints",o,""),l=A("Abstract",o,""),u=parseInt(A("MaxWidth",o,5e3),10),d=parseInt(A("MaxHeight",o,5e3),10),c=j("Capability",t),y=C(t,"GetMap"),h=q(t,"GetMap"),f=I(i,a),v=0;if(Array.prototype.slice.call(c.childNodes).forEach(function(e){"Layer"===e.nodeName&&(0===v?n=e:(1===v&&f.name&&(f.name="",f.sublayers.push(I(n,a))),f.sublayers.push(I(e,a))),v++)}),!f)return null;var m,g,b,x=f.fullExtents;if(0===(m=(m=f.sublayers)||[]).length&&m.push(f),!(g=f.extent)){var w=new L(m[0].extent);f.extent=w.toJSON(),g=f.extent}if(!(b=f.spatialReferences).length&&0<m.length){var S=function(e){var t=[];return e.sublayers.forEach(function(e){!t.length&&e.spatialReferences.length&&(t=e.spatialReferences||S(e))}),t};m.forEach(function(e){b.length||(b=e.spatialReferences||S(e))})}var O,M=q(t,"GetFeatureInfo");if(M){var N=C(t,"GetFeatureInfo");-1<N.indexOf("text/html")?O="text/html":-1<N.indexOf("text/plain")&&(O="text/plain")}if(!O){var R=function(e){e&&(e.queryable=!1,e.sublayers&&e.sublayers.forEach(function(e){R(e)}))};R(f)}var _=function t(e){var r=[];return e.forEach(function(e){r.push(e),e.sublayers&&e.sublayers.length&&(r=r.concat(t(e.sublayers)),delete e.sublayers)}),r}(m),E=f.minScale||0;return{copyright:p,description:l,extent:g,fullExtents:x,featureInfoFormat:O,featureInfoUrl:M,mapUrl:h,maxImageWidth:u,maxImageHeight:d,maxScale:f.maxScale||0,minScale:E,layers:_,spatialReferences:b,supportedImageFormatTypes:y,title:s,version:a}}}},t.coordsReversed=y,t.getPopupLayers=function(e){return e.length?e.filter(function(e){return e.popupEnabled&&e.name&&e.queryable}).map(function(e){return e.name}).join(","):""}}.apply(null,i))||(e.exports=n)},1829:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(5),r(1),r(0),r(13),r(23),r(2),r(1769)],void 0===(n=function(e,t,y,r,i,n,a,o,h){var s,p={visible:"visibleSublayers"},l=[102100,3857,102113,900913],u=[3395,54004];return s=o.declared(n),r(d,s),Object.defineProperty(d.prototype,"layer",{set:function(e){var t=this;this._get("layer")!==e&&(this._set("layer",e),this._layerHandles&&(this._layerHandles.removeAll(),this._layerHandles=null),e&&(this._layerHandles||(this._layerHandles=new a),this._layerHandles.add([e.sublayers.on("change",function(){return t.notifyChange("visibleSublayers")}),e.on("wms-sublayer-update",function(e){return t.notifyChange(p[e.propertyName])})])))},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"layers",{get:function(){return this.visibleSublayers.filter(function(e){return e.name}).map(function(e){return e.name}).join(",")},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"scale",{get:function(){return null!=this._scale?this._scale:this.view&&this.view.scale||0},set:function(e){this.view||(this._scale=e,this.notifyChange("scale"))},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"visibleSublayers",{get:function(){var e=this.layer,n=this.scale,t=e.sublayers,a=[],o=function(e){var t=e.minScale,r=e.maxScale,i=e.sublayers;e.visible&&(0===n||(0===t||n<=t)&&(0===r||r<=n))&&(a.unshift(e),i&&i.forEach(o))};return t&&t.forEach(o),a},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"wkid",{get:function(){var e=this.extent,t=this.layer.spatialReferences,r=e.spatialReference&&e.spatialReference.wkid;t&&-1===t.indexOf(r)&&e.spatialReference.latestWkid&&(r=e.spatialReference.latestWkid);var i=l.some(function(e){return e===r});if(!t)return r;if(i){var n=[];t.forEach(function(e){-1<l.indexOf(e)&&n.push(e)}),n.length||t.forEach(function(e){-1<u.indexOf(e)&&n.push(e)}),r=0<n.length?n[0]:l[0]}return r},enumerable:!0,configurable:!0}),d.prototype.toJSON=function(){var e=this.extent,t=this.layer,r=this.layers,i=t.imageFormat,n=t.imageTransparency,a=t.spatialReferences,o=t.version,s=this.wkid;a&&-1===a.indexOf(s)&&e.spatialReference.latestWkid&&(s=e.spatialReference.latestWkid);var p=e.xmin,l=e.ymin,u=e.xmax,d=e.ymax,c={bbox:"1.3.0"===t.version&&h.coordsReversed(s)?l+","+p+","+d+","+u:p+","+l+","+u+","+d,format:i,request:"GetMap",service:"WMS",styles:"",transparent:n,version:o};return isNaN(s)||("1.3.0"===o?c.crs="EPSG:"+s:c.srs="EPSG:"+s),y({},c,{layers:r})},i([o.property()],d.prototype,"extent",void 0),i([o.property()],d.prototype,"layer",null),i([o.property({readOnly:!0,dependsOn:["visibleSublayers"]})],d.prototype,"layers",null),i([o.property({type:Number,dependsOn:["view.scale"]})],d.prototype,"scale",null),i([o.property()],d.prototype,"view",void 0),i([o.property({dependsOn:["layers","layer.imageTransparency"],readOnly:!0})],d.prototype,"version",null),i([o.property({readOnly:!0,dependsOn:["layer.sublayers","scale"]})],d.prototype,"visibleSublayers",null),i([o.property()],d.prototype,"wkid",null),i([o.subclass("esri.layers.support.ExportWMSImageParameters")],d);function d(){var e=null!==s&&s.apply(this,arguments)||this;return e._layerHandles=new a,e.extent=null,e._scale=null,e.view=null,e}}.apply(null,i))||(e.exports=n)},2576:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1),r(0),r(9),r(10),r(6),r(4),r(2)],void 0===(n=function(e,t,i,n,d,a,c,y,o){Object.defineProperty(t,"__esModule",{value:!0}),t.WMSLayerView=function(e){return r=o.declared(e),i(t,r),t.prototype.fetchPopupFeatures=function(u){return a(this,void 0,void 0,function(){var t,r,i,n,a,o,s,p,l;return d(this,function(e){if(t=this.layer,!u)return[2,y.reject(new c("wmslayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:t}))];if(!(r=t.popupEnabled))return[2,y.reject(new c("wmslayerview:fetchPopupFeatures","popupEnabled should be true",{popupEnabled:r}))];if(i=this.createFetchPopupFeaturesQuery(u),n=i.extent,a=i.width,o=i.height,s=i.x,p=i.y,!(n&&a&&o))throw new c("wmslayerview:fetchPopupFeatures","WMSLayer does not support fetching features.",{extent:n,width:a,height:o});return[2,(l=t.fetchFeatureInfo(n,a,o,s,p))?l.then(function(e){return[e]}):y.resolve([])]})})},n([o.property()],t.prototype,"layer",void 0),n([o.subclass("esri.layers.mixins.WMSLayerView")],t);function t(){return null!==r&&r.apply(this,arguments)||this}var r}}.apply(null,i))||(e.exports=n)}}]);